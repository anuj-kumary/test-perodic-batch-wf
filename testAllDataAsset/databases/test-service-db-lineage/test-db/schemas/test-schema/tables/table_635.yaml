name: table_635
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_635
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_635.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view ENTITLEMENTS_VALIDATION(\n\tENTITLEMENTNUMBER,\n\
  \tPARENTENTITLEMENTNUMBER,\n\tSTATUSCODE,\n\tENTITLEMENTMODEL,\n\tBUSINESSEVENT,\n\
  \tCUSTOMERID,\n\tCUSTOMERNAME,\n\tPRODUCTCODE,\n\tPRODUCTNAME,\n\tSALESQUANTITY,\n\
  \tITEMVALIDFROM,\n\tITEMVALIDTO,\n\tOPPORTUNITYNUMBER,\n\tQUOTENUMBER,\n\tECCCONTRACTNUMBER,\n\
  \tICERTISAGREEMENTNUMBER,\n\tICERTISPARENTAGREEMENTNUMBER,\n\tDATACENTERREGION,\n\
  \tHOSTINGTYPE,\n\tPLATFORMFLAG,\n\tINSTANCENAME,\n\tINSTANCEPURPOSE,\n\tINSTANCESTATUS,\n\
  \tSUPPORTLEVELLIFECYCLE,\n\tSURFCONTRACTNUMBER,\n\tSURFPARENTCONTRACTNUMBER,\n\t\
  TOTALACV,\n\tAVGWEIGHTEDPRICE,\n\tCOMMITTEDIMPACTFLOORACV,\n\tCOMMITTEDIMPACTCEILINGACV,\n\
  \tDPUNIQUEID,\n\tQUOTEITEMID,\n\tCURRENCY,\n\tSTEPINGROUP,\n\tMETER,\n\tDATACENTERPOD,\n\
  \tSURFSYSID,\n\tSOURCESYSTEM,\n\tSTORAGECAPACITYTB,\n\tOPTIONPERIOD,\n\tMULTIYEAR\n\
  ) as\n\n\n    Select  distinct\n\nEntitlementNumber,\nParentEntitlementNumber,\n\
  StatusCode,\nEntitlementModel,\nBusinessEvent,\nCustomerID,\nCustomerName,\nProductCode,\n\
  ProductName,\nround(SalesQuantity,'random') as SalesQuantity,\nItemValidFrom,\n\
  ItemValidTo,\nOpportunityNumber,\nQuoteNumber,\nECCContractNumber,\niCertisAgreementNumber,\n\
  iCertisParentAgreementNumber,\nDataCenterRegion,\nHostingType,\nPlatformFlag,\n\
  InstanceName,\nInstancePurpose,\nInstanceStatus,\nSupportLevelLifecycle,\nSURFContractNumber,\n\
  SURFParentContractNumber,\nround(TotalACV,'random') as TotalACV,\nround(AvgWeightedPrice,\
  \ 'random') as AvgWeightedPrice,\nCommittedImpactFloorACV,\nCommittedImpactCeilingACV,\n\
  DPUniqueID,\nQuoteItemId,\nCurrency,\nStepInGroup,\nMeter,\nDataCenterPOD,\nSURFSysId,\n\
  SourceSystem,\nStorageCapacityTB,\nOptionPeriod,\nMultiYear\n\n                from\
  \ (\n\n                    Select distinct\n                    ENTITLEMENTNO as\
  \ EntitlementNumber,\n                    PARENTENTITLEMENTNO as ParentEntitlementNumber,\n\
  \                    --STATUSCODE as StatusCode,\n                    CASE WHEN\
  \ (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n                      \
  \   THEN 'random'\n                         ELSE EMS.STATUSCODE END as StatusCode,\n\
  \                    CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n\
  \                         THEN QLI.ProductTypeName\n                         ELSE\
  \ EMS.ENTITLEMENTMODELNAME END as EntitlementModel,\n                    'random'\
  \ as BusinessEvent,\n                  --  CUSTOMERID as CustomerID,\n         \
  \         CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n    \
  \                     THEN Q.sn_customer_cmid\n                         ELSE EMS.CUSTOMERID\
  \ END as CustomerID,\n                   -- CUSTOMERNAME as CustomerName,\n    \
  \               CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n\
  \                         THEN Q.sn_customer_name\n                         ELSE\
  \ EMS.CustomerName END as CustomerName,\n                    CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                         THEN QLI.PARTNUMBER\n\
  \                         ELSE EMS.OFFERINGID END as ProductCode,\n            \
  \        -- Confirm Logic & Mapping --\n                    CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                        THEN QLI.DESCRIPTION\n\
  \                        WHEN ENTITLEMENTMODELNAME = 'random'\n                \
  \         THEN  PACKAGE --OR ZEMS_PACKAGE_V2\n                         ELSE OFFERINGNAME\
  \ END AS ProductName,\n\n                    -- Confirm Logic & Mapping --\n   \
  \                 CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n\
  \                        THEN QLI.QUANTITY\n                        WHEN (ZEMS_SALESQTY_V3\
  \ IS not NULL OR ZEMS_SALESQTY_V3 <> 'random')\n                        THEN ZEMS_SALESQTY_V3\n\
  \                        ELSE EMS.QUANTITY END AS SalesQuantity,\n             \
  \       CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n      \
  \                  THEN TO_VARCHAR(QLI.START_DATE, 'random')\n                 \
  \       ELSE TO_VARCHAR(VALIDFROM, 'random') END as ItemValidFrom,\n           \
  \         CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n    \
  \                   THEN TO_VARCHAR(QLI.END_DATE, 'random')\n                  \
  \      ELSE  TO_VARCHAR(VALIDTO, 'random') END as ItemValidTo,\n               \
  \     CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n        \
  \                THEN Q.SN_OPPORTUNITY_NUMBER\n                        ELSE ZEMS_OPPORTUNITY_NUMBER_V2\
  \ END as OpportunityNumber,\n                    --ZEMS_Quote_Number_v2 as QuoteNumber,\n\
  \                     CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n\
  \                        THEN Q.QuoteNumber\n                        ELSE ZEMS_Quote_Number_v2\
  \ END as QuoteNumber,\n                    ZEMS_ECC_CONTRACT_NUMBER_V2 as ECCContractNumber,\n\
  \                    ZEMS_ICERTIS_AGREEMENT_NUMBER as iCertisAgreementNumber,\n\
  \                    ZEMS_ICERTIS_CONTRACT_NUMBER_V2 as iCertisParentAgreementNumber,\n\
  \                    DATACENTERREGION as DataCenterRegion,\n\n                 \
  \   CASE WHEN (ENTITLEMENTMODELNAME = 'random' and HOSTINGTYPE = 'random')\n   \
  \                      THEN 'random'\n                         ELSE HOSTINGTYPE\
  \ end as HostingType,\n\n                    PLATFORMFLAG as PlatformFlag,\n   \
  \                 INSTANCENAME as InstanceName,\n                    INSTANCE_PURPOSE\
  \ as InstancePurpose,\n                    INSTANCE_STATUS as InstanceStatus,\n\
  \                    SUPPORT_LEVEL_LIFE_CYCLE as SupportLevelLifecycle,\n      \
  \              ZEMS_SURF_CONTRACT_NUMBER_V2 as SURFContractNumber,\n           \
  \         ZEMS_SURF_PARENT_CONTRACT_NUMBER_V2 as SURFParentContractNumber,\n   \
  \                 -- Confirm Logic & Mapping --\n                    CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                         THEN round(QLI.SN_ACV,'random')\n\
  \                         ELSE SCI.ACV END as TotalACV ,\n                    CASE\
  \ WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n                 \
  \        THEN round(QLI.SN_AVG_WEIGHTED_PRICE,'random')\n                      \
  \   ELSE SCI.SALES_PRICE END as AvgWeightedPrice,\n                    CASE WHEN\
  \ (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n                      \
  \   THEN round(QLI.SN_COMMITTED_IMPACT_FLOOR_ACV,'random')\n                   \
  \      ELSE SCI.U_IMPACT_COMMITTED_FLOOR_PRICE END as CommittedImpactFloorACV,\n\
  \                    CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n\
  \                         THEN round(QLI.SN_COMMITTED_IMPACT_CEILING_ACV,'random')\n\
  \                         ELSE SCI.U_IMPACT_COMMITTED_CEILING_PRICE END as CommittedImpactCeilingACV,\n\
  \                    'random' as DPUniqueID,\n                    CPQITEMID as QuoteItemId,\n\
  \                     CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n\
  \                        THEN Q.SELECTEDMARKET_CURRENCYCODE\n                  \
  \      ELSE SC.U_BASE_CURRENCY END as Currency,\n                    CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                        THEN QLI.sn_step_ingroup\n\
  \                        ELSE 'random' END AS StepInGroup,\n                   \
  \ CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random' AND SN_EDITION\
  \ = 'random')\n                        THEN QLI.SN_OF_DISPLAY_TYPE\n           \
  \           WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n       \
  \                 THEN 'random'\n                      ELSE EMS.METERTYPE END AS\
  \ METER,\n                    DATACENTERPOD as DataCenterPOD,\n                \
  \    ZEMS_SURFSYSID as SURFSysId,\n                    SOURCESYSTEM as SourceSystem,\n\
  \                    STORAGECAPACITY as StorageCapacityTB,\n                   \
  \   CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n          \
  \              THEN QLI.sn_option_term\n                        ELSE 'random' END\
  \ AS OptionPeriod,\n                    -- '' AS OptionPeriod,\n\n             \
  \       CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random' AND Q.sn_multi_year\
  \ = 'random')\n                        THEN Q.sn_multi_year\n                  \
  \      ELSE 'random'END AS MultiYear,\n                    PROD.DV_U_FAMILY_3 as\
  \ Product_Family_3\n\n\n                    from RDS_SHARE.SAP_EMS.ENTITLEMENTS\
  \ EMS\n\n                    LEFT JOIN RDS_SHARE.SURF.SALES_CONTRACT_ITEM SCI\n\
  \                    on EMS.ENTITLEMENTNO = SCI.U_EMS_ENTITLEMENT\n\n          \
  \          LEFT JOIN RDS_SHARE.SURF.SALES_CONTRACT SC\n                    on SCI.CONTRACT\
  \ = SC.SYS_ID\n\n                    LEFT JOIN RDS_SHARE.SURF.U_CONTRACT_INSTANCE\
  \ CI\n                    on CI.U_CONTRACT_LINE_ITEM = SCI.SYS_ID\n\n          \
  \          LEFT JOIN RDS_SHARE.SURF.SALES_PRODUCT PROD\n                    on PROD.U_PRODUCT_CODE\
  \ = EMS.OFFERINGID\n\n                    LEFT JOIN RDS_SHARE.CALLIDUS.QUOTE_LINE_ITEMS\
  \ QLI\n                    on EMS.CPQITEMID = QLI.ITEMID\n\n                   \
  \ LEFT JOIN RDS_SHARE.CALLIDUS.QUOTES Q\n                    on Q.QUOTENUMBER =\
  \ QLI.QUOTENUMBER\n\n\n\n                    WHERE  (cpqitemid IS not NULL\n   \
  \                 or  ZEMS_SURFSYSID IS not NULL )\n\n                     and (DV_U_FAMILY_3\
  \ <> 'random'\n\n                     and OFFERINGID not in ( 'random','random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random')\n\
  \n\n\n                    )\n\n                    AND EMS.ENTITLEMENTMODELNAME\
  \ NOT IN ('random','random')\n                    HAVING StatusCode <> 'random'\n\
  \n                    )\n\n\n\nUNION\n\n\n\nSelect  distinct\n\nEntitlementNumber,\n\
  ParentEntitlementNumber,\nStatusCode,\nEntitlementModel,\nBusinessEvent,\nCustomerID,\n\
  CustomerName,\nProductCode,\nProductName,\nround(SalesQuantity,'random') as SalesQuantity\
  \ ,\nItemValidFrom,\nItemValidTo,\nOpportunityNumber,\nQuoteNumber,\nECCContractNumber,\n\
  iCertisAgreementNumber,\niCertisParentAgreementNumber,\nDataCenterRegion,\nHostingType,\n\
  PlatformFlag,\nInstanceName,\nInstancePurpose,\nInstanceStatus,\nSupportLevelLifecycle,\n\
  SURFContractNumber,\nSURFParentContractNumber,\n\nCASE WHEN (SURFSysId IS NULL or\
  \ SURFSysId = 'random')\nTHEN ROUND(SN_ACV, 'random')\nELSE round(CASE WHEN ProductCode\
  \ IN ( 'random','random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random')\n\
  \n          or Product_Family_3 = 'random'\n\n\n\n        THEN AvgWeightedPrice\
  \ * 'random'\n        ELSE ContractLineACV END, 'random') END AS TotalACV,\n\nCASE\
  \ WHEN (SURFSysId IS NULL or SURFSysId = 'random')\n     THEN round(SN_AVG_WEIGHTED_PRICE,'random')\n\
  \     ELSE round(AvgWeightedPrice,'random') END AS AvgWeightedPrice,\nCASE WHEN\
  \ (SURFSysId IS NULL or SURFSysId = 'random')\n     THEN round(SN_COMMITTED_IMPACT_FLOOR_ACV,'random')\n\
  \     ELSE CommittedImpactFloorACV END AS CommittedImpactFloorACV,\nCASE WHEN (SURFSysId\
  \ IS NULL or SURFSysId = 'random')\n     THEN round(SN_COMMITTED_IMPACT_CEILING_ACV,'random')\n\
  \     ELSE CommittedImpactCeilingACV END AS CommittedImpactCeilingACV,\nDPUniqueID,\n\
  QuoteItemId,\nCurrency,\nStepInGroup,\nMeter,\nDataCenterPOD,\nSURFSysId,\nSourceSystem,\n\
  StorageCapacityTB,\nOptionPeriod,\nMultiYear\n\n                from (\n\n     \
  \               Select distinct\n                    ENTITLEMENTNO as EntitlementNumber,\n\
  \                    PARENTENTITLEMENTNO as ParentEntitlementNumber,\n         \
  \           --STATUSCODE as StatusCode,\n                    CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                         THEN 'random'\n\
  \                         ELSE EMS.STATUSCODE END as StatusCode,\n             \
  \       CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n      \
  \                   THEN QLI.ProductTypeName\n                         ELSE EMS.ENTITLEMENTMODELNAME\
  \ END as EntitlementModel,\n                    'random' as BusinessEvent,\n   \
  \               --  CUSTOMERID as CustomerID,\n                  CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                         THEN Q.sn_customer_cmid\n\
  \                         ELSE EMS.CUSTOMERID END as CustomerID,\n             \
  \      -- CUSTOMERNAME as CustomerName,\n                   CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                         THEN Q.sn_customer_name\n\
  \                         ELSE EMS.CustomerName END as CustomerName,\n         \
  \           CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n  \
  \                       THEN QLI.PARTNUMBER\n                         ELSE EMS.OFFERINGID\
  \ END as ProductCode,\n                    -- Confirm Logic & Mapping --\n     \
  \               CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n\
  \                        THEN QLI.DESCRIPTION\n                        WHEN ENTITLEMENTMODELNAME\
  \ = 'random'\n                         THEN  PACKAGE --OR ZEMS_PACKAGE_V2\n    \
  \                     ELSE OFFERINGNAME END AS ProductName,\n\n                \
  \    -- Confirm Logic & Mapping --\n                   CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                        THEN QLI.QUANTITY\n\
  \                        WHEN (ZEMS_SALESQTY_V3 IS not NULL OR ZEMS_SALESQTY_V3\
  \ <> 'random')\n                        THEN ZEMS_SALESQTY_V3\n                \
  \        ELSE EMS.QUANTITY END AS SalesQuantity,\n                    CASE WHEN\
  \ (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n                      \
  \  THEN TO_VARCHAR(QLI.START_DATE, 'random')\n                        ELSE TO_VARCHAR(VALIDFROM,\
  \ 'random') END as ItemValidFrom,\n                    CASE WHEN (ZEMS_SURFSYSID\
  \ IS NULL or ZEMS_SURFSYSID = 'random')\n                       THEN TO_VARCHAR(QLI.END_DATE,\
  \ 'random')\n                        ELSE  TO_VARCHAR(VALIDTO, 'random') END as\
  \ ItemValidTo,\n                    CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID\
  \ = 'random')\n                        THEN Q.SN_OPPORTUNITY_NUMBER\n          \
  \              ELSE ZEMS_OPPORTUNITY_NUMBER_V2 END as OpportunityNumber,\n     \
  \               --ZEMS_Quote_Number_v2 as QuoteNumber,\n                     CASE\
  \ WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n                 \
  \       THEN Q.QuoteNumber\n                        ELSE ZEMS_Quote_Number_v2 END\
  \ as QuoteNumber,\n                    ZEMS_ECC_CONTRACT_NUMBER_V2 as ECCContractNumber,\n\
  \                    ZEMS_ICERTIS_AGREEMENT_NUMBER as iCertisAgreementNumber,\n\
  \                    ZEMS_ICERTIS_CONTRACT_NUMBER_V2 as iCertisParentAgreementNumber,\n\
  \                    DATACENTERREGION as DataCenterRegion,\n\n                 \
  \   CASE WHEN (ENTITLEMENTMODELNAME = 'random' and HOSTINGTYPE = 'random')\n   \
  \                      THEN 'random'\n                         ELSE HOSTINGTYPE\
  \ end as HostingType,\n\n                    PLATFORMFLAG as PlatformFlag,\n   \
  \                 INSTANCENAME as InstanceName,\n                    INSTANCE_PURPOSE\
  \ as InstancePurpose,\n                    INSTANCE_STATUS as InstanceStatus,\n\
  \                    SUPPORT_LEVEL_LIFE_CYCLE as SupportLevelLifecycle,\n      \
  \              ZEMS_SURF_CONTRACT_NUMBER_V2 as SURFContractNumber,\n           \
  \         ZEMS_SURF_PARENT_CONTRACT_NUMBER_V2 as SURFParentContractNumber,\n   \
  \                 -- Confirm Logic & Mapping --\n                    SCI.ACV as\
  \ ContractLineACV ,\n\n\n                    --SCI.SALES_PRICE as \"AvgWeightedPrice\"\
  ,\n\n                    CASE WHEN (OFFERINGID IN ('random','random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random')\n\
  \                                AND INSTANCE_PURPOSE = 'random' )\n           \
  \                                  THEN SCI.SALES_PRICE/NULLIF(SCI.QUANTITY, 'random')*'random'\n\
  \                        WHEN (OFFERINGID IN ('random','random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random')\n\
  \                                 AND INSTANCE_PURPOSE = 'random' )\n          \
  \                                   THEN SCI.SALES_PRICE/NULLIF(SCI.QUANTITY, 'random')*'random'\n\
  \                      --  WHEN PROD.DV_U_FAMILY_3 = 'Non-Prod Environment  - Cloud'\n\
  \                      --                      THEN SCI.SALES_PRICE/NULLIF(SCI.QUANTITY,\
  \ 0)\n                       ELSE SCI.SALES_PRICE END as AvgWeightedPrice,\n   \
  \                 SCI.U_IMPACT_COMMITTED_FLOOR_PRICE as CommittedImpactFloorACV,\n\
  \                    SCI.U_IMPACT_COMMITTED_CEILING_PRICE as CommittedImpactCeilingACV,\n\
  \                     'random' as DPUniqueID,\n                    CPQITEMID as\
  \ QuoteItemId,\n                     CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID\
  \ = 'random')\n                        THEN Q.SELECTEDMARKET_CURRENCYCODE\n    \
  \                    ELSE SC.U_BASE_CURRENCY END as Currency,\n                \
  \    CASE WHEN (ZEMS_SURFSYSID IS NULL or ZEMS_SURFSYSID = 'random')\n         \
  \               THEN QLI.sn_step_ingroup\n                        ELSE 'random'\
  \ END AS StepInGroup,\n                    CASE WHEN (ZEMS_SURFSYSID IS NULL or\
  \ ZEMS_SURFSYSID = 'random' AND SN_EDITION = 'random')\n                       \
  \ THEN QLI.SN_OF_DISPLAY_TYPE\n                      WHEN (ZEMS_SURFSYSID IS NULL\
  \ or ZEMS_SURFSYSID = 'random')\n                        THEN 'random'\n       \
  \               ELSE EMS.METERTYPE END AS METER,\n                    DATACENTERPOD\
  \ as DataCenterPOD,\n                    ZEMS_SURFSYSID as SURFSysId,\n        \
  \            SOURCESYSTEM as SourceSystem,\n                    STORAGECAPACITY\
  \ as StorageCapacityTB,\n                      CASE WHEN (ZEMS_SURFSYSID IS NULL\
  \ or ZEMS_SURFSYSID = 'random')\n                        THEN QLI.sn_option_term\n\
  \                        ELSE 'random' END AS OptionPeriod,\n                  \
  \  -- '' AS OptionPeriod,\n\n                    CASE WHEN (ZEMS_SURFSYSID IS NULL\
  \ or ZEMS_SURFSYSID = 'random' AND Q.sn_multi_year = 'random')\n               \
  \         THEN Q.sn_multi_year\n                        ELSE 'random'END AS MultiYear,\n\
  \                    PROD.DV_U_FAMILY_3 as Product_Family_3,\n                 \
  \   QLI.SN_AVG_WEIGHTED_PRICE,\n                    QLI.SN_COMMITTED_IMPACT_FLOOR_ACV,\n\
  \                    QLI.SN_COMMITTED_IMPACT_CEILING_ACV,\n                    QLI.SN_ACV\n\
  \n\n                   from RDS_SHARE.SAP_EMS.ENTITLEMENTS EMS\n\nLEFT JOIN RDS_SHARE.SURF.U_CONTRACT_INSTANCE\
  \ CI\non CI.U_EMS_ENTITLEMENT_ID = EMS.ENTITLEMENTNO\n\n\nLEFT  JOIN RDS_SHARE.SURF.SALES_CONTRACT_ITEM\
  \ SCI\non CI.U_CONTRACT_LINE_ITEM = SCI.SYS_ID\n\nLEFT JOIN RDS_SHARE.SURF.SALES_CONTRACT\
  \ SC\non CI.U_CONTRACT = SC.SYS_ID\n\n--LEFT JOIN RDS_SHARE.SURF.U_CONTRACT_INSTANCE\
  \ CI\n--on CI.U_CONTRACT_LINE_ITEM = SCI.SYS_ID\n\nLEFT JOIN RDS_SHARE.SURF.SALES_PRODUCT\
  \ PROD\non PROD.U_PRODUCT_CODE = EMS.OFFERINGID\n\nLEFT JOIN RDS_SHARE.CALLIDUS.QUOTE_LINE_ITEMS\
  \ QLI\non EMS.CPQITEMID = QLI.ITEMID\n\nLEFT JOIN RDS_SHARE.CALLIDUS.QUOTES Q\n\
  on Q.QUOTENUMBER = QLI.QUOTENUMBER\n\nWHERE  cpqitemid IS not NULL\nor  ZEMS_SURFSYSID\
  \ IS not NULL\n\nHAVING StatusCode <> 'random'\n\n                    )\n\n    \
  \  where ( ProductCode   in ( 'random','random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random',\n\
  \                    'random','random','random','random','random','random','random','random','random','random','random','random','random','random')\n\
  \n            OR  Product_Family_3 = 'random')\n\n            AND EntitlementModel\
  \ NOT IN ('random','random') ;"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
