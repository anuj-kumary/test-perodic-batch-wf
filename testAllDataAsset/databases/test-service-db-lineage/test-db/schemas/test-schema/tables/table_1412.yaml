name: table_1412
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1412
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1412.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view SRC_V_DIM_OPPORTUNITY_STY(\n\tOPTY_ID,\n\
  \tOPTY_NUMBER,\n\tOPTY_NAME,\n\tOPTY_TYPE,\n\tOPTY_STAGE,\n\tOPTY_FORECAST_CATEGORY,\n\
  \tOPTY_CLOSE_DT,\n\tOPTY_CLOSE_WEEK_OF_QUARTER,\n\tOPTY_CREATED_DT,\n\tOPTY_CREATED_WEEK_OF_QUARTER,\n\
  \tOPTY_CLOSE_MONTH,\n\tOPTY_BU_LIST,\n\tOPTY_TAG,\n\tIS_ACTIVE,\n\tQUARTER_ID,\n\
  \tQUARTER_DT,\n\tQUARTER_YYQQ,\n\tOPTY_OWNER_ID,\n\tOPTY_OWNER,\n\tOPTY_TERRITORY_ID,\n\
  \tFIELD_TERRITORY_ID,\n\tGEO_ID,\n\tOPTY_ACCOUNT_ID,\n\tEXPECTED_DT,\n\tCONTRACT_NUMBER,\n\
  \tCONTRACT_TYPE,\n\tCONTRACT_SIGNED_DT,\n\tCONTRACT_START_DT,\n\tCONTRACT_END_DT,\n\
  \tPARENT_OPTY_ID,\n\tPARENT_OPTY_NUMBER,\n\tPARENT_OPTY_CLOSE_DT,\n\tPARENT_OPTY_ACCOUNT_ID,\n\
  \tPARENT_OPTY_ACCOUNT_NUMBER,\n\tPARENT_OPTY_ACCOUNT_TERRITORY_ID,\n\tPARENT_OPTY_TERRITORY_ID,\n\
  \tPARENT_OPTY_FORECAST_CATEGORY,\n\tPARENT_OPTY_FORECAST_TYPE,\n\tPARENT_OPTY_CONTRACT_SIGNED_DT,\n\
  \tPARENT_OPTY_STAGE,\n\tPARENT_OPTY_TYPE,\n\tPARENT_OPTY_LINK_REASON,\n\tPARENT_OPTY_NAME,\n\
  \tPARENT_OPTY_CONTRACT_END_DT,\n\tPARENT_OPTY_CONTRACT_START_DT,\n\tPARENT_OPTY_CONTRACT_TYPE,\n\
  \tPARENT_OPTY_ORDER_TERM_END_DT,\n\tPARENT_OPTY_ORDER_TERM_START_DT,\n\tPARENT_OPTY_TERM,\n\
  \tPARENT_OPTY_DYNAMICS_GUID,\n\tPARENT_OPTY_NEXT_STEPS,\n\tPARENT_OPTY_NOTES,\n\t\
  PARENT_OPTY_LINK_REASON_FLAG,\n\tPARENT_JOURNAL_DT_FLAG,\n\tREPORTING_PARENT_QUARTER_YYQQ,\n\
  \tREPORTING_OPTY_ID,\n\tREPORTING_OPTY_ACCOUNT_ID,\n\tSURVIVOR_OPTY_ID,\n\tSURVIVOR_OPTY_ACCOUNT_ID,\n\
  \tSURVIVOR_OPTY_NUMBER,\n\tORDER_FORM_STATUS,\n\tORDER_FORM_OUTPUT_REASON,\n\tORDER_FORM_START_DT,\n\
  \tORDER_FORM_END_DT,\n\tLEAD_ID,\n\tLEAD_NUMBER,\n\tLEAD_SOURCE,\n\tRENEWAL_ACCOUNT_MANAGER_ID,\n\
  \tRENEWAL_ACCOUNT_MANAGER,\n\tRENEWAL_CATEGORY,\n\tRENEWAL_STATUS,\n\tRENEWALS_ENGAGEMENT,\n\
  \tRENEWAL_GEO,\n\tRENEWAL_MAJOR_AREA,\n\tRENEWAL_AREA,\n\tRENEWAL_REGION,\n\tRENEWAL_DISTRICT,\n\
  \tRENEWAL_TERRITORY,\n\tRENEWAL_TERRITORY_SYSID,\n\tRENEWAL_TERRITORY_ID,\n\tIS_RENEWAL_CRITERIA,\n\
  \tOPTY_RISK,\n\tRISK_MITIGATION_STEPS,\n\tRISK_REASON_CODE_NAME,\n\tRISK_REASON_CATEGORY,\n\
  \tOPTY_CREATED_BY,\n\tOPTY_ADR_ID,\n\tOPTY_ADR,\n\tBASE_CURRENCY,\n\tAR_NOTES,\n\
  \tAUDIT_NOTES,\n\tADR_INTERACTION,\n\tACE_SALESREP,\n\tACE_SALESREP_ID,\n\tACE_SALESREP_NUMBER,\n\
  \tACE_SALES_MANAGER,\n\tACE_TERRITORY_ID,\n\tACE_TERRITORY_NAME,\n\tALLOWABLE_DISCOUNT_LEVEL,\n\
  \tESR_OWNER_ID,\n\tESR_OWNER,\n\tESR_MANAGER,\n\tCAMPAIGN_HISTORY,\n\tCODELIVERY,\n\
  \tIS_COMANAGED,\n\tOPTY_COMPETITION,\n\tCOMPETITVE_STATUS,\n\tCONSTANT_FX,\n\tCUSTOMER_OUTCOME_OWNER_ID,\n\
  \tCUSTOMER_OUTCOME_OWNER,\n\tCUSTOMER_OUTCOME_OWNER_MANAGER,\n\tPARENT_OPTY_OWNER_NAME,\n\
  \tDYNAMICS_DEAL_CHAMPION_ID,\n\tDYNAMICS_DEAL_CHAMPION,\n\tDEPLOYMENT_REGISTRATION_NUMBER,\n\
  \tDATA_CENTER,\n\tDID_MARKETING_HELP,\n\tDOUBLE_COMP_OVERLAY,\n\tDOUBLE_COMP_OVERLAY_EMPLOYEE_NUMBER,\n\
  \tDYNAMICS_GUID,\n\tDYNAMICS_URL,\n\tENGAGEMENT_MANAGER_USER_NAME,\n\tOPTY_EXTENSION_CHANNEL_TRANSACTION_TYPE,\n\
  \tOPTY_EXTENSION_TRANSACTING_PARTNER,\n\tENTERPRISE_LOGO_OVERRIDE,\n\tOPTY_ENVIRONMENT_TYPE,\n\
  \tEXPRESS_NEWLOGO_OVERRIDE,\n\tOPTY_EXTENSION,\n\tFIELD_SALES_BUSINESS_TITLE,\n\t\
  FIELD_SALES_MANAGER_ID,\n\tFIELD_SALES_MANAGER,\n\tFIELD_SALES_TERRITORY_ID,\n\t\
  APPROVAL_TERRITORY_ID,\n\tAPPROVAL_TERRITORY_SYSID,\n\tFIRST_CLOSED_BY,\n\tFIRST_CLOSED_TS,\n\
  \tOPTY_FLAGS,\n\tFORECAST_TYPE,\n\tIS_NEW_LOGO,\n\tGSI_PARTNER,\n\tIMPLEMENTATION_PARTNER,\n\
  \tIMPLEMENTATION_MODE,\n\tOPTY_TECHNICAL_WIN,\n\tPARENT_OPTY_TECHNICAL_WIN,\n\t\
  OPTY_INCUMBENT,\n\tIS_BIU,\n\tJOURNAL_NOTES,\n\tLINK_REASON,\n\tLINK_REASON_CATEGORY,\n\
  \tLINK_REASON_FLAG,\n\tMARKETING_PROGRAM_EVENT,\n\tMEETING_NUMBER,\n\tNEXT_STEPS,\n\
  \tNEXT_STEPS_BRIEF,\n\tNEXT_STEPS_LAST_UPDATED_TS,\n\tNEXT_STEPS_JOURNALED,\n\t\
  NOTES,\n\tNOTES_LAST_UPDATED_TS,\n\tOFFSET_VALUE,\n\tOTHER_COMPETITOR,\n\tOVERLAY_ADR_MANAGER,\n\
  \tIS_PARTNERED,\n\tPARTNERSHIP_TYPE,\n\tPIPELINE_SOURCE,\n\tPRICE_BAND,\n\tPRICE_BOOK,\n\
  \tPRIMARY_COMPETITOR,\n\tPRODUCT_TECHNOLOGY_PARTNER,\n\tPS_TERRITORY_ID,\n\tPS_TEAM,\n\
  \tREASON_CODE,\n\tSALES_ORDER_NUMBER,\n\tSAP_CONTRACT_ID,\n\tCONTRACT_ID,\n\tSECONDARY_COMPETITOR,\n\
  \tOPTY_SERVICE_PROVIDER,\n\tOPTY_SERVICE_PROVIDER_USAGE_TYPE,\n\tOPTY_SERVICES_PARTNER,\n\
  \tOPTY_SERVICES_TYPE,\n\tSOLUTION_CONSULTANT_ID,\n\tSOLUTION_CONSULTANT,\n\tSOLUTION_CONSULTANT_MANAGER,\n\
  \tSOLUTION_CONSULTANT_MANAGER_MANAGER,\n\tOPTY_SOURCE,\n\tIS_OPTY_SOURCED,\n\tSP_END_CUSTOMER_NAME,\n\
  \tOPTY_START_DT,\n\tSUCCESS_SERVICE_ATTACH_STATUS,\n\tSUPPORT_PARTNER,\n\tTERM_MONTHS_AND_DAYS,\n\
  \tOPTY_TIMING,\n\tTRAINING_ACCOUNT_EXECUTIVE_ID,\n\tTRAINING_ACCOUNT_EXECUTIVE_SYSID,\n\
  \tTRAINING_ACCOUNT_EXECUTIVE,\n\tOPTY_UPDATED_BY,\n\tOPTY_UPDATED_TS,\n\tOPTY_SALES_COMPLETED_TS,\n\
  \tOPTY_FIRST_SUBMITTED_TS,\n\tIS_UPDATED_TO_CONTRACT,\n\tWINLOSS_NODECISION_NOTES,\n\
  \tWINLOSS_NODECISION_REASON,\n\tIS_CHANGE_ORDER,\n\tOPTY_TERM,\n\tOPTY_TERM_PRECISE,\n\
  \tIS_GP_NEW_LOGO,\n\tIS_GP_POTENTIAL_NEW_LOGO,\n\tIS_DP_NEW_LOGO,\n\tIS_DP_POTENTIAL_NEW_LOGO,\n\
  \tIS_ELIGIBLE_NEW_LOGO,\n\tIS_RENEWAL_DRIVEN,\n\tIS_PIPELINE_ACTIVE,\n\tPROBABILITY_TO_CLOSE_IN_QTR,\n\
  \tOPTY_SYSID,\n\tOPTY_OWNER_SYSID,\n\tOPTY_TERRITORY_SYSID,\n\tFIELD_TERRITORY_SYSID,\n\
  \tGEO_SYSID,\n\tOPTY_ACCOUNT_SYSID,\n\tPS_TERRITORY_SYSID,\n\tPARENT_OPTY_SYSID,\n\
  \tPARENT_OPTY_ACCOUNT_SYSID,\n\tPARENT_OPTY_ACCOUNT_TERRITORY_SYSID,\n\tPARENT_OPTY_TERRITORY_SYSID,\n\
  \tOPTY_ADR_EMPLOYEE_SYSID,\n\tACE_SALESREP_SYSID,\n\tACE_TERRITORY_SYSID,\n\tESR_OWNER_SYSID,\n\
  \tCUSTOMER_OUTCOME_OWNER_SYSID,\n\tSOLUTION_CONSULTANT_SYSID,\n\tRENEWAL_ACCOUNT_MANAGER_SYSID,\n\
  \tCONTRACT_SYSID,\n\tPARENT_OPTY_MANAGEMENT,\n\tOPTY_ML_PREDICTION_RISK_REASON1,\n\
  \tOPTY_ML_PREDICTION_RISK_REASON2,\n\tOPTY_ML_PREDICTION_RISK_REASON3,\n\tOPTY_ML_PREDICTION_RISK_REASON4,\n\
  \tOPTY_ML_PREDICTION_RISK_REASON5,\n\tOPTY_ML_PREDICTION_RISK_REASON6,\n\tIS_OPTY_PREDICTED_TO_CLOSE,\n\
  \tOPTY_CLOSE_PROBABILITY,\n\tPARENT_OPTY_RENEWAL_CATEGORY,\n\tJOURNAL_CREATED_DT,\n\
  \tJOURNAL_STATUS,\n\tOPTY_CHALLENGES,\n\tOPTY_OBJECTIVE,\n\tOPTY_OUTCOMES,\n\tPARENT_OPTY_TECHNICAL_WIN_NAME,\n\
  \tPARENT_OPTY_TECHNICAL_WIN_STATUS,\n\tIS_PARENT_OPTY_PREDICTED_TO_CLOSE,\n\tPARENT_OPTY_CLOSE_PROBABILITY,\n\
  \tPARENT_OPTY_RENEWAL_STATUS,\n\tIS_PRESENT_IN_DYNAMIC_SUMMARY,\n\tPARENT_PARTNER_ACCOUNT_SYSID,\n\
  \tPARENT_PARTNER_ACCOUNT_NAME,\n\tPARENT_OPTY_SOURCE,\n\tPARTNER_ULTIMATE_PARENT_ACCOUNT,\n\
  \tPARTNER_ULTIMATE_CHILD_ACCOUNT,\n\tOPTY_OPEN_CLOSED_FLAG,\n\tCC_DAYS_OVERDUE,\n\
  \tCC_OVERDUE_RENEWAL_FLAG,\n\tRENEWAL_OPTY_OPEN_CLOSED_STATUS,\n\tCC_PARENT_CLOSED_OPEN_STATUS,\n\
  \tOPTY_STAGE_PCT_DV1,\n\tCC_PARENT_OPTY_STAGE,\n\tOPTY_NOTES,\n\tOPTY_NOTES_CREATED_TS,\n\
  \tOPTY_TECHNICAL_WIN_STATUS,\n\tOPTY_TRANSACTION_TYPE,\n\tPARTNER_ACCOUNT_NAME,\n\
  \tIS_RENEWAL_OPTY_AT_RSK,\n\tIS_RENEWAL_OPTY_OPEN_AT_RSK,\n\tRENEWAL_STATUS_LEGACY,\n\
  \tTIMELINE_STATUS,\n\tOPTY_CLOSE_PROBABILITY_BUCKET,\n\tOPTY_OPEN_CLOSED_INCL_NO_DECISION_STATUS,\n\
  \tIS_RENEWAL_OPTY_CQ_LATE_RSK,\n\tACCT_RENEWAL_WATERFALL_STATUS,\n\tRENEWAL_WATERFALL_STATUS,\n\
  \tACE_SUBCATEGORY,\n\tACE_TRANSACTION_TYPE,\n\tACE_MARKET_SEGMENT_VCU,\n\tSO_TYPE,\n\
  \tSOURCING_PARTNER_PARENT_ACCOUNT_NAME,\n\tCQ_PUSHED_RENEWAL_FLAG,\n\tPQ_PUSHED_RENEWAL_FLAG,\n\
  \tIS_NEW_LOGO_PYTD,\n\tPARENT_ACCOUNT_FSP_NEW_LOGO_FLAG,\n\tIS_MEGA_SKU\n) as WITH\
  \ OPTY AS (\n    --SS 1.5/Avantika Keshav/Updated on: 02-02-2024/Release on: 02-02-2024/\
  \ Release Type: Normal\n    SELECT\n        \"OptyNumber\",\n        \"OptyName\"\
  ,\n        \"OptyTypeValue\",\n        \"OptyStageValue\",\n        \"OptyPipelineStatusValue\"\
  ,\n        \"OptyCloseDate\",\n        \"OptyCloseMonth\",\n        \"OptyActive\"\
  ,\n        \"OptySalesQuarter\",\n        \"OptyAccountSysID\",\n        \"OptyRenewalCategoryValue\"\
  ,\n        \"OptyCoDelivery\",\n        \"OptyForeCastTypeValue\",\n        \"OptyIncumbent\"\
  ,\n        \"OptyOpportunityLinkReason\",\n        \"OptyPartnershipType\",\n  \
  \      \"OptyImplementationPartner\",\n        \"OptySysID\",\n        \"OptyTerritorySysID\"\
  ,\n        \"OptyParentSysID\",\n        \"OptyMSPTerritorySysID\",\n        CASE\
  \ WHEN\n             \"OptySalesQuarter\" >= RIGHT(YEAR(convert_timezone('random',CURRENT_TIMESTAMP))\
  \ ||'random'|| QUARTER(convert_timezone('random',CURRENT_TIMESTAMP)), 'random')\n\
  \             AND\n             (\n             (\n                 \"OptyStageValue\"\
  \ IN(\n                                    'random',\n                         \
  \           'random',\n                                    'random',\n         \
  \                           'random',\n                                    'random',\n\
  \                                    'random',\n                               \
  \     'random',\n                                    'random'\n                \
  \                    )\n                AND LOWER(\"OptyPipelineStatusValue\") not\
  \ in(\n                                                            'random',\n \
  \                                                           'random',\n        \
  \                                                    'random',\n               \
  \                                             'random',\n                      \
  \                                      'random',\n                             \
  \                               'random'\n                                     \
  \                       )\n            )\n            OR\n            (CASE WHEN\
  \  \"OptyStageValue\" = 'random'\n                        OR (\n               \
  \             \"OptyStageValue\" = 'random'\n                            and \"\
  OptyType\" = 'random'\n                        )\n                  THEN 'random'\n\
  \                  ELSE 'random'\n            END\n            ) = 'random'\n  \
  \          )\n            THEN 'random'\n            ELSE 'random'\n        END\
  \ as IS_PIPELINE_ACTIVE, --SS 1.5/Avantika Keshav/Updated on: 19-06-2024/Release\
  \ on: 19-07-2024/ Release Type: RTB\n        case when pgm.\"PTOpportunityGUID\"\
  \ IS not NULL then 'random' else 'random' end as IS_MEGA_SKU\n    FROM\n       \
  \ ODS_LS.SURF.SALES_OPPORTUNITY so\n        --------/Shailja Tyagi/Updated on: 18-07-2024------------\n\
  \        LEFT JOIN (\n        select distinct \"PTOpportunityGUID\" from EDW_LS.SALES_D365_EM.EM_PROGRAMS\n\
  \          where \"ProgramName\"='random' )pgm on pgm.\"PTOpportunityGUID\"=so.\"\
  OptyDynamicsGUID\"\n          -------shailja change ends here------------\n    WHERE\n\
  \        \"OptyNumber\" NOT IN (\n            SELECT\n                DISTINCT \"\
  SFixedDataOptyNumber\"\n            FROM\n                ODS_LS.FILES.SALES_OPPTY_FIXEDDATA\n\
  \        )\n        and HASH(\"OptySysID\") NOT IN (\n            -- Excluding the\
  \ below Opty's which are having duplicate sysid's and nulls. As per discussion with\
  \ Aravind, this should be fixed at the FixedDataSource.\n            'random',\n\
  \            'random',\n            'random',\n            'random',\n         \
  \   'random',\n            'random'\n        )\n    UNION ALL\n    SELECT\n    \
  \    DISTINCT fd.\"SFixedDataOptyNumber\" AS \"OptyNumber\",\n        fd.\"SFixedDataOptyName\"\
  \ AS \"OptyName\",\n        fd.\"SFixedDataOptyType\" AS \"OptyTypeValue\",\n  \
  \      fd.\"SFixedDataOptyStage\" AS \"OptyStageValue\",\n        'random' AS \"\
  OptyPipelineStatusValue\",\n        fd.\"SFixedDataOptyCloseDate\" AS \"OptyCloseDate\"\
  ,\n        fd.\"SFixedDataOptyCloseMonth\" AS \"OptyCloseMonth\",\n        CASE\n\
  \            WHEN fd.\"SFixedDataOptyActiveFlag\" IS NULL THEN 'random'\n      \
  \      ELSE fd.\"SFixedDataOptyActiveFlag\"\n        END AS \"OptyActive\",\n  \
  \      fd.\"SFixedDataOptyCloseQuarter\" AS \"OptySalesQuarter\",\n        fd.\"\
  SFixedDataAcctSysID\" AS \"OptyAccountSysID\",\n        CASE\n            WHEN fd.\"\
  SFixedDataOptyRenewalCategory\" IN ('random', 'random') THEN 'random'\n        \
  \    ELSE fd.\"SFixedDataOptyRenewalCategory\"\n        END AS \"OptyRenewalCategoryValue\"\
  ,\n        'random' as \"OptyCoDelivery\",\n        COALESCE(\n            fd.\"\
  SFixedDataRestatedForecastType\",\n            so.\"OptyForeCastTypeValue\"\n  \
  \      ) AS \"OptyForeCastTypeValue\",\n        CASE\n            WHEN fd.\"SFixedDataOptyIncumbent\"\
  \ IN ('random', 'random') THEN 'random'\n            ELSE fd.\"SFixedDataOptyIncumbent\"\
  \n        END AS \"OptyIncumbent\",\n        fd.\"SFixedDataOptyOpportunityLinkReason\"\
  \ AS \"OptyOpportunityLinkReason\",\n        CASE\n            WHEN fd.\"SFixedDataPartnershipType\"\
  \ IN ('random', 'random', 'random') THEN 'random'\n            ELSE fd.\"SFixedDataPartnershipType\"\
  \n        END AS \"OptyPartnershipType\",\n        CASE\n            WHEN fd.\"\
  SFixedDataImplementationPartner\" IN ('random', 'random', 'random') THEN 'random'\n\
  \            ELSE fd.\"SFixedDataImplementationPartner\"\n        END AS \"OptyImplementationPartner\"\
  ,\n        fd.\"SFixedDataOptySysID\" AS \"OptySysID\",\n        fd.\"SFixedDataRestatedTerritorySysID\"\
  \ AS \"OptyTerritorySysID\",\n        fd.\"SFixedDataOptyParentsSysID\" AS \"OptyParentSysID\"\
  ,\n        COALESCE(\n            fd.\"SFixedDataRestatedACETerrSysID\",\n     \
  \       so.\"OptyMSPTerritorySysID\"\n        ) AS \"OptyMSPTerritorySysID\",\n\
  \        'random' as IS_PIPELINE_ACTIVE,\n         case when pgm.\"PTOpportunityGUID\"\
  \ IS not NULL then 'random' else 'random' end as IS_MEGA_SKU\n    FROM\n       \
  \ ODS_LS.FILES.SALES_OPPTY_FIXEDDATA fd\n        LEFT OUTER JOIN ODS_LS.SURF.SALES_OPPORTUNITY\
  \ so ON so.\"OptyNumber\" = fd.\"SFixedDataOptyNumber\"\n        --------/Shailja\
  \ Tyagi/Updated on: 18-07-2024------------\n        LEFT JOIN (\n        select\
  \ distinct \"PTOpportunityGUID\" from EDW_LS.SALES_D365_EM.EM_PROGRAMS\n       \
  \   where \"ProgramName\"='random' )pgm on pgm.\"PTOpportunityGUID\"=so.\"OptyDynamicsGUID\"\
  \n          -------shailja change ends here------------\n    where\n        hash(fd.\"\
  SFixedDataOptySysID\") NOT IN (\n            -- Excluding the below Opty's which\
  \ are having duplicate sysid's and nulls. As per discussion with Aravind, this should\
  \ be fixed at the FixedDataSource.\n            'random',\n            'random',\n\
  \            'random',\n            'random',\n            'random',\n         \
  \   'random'\n        )\n),\nSYS_JOURNAL_FIELD AS (\n    SELECT\n        DISTINCT\
  \ gnm.\"JournalElementID\" AS \"JournalElementID\",\n        gnm.\"NotesLastUpdatedDate\"\
  \ AS \"GeneralNotesCreatedOn\",\n        \"GeneralNotes\"\n    FROM\n        (\n\
  \            (\n                SELECT\n                    \"JournalElementID\"\
  ,\n                    MAX(\"JournalCreatedOn\") AS \"NotesLastUpdatedDate\"\n \
  \               FROM\n                    ODS_LS.\"SURF\".\"SYS_JOURNAL_FIELD\"\n\
  \                WHERE\n                    \"JournalElement\" = 'random'\n    \
  \            GROUP BY\n                    \"JournalElementID\"\n            ) gnm\n\
  \            INNER JOIN (\n                SELECT\n                    \"JournalElementID\"\
  ,\n                    LEFT(TO_VARCHAR(\"JournalValue\"), 'random') AS \"GeneralNotes\"\
  ,\n                    \"JournalCreatedOn\"\n                FROM\n            \
  \        ODS_LS.\"SURF\".\"SYS_JOURNAL_FIELD\"\n                WHERE\n        \
  \            \"JournalElement\" = 'random'\n            ) gn ON IFNULL (gnm.\"JournalElementID\"\
  , 'random') = IFNULL(gn.\"JournalElementID\", 'random')\n            AND gnm.\"\
  NotesLastUpdatedDate\" = gn.\"JournalCreatedOn\"\n        )\n),\nNEW_LOGO_PYTD as\
  \ (\n    SELECT\n        DISTINCT \"OpportunityNumber\",\n        \"PYTD\"\n   \
  \ FROM\n        EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n    WHERE\n        \"RecordType\"\
  \ = 'random'\n        AND PYTD IN ('random', 'random')\n        and \"AnaplanAccountFlag\"\
  \ = 'random'\n),\nTIME_RANGE as (\n    select\n        RIGHT(\n            YEAR(\n\
  \                ADD_MONTHS(\n                    convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                    'random'\n                )\n            ) || 'random' || QUARTER(\n\
  \                ADD_MONTHS(\n                    convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                    'random'\n                )\n            ),\n            'random'\n\
  \        ) \"MinQuarter\",\n        RIGHT(\n            YEAR(\n                ADD_MONTHS(\n\
  \                    convert_timezone('random', CURRENT_TIMESTAMP()),\n        \
  \            'random'\n                )\n            ) || 'random' || QUARTER(\n\
  \                ADD_MONTHS(\n                    convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                    'random'\n                )\n            ),\n            'random'\n\
  \        ) \"MaxQuarter\"\n),\nFSP_NEW_LOGO as (\n    SELECT\n        case\n   \
  \         when \"SalesQuarter\" = RIGHT(\n                YEAR(\n              \
  \      ADD_MONTHS(\n                        convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                        'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ CURRENT_TIMESTAMP()),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            ) then 'random'\n   \
  \         when \"SalesQuarter\" = RIGHT(\n                YEAR(\n              \
  \      ADD_MONTHS(\n                        convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                        'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ CURRENT_TIMESTAMP()),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            ) then 'random'\n   \
  \         when \"SalesQuarter\" = RIGHT(\n                YEAR(\n              \
  \      ADD_MONTHS(\n                        convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                        'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ CURRENT_TIMESTAMP()),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            ) then 'random'\n   \
  \         when \"SalesQuarter\" = RIGHT(\n                YEAR(\n              \
  \      ADD_MONTHS(\n                        convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                        'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ CURRENT_TIMESTAMP()),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            ) then 'random'\n   \
  \         when \"SalesQuarter\" = RIGHT(\n                YEAR(\n              \
  \      convert_timezone('random', CURRENT_TIMESTAMP())\n                ) || 'random'\
  \ || QUARTER(\n                    convert_timezone('random', CURRENT_TIMESTAMP())\n\
  \                ),\n                'random'\n            ) then 'random'\n   \
  \         when \"SalesQuarter\" = RIGHT(\n                YEAR(\n              \
  \      ADD_MONTHS(\n                        convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                        'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ CURRENT_TIMESTAMP()),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            ) then 'random'\n   \
  \         when \"SalesQuarter\" = RIGHT(\n                YEAR(\n              \
  \      ADD_MONTHS(\n                        convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                        'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ CURRENT_TIMESTAMP()),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            ) then 'random'\n   \
  \         else 'random'\n        end as \"QuarterFlag\",\n        A.\"OptyDynamicsGUID\"\
  ,\n        A.\"OpportunitySysID\",\n        A.\"SalesQuarter\" as \"Quarter\",\n\
  \        A.\"ReportingTerritoryGeo\",\n        A.\"OpportunityMajorArea\" as \"\
  MajorArea\",\n        A.\"OpportunityArea\" as \"Area\",\n        A.\"OpportunityRegion\"\
  \ as \"Region\",\n        A.\"OpportunityDistrict\" as \"District\",\n        A.\"\
  OpportunityTerritory\" as \"Territory\",\n        \"TerritorySysID\",\n        \"\
  BUGroup\",\n        \"AcctFieldSalesParentValue\",\n        \"AccountNumber\",\n\
  \        A.\"AccountName\",\n        A.\"OpportunityNumber\",\n        \"LineItemNumber\"\
  ,\n        A.\"OpportunityName\",\n        A.\"OpportunityStage\",\n        A.\"\
  PipelineStatus\",\n        A.\"OpportunityCloseDate\",\n        \"OptyCOManaged\"\
  ,\n        \"USDNetNewACV\",\n        \"Closed\",\n        \"MaturedPipeline\",\n\
  \        \"USDWeightedACV\",\n        \"AcctFieldSalesParentAccount\",\n       \
  \ EDW_LS.SALES_EM.FN_BUWorkflow('random', \"ProductBusinessUnit\") as \"BUWorkflow\"\
  ,\n        IFNULL(dynopt.\"OptyParentTechnicalWinName_CC\", 'random') as \"OptyParentTechnicalWinName\"\
  ,\n        A.\"FSPNewLogoFlag\",\n        --Added by Vijay\n        \"TerrMarketSegmentaion\"\
  \ as \"TerrMarketSegmentation\",\n        --null as \"OptyParentTechnicalWinName\"\
  \n        \"NetNewACV_FX\",\n        \"Closed_FX\",\n        \"WeightedNetNewACV_FX\"\
  ,\n        \"MaturedPipeline_FX\",\n        \"MarqueeAccount\",\n        \"ParentMarqueeAccount\"\
  ,\n        \"AccountParentNumber\"\n    FROM\n        CDL_LS.\"MARKETING_RPT\".\"\
  RPT_MKT_FSPNEWLOGO\" A\n        LEFT OUTER JOIN ODS_LS.\"SURF\".\"SALES_TERRITORY\"\
  \ st ON st.\"TerrSysID\" = A.\"TerritorySysID\"\n        AND st.\"TerrActive\" =\
  \ 'random'\n        LEFT OUTER JOIN ODS_LS.\"DYNAMICS365\".\"OPPORTUNITIES\" dynopt\
  \ ON A.\"OptyDynamicsGUID\" = dynopt.\"OpportunitySysID\"\n    WHERE\n        \"\
  RecordType\" IN ('random') ----Old code---\n        -- AND \"SalesQuarter\" >= RIGHT(YEAR(convert_timezone(\
  \ 'America/Los_Angeles',CURRENT_TIMESTAMP())),2) ||'-Q1'\n        --AND \"SalesQuarter\"\
  \ <= RIGHT(YEAR(ADD_MONTHS(convert_timezone( 'America/Los_Angeles',CURRENT_TIMESTAMP()),\
  \ 9)) ||'-Q'|| QUARTER(ADD_MONTHS(convert_timezone( 'America/Los_Angeles',CURRENT_TIMESTAMP()),\
  \ 9)), 5)\n        ----New code----\n        AND \"SalesQuarter\" >= (\n       \
  \     select\n                \"MinQuarter\"\n            from\n               \
  \ TIME_RANGE\n        )\n        AND \"SalesQuarter\" <= (\n            select\n\
  \                \"MaxQuarter\"\n            from\n                TIME_RANGE\n\
  \        )\n        AND \"FSPNewLogoFlag\" in ('random', 'random')\n        AND\
  \ \"AnaplanAccountFlag\" = 'random'\n)\nSELECT\n    DISTINCT --distinct is added\
  \ to address the duplicate Opportunity issue in Dynamics\n    HASH(opty.\"OptySysID\"\
  ) AS OPTY_ID,\n    opty.\"OptyNumber\" AS OPTY_NUMBER,\n    opty.\"OptyName\" AS\
  \ OPTY_NAME,\n    opty.\"OptyTypeValue\" AS OPTY_TYPE,\n    opty.\"OptyStageValue\"\
  \ AS OPTY_STAGE,\n    opty.\"OptyPipelineStatusValue\" AS OPTY_FORECAST_CATEGORY,\n\
  \    opty.\"OptyCloseDate\" AS OPTY_CLOSE_DT,\n    close_date_dim.WEEK_NUMBER_OF_QUARTER\
  \ AS OPTY_CLOSE_WEEK_OF_QUARTER,  --SS 1.5/Jay Modi/Updated on: 03-07-2024/Release\
  \ on: 19-07-2024/ Release Type: RTB\n    TO_DATE(so.\"OptySysCreatedOn\") as OPTY_CREATED_DT,\
  \  --SS 1.5/Jay Modi/Updated on: 15-04-2024/Release on: 17-04-2024/ Release Type:\
  \ RTB\n    create_date_dim.WEEK_NUMBER_OF_QUARTER AS OPTY_CREATED_WEEK_OF_QUARTER,\
  \  --SS 1.5/Jay Modi/Updated on: 03-07-2024/Release on: 19-07-2024/ Release Type:\
  \ RTBopty.\"OptyCloseMonth\" as OPTY_CLOSE_MONTH,\n    opty.\"OptyCloseMonth\" AS\
  \ OPTY_CLOSE_MONTH,\n    so.\"OptyBUList\" as OPTY_BU_LIST,   --SS 1.5/Jay Modi/Updated\
  \ on: 22-05-2024/Release on: 19-07-2024/ Release Type: RTB\n    case when LBL.\"\
  Label\"  = 'random' then 'random' else LBL.\"Label\" end as OPTY_TAG, --SS 1.5/Jaya\
  \ Prakash/Updated on: 10-07-2024/Release on: 19-07-2024/ Release Type: RTB\n   \
  \ opty.\"OptyActive\" AS IS_ACTIVE,\n    qtr.QUARTER_ID AS QUARTER_ID,\n    qtr.QUARTER_DT\
  \ AS QUARTER_DT,\n    opty.\"OptySalesQuarter\" AS QUARTER_YYQQ,\n    HASH(so.\"\
  OptyOwnerSysID\") AS OPTY_OWNER_ID,\n    so.\"OptyDVOwner\" AS OPTY_OWNER,\n   \
  \ hash(opty.\"OptyTerritorySysID\") AS OPTY_TERRITORY_ID,\n    HASH(so.\"OptyTerritorySysID\"\
  ) AS FIELD_TERRITORY_ID,\n    --SS 1.5/Jaya Prakash/Updated on: 25-01-2024/Release\
  \ on: 02-02-2024/ Release Type: Regular\n    hash(terr.\"TerrGeoSysID\") AS GEO_ID,\n\
  \    hash(opty.\"OptyAccountSysID\") AS OPTY_ACCOUNT_ID,\n    so.\"OptyExpectedDate\"\
  \ AS EXPECTED_DT,\n    so.\"OptyContractValue\" as CONTRACT_NUMBER,   --SS 1.5/Jay\
  \ Modi/Updated on: 22-05-2024/Release on: 19-07-2024/ Release Type: RTB\n    so.\"\
  OptyContractType\" AS CONTRACT_TYPE,\n    so.\"OptyContractSignedDate\" AS CONTRACT_SIGNED_DT,\n\
  \    con.\"ContractStartDate\" as CONTRACT_START_DT,\n    --Taken from ss QA\n \
  \   so.\"OptyContEndDate\" AS CONTRACT_END_DT,\n    HASH(opty.\"OptyParentSysID\"\
  ) AS PARENT_OPTY_ID,\n    parent_opty.\"OptyNumber\" AS PARENT_OPTY_NUMBER,\n  \
  \  --SS 1.5/Avantika Keshav/Updated on: 12-03-2024/Release on: 15-03-2024/ Release\
  \ Type: RTB-- Taken from SSQA --old code sop.\"OptyNumber\" AS PARENT_OPTY_NUMBER,\n\
  \    sop.\"OptyCloseDate\" as PARENT_OPTY_CLOSE_DT,\n    HASH(sop.\"OptyAccountSysID\"\
  ) AS PARENT_OPTY_ACCOUNT_ID,\n    sap.\"AcctNumber\" AS PARENT_OPTY_ACCOUNT_NUMBER,\n\
  \    HASH(sap.\"AcctTerritorySysID\") AS PARENT_OPTY_ACCOUNT_TERRITORY_ID,\n   \
  \ HASH(parent_opty.\"OptyTerritorySysID\") AS PARENT_OPTY_TERRITORY_ID,\n    --taken\
  \ from ss QA -- OLD CODE HASH(sop.\"OptyTerritorySysID\") AS PARENT_OPTY_TERRITORY_ID,\n\
  \    sop.\"OptyPipelineStatusValue\" AS PARENT_OPTY_FORECAST_CATEGORY,\n    parent_opty.\"\
  OptyForeCastTypeValue\" AS PARENT_OPTY_FORECAST_TYPE,\n    --SS 1.5/Jay Modi/Updated\
  \ on: 04-01-2024/Release on: 02-02-2024/ Release Type: RTB\n    sop.\"OptyContractSignedDate\"\
  \ AS PARENT_OPTY_CONTRACT_SIGNED_DT,\n    --SS 1.5/Jay Modi/Updated on: 04-01-2024/Release\
  \ on: 02-02-2024/ Release Type: RTB\n    sop.\"OptyStageValue\" AS PARENT_OPTY_STAGE,\n\
  \    sop.\"OptyTypeValue\" AS PARENT_OPTY_TYPE,\n    sop.\"OptyOpportunityLinkReason\"\
  \ AS PARENT_OPTY_LINK_REASON,\n    sop.\"OptyName\" AS PARENT_OPTY_NAME,\n    sop.\"\
  OptyContEndDate\" AS PARENT_OPTY_CONTRACT_END_DT,\n    parent_con.\"ContractStartDate\"\
  \ as PARENT_OPTY_CONTRACT_START_DT,\n    sop.\"OptyContractType\" AS PARENT_OPTY_CONTRACT_TYPE,\n\
  \    sop.\"OptyOrderTermEndDate\" AS PARENT_OPTY_ORDER_TERM_END_DT,\n    sop.\"\
  OptyOrderTermStartDate\" AS PARENT_OPTY_ORDER_TERM_START_DT,\n    sop.\"OptyContractDuration\"\
  \ AS PARENT_OPTY_TERM,\n    sop.\"OptyDynamicsGUID\" AS PARENT_OPTY_DYNAMICS_GUID,\n\
  \    NXT_STEPS_PAR.\"NextStepsFull\" AS PARENT_OPTY_NEXT_STEPS,\n    NXT_STEPS_PAR.\"\
  Notes\" AS PARENT_OPTY_NOTES,\n    sop.\"OptyLinkReasonFlag\" AS PARENT_OPTY_LINK_REASON_FLAG,\n\
  \    CASE\n        WHEN opty.\"OptySalesQuarter\" = (\n            RIGHT(\n    \
  \            YEAR(sop.\"OptyCloseDate\") || 'random' || QUARTER(sop.\"OptyCloseDate\"\
  ),\n                --SS 1.5/Avantika Keshav/Updated on: 02-02-2024/Release on:\
  \ 02-02-204/ Release Type: Normal\n                'random'\n            )\n   \
  \     ) THEN NXT_STEPS_PAR.\"NextStepsDateFlag\"\n        ELSE NXT_STEPS.\"NextStepsDateFlag\"\
  \n    END AS PARENT_JOURNAL_DT_FLAG,\n    -- Start of Marquee Columns related changes\
  \ by Avantika/Updated on: 08-02-2024/Release on: TBD/ Release Type: Regular\n  \
  \  CASE\n        WHEN PARENT_OPTY_STAGE IN (\n            'random',\n          \
  \  'random',\n            'random'\n        )\n        OR (\n            PARENT_OPTY_STAGE\
  \ = 'random'\n            AND PARENT_OPTY_TYPE IN ('random', 'random')\n       \
  \ ) THEN 'random'\n        ELSE RIGHT(\n            YEAR(PARENT_OPTY_CLOSE_DT) ||\
  \ 'random' || QUARTER(PARENT_OPTY_CLOSE_DT),\n            'random'\n        )\n\
  \    END AS REPORTING_PARENT_QUARTER_YYQQ,\n    CASE\n        WHEN QUARTER_YYQQ\
  \ = REPORTING_PARENT_QUARTER_YYQQ THEN PARENT_OPTY_ID\n        ELSE OPTY_ID\n  \
  \  END AS REPORTING_OPTY_ID,\n    CASE\n        WHEN QUARTER_YYQQ = REPORTING_PARENT_QUARTER_YYQQ\
  \ THEN PARENT_OPTY_ACCOUNT_ID\n        ELSE OPTY_ACCOUNT_ID\n    END AS REPORTING_OPTY_ACCOUNT_ID,\n\
  \    -- End of Marquee Columns related changes by Avantika/Updated on: 08-02-2024/Release\
  \ on: TBD/ Release Type: Regular\n    NVL(PARENT_OPTY_ID, OPTY_ID) AS SURVIVOR_OPTY_ID,\n\
  \    NVL(PARENT_OPTY_ACCOUNT_ID, OPTY_ACCOUNT_ID) AS SURVIVOR_OPTY_ACCOUNT_ID,\n\
  \    NVL(PARENT_OPTY_NUMBER, OPTY_NUMBER) AS SURVIVOR_OPTY_NUMBER,\n    so.\"OptyContractStatus\"\
  \ AS ORDER_FORM_STATUS,\n    so.\"OptyOrderFormOutputReason\" AS ORDER_FORM_OUTPUT_REASON,\n\
  \    so.\"OptyOrderTermStartDate\" AS ORDER_FORM_START_DT,\n    so.\"OptyOrderTermEndDate\"\
  \ AS ORDER_FORM_END_DT,\n    HASH(so.\"OptyLeadNumberValue\") AS LEAD_ID,\n    so.\"\
  OptyLeadNumberValue\" AS LEAD_NUMBER,\n    so.\"OptyLeadSource\" AS LEAD_SOURCE,\n\
  \    HASH(so.\"OptyRenewalRepSysID\") AS RENEWAL_ACCOUNT_MANAGER_ID,\n    so.\"\
  OptyRenewalRep\" AS RENEWAL_ACCOUNT_MANAGER,\n    so.\"OptyRenewalCategoryValue\"\
  \ AS RENEWAL_CATEGORY,\n    so.\"OptyRenewalStatusValue\" AS RENEWAL_STATUS,\n \
  \   so.\"OptyRenewalsEngagement\" AS RENEWALS_ENGAGEMENT,\n    -- Renewal Columns\
  \ changes started by Jaya Prakash/Updated on: 23-01-2024/Release on: 02-02-2024/\
  \ Release Type: Regular\n    ---New logic taken from SSQA Start\n    case\n    \
  \    when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when opty.\"\
  OptyForeCastTypeValue\" in (\n            'random',\n            'random'\n    \
  \    ) then msp_terr.\"TerrGeo\"\n        else terr.\"TerrGeo\"\n    end as RENEWAL_GEO,\n\
  \    case\n        when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n \
  \       when opty.\"OptyForeCastTypeValue\" in (\n            'random',\n      \
  \      'random'\n        ) then msp_terr.\"TerrMajorArea\"\n        else terr.\"\
  TerrMajorArea\"\n    end as RENEWAL_MAJOR_AREA,\n    case\n        when opty.\"\
  OptyForeCastTypeValue\" IS NULL then 'random'\n        when opty.\"OptyForeCastTypeValue\"\
  \ in (\n            'random',\n            'random'\n        ) then msp_terr.\"\
  TerrArea\"\n        else terr.\"TerrArea\"\n    end as RENEWAL_AREA,\n    case\n\
  \        when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when\
  \ opty.\"OptyForeCastTypeValue\" in (\n            'random',\n            'random'\n\
  \        ) then msp_terr.\"TerrRegion\"\n        else terr.\"TerrRegion\"\n    end\
  \ as RENEWAL_REGION,\n    case\n        when opty.\"OptyForeCastTypeValue\" IS NULL\
  \ then 'random'\n        when opty.\"OptyForeCastTypeValue\" in (\n            'random',\n\
  \            'random'\n        ) then msp_terr.\"TerrDistrict\"\n        else terr.\"\
  TerrDistrict\"\n    end as RENEWAL_DISTRICT,\n    case\n        when opty.\"OptyForeCastTypeValue\"\
  \ IS NULL then 'random'\n        when opty.\"OptyForeCastTypeValue\" in (\n    \
  \        'random',\n            'random'\n        ) then msp_terr.\"TerrName\"\n\
  \        else terr.\"TerrName\"\n    end as RENEWAL_TERRITORY,\n    CASE\n     \
  \   when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when opty.\"\
  OptyForeCastTypeValue\" in (\n            'random',\n            'random'\n    \
  \    ) then msp_terr.\"TerrSysID\"\n        else terr.\"TerrSysID\"\n    END as\
  \ RENEWAL_TERRITORY_SYSID,\n    HASH(RENEWAL_TERRITORY_SYSID) AS RENEWAL_TERRITORY_ID,\n\
  \    --Renewal Columns changes ended by Jaya Prakash/Updated on: 23-01-2024/Release\
  \ on: 02-02-2024/ Release Type: Regular\n    CASE\n        WHEN (\n            RENEWAL_MAJOR_AREA\
  \ IS NULL\n            OR RENEWAL_MAJOR_AREA != 'random'\n        )\n        AND\
  \ (\n            CONTRACT_TYPE IS NULL\n            OR CONTRACT_TYPE NOT IN(\n \
  \               'random',\n                'random',\n                'random',\n\
  \                'random',\n                'random'\n            )\n        ) THEN\
  \ 'random'\n        ELSE 'random'\n    END AS IS_RENEWAL_CRITERIA,\n    --SS 1.5/Jaya\
  \ Prakash/Updated on: 25-01-2024/Release on: 02-02-2024/ Release Type: Regular\n\
  \    so.\"OptyRisk\" AS OPTY_RISK,\n    opty_dynamics.\"OpportunityRiskMitigationSteps\"\
  \ AS RISK_MITIGATION_STEPS,\n    opty_dynamics.\"OpportunityRiskReasonCodeName\"\
  \ AS RISK_REASON_CODE_NAME,\n    CASE\n        WHEN opty_dynamics.\"OpportunityRiskReasonCodeName\"\
  \ IN (\n            'random',\n            'random',\n            'random',\n  \
  \          'random',\n            'random'\n        ) THEN 'random'\n        WHEN\
  \ opty_dynamics.\"OpportunityRiskReasonCodeName\" IN ('random', 'random') THEN 'random'\n\
  \        WHEN opty_dynamics.\"OpportunityRiskReasonCodeName\" IN (\n           \
  \ 'random',\n            'random',\n            'random',\n            'random'\n\
  \        ) THEN 'random'\n        ELSE 'random'\n    END AS RISK_REASON_CATEGORY,\n\
  \    --SS 1.5/Jaya Prakash/Updated on: 04-01-2024/Release on: 02-02-2024/ Release\
  \ Type: Regular\n    so.\"OptyCreatedBy\" AS OPTY_CREATED_BY,\n    HASH(so.\"OptyOverlayIsr\"\
  ) AS OPTY_ADR_ID,\n    so.\"OptyADR\" AS OPTY_ADR,\n    so.\"OptyBaseCurrency\"\
  \ AS BASE_CURRENCY,\n    so.\"OptyARNotes\" AS AR_NOTES,\n    so.\"OptyAuditingNotes\"\
  \ AS AUDIT_NOTES,\n    so.\"OptyISRInteraction\" AS ADR_INTERACTION,\n    so.\"\
  OptyMSPSalesValue\" AS ACE_SALESREP,\n    HASH(so.\"OptyMSPSalesSysID\") AS ACE_SALESREP_ID,\n\
  \    opty_sales_mgr.\"EmpEmployeeNumber\" AS ACE_SALESREP_NUMBER,\n    opty_sales_mgr.\"\
  EmpManagerName\" AS ACE_SALES_MANAGER,\n    HASH(so.\"OptyMSPTerritorySysID\") AS\
  \ ACE_TERRITORY_ID,\n    so.\"OptyMSPTerritory\" AS ACE_TERRITORY_NAME,\n    so.\"\
  OptyAllowableDiscountLevel\" AS ALLOWABLE_DISCOUNT_LEVEL,\n    HASH(so.\"OptyInsideSalesRepSysID\"\
  ) AS ESR_OWNER_ID,\n    emp_esr_mgr.\"EmpName\" AS ESR_OWNER,\n    emp_esr_mgr.\"\
  EmpManagerName\" AS ESR_MANAGER,\n    LEFT(so.\"OptyCampaignHistoryValue\", 'random')\
  \ AS CAMPAIGN_HISTORY,\n    opty.\"OptyCoDelivery\" AS CODELIVERY,\n    so.\"OptyCOManaged\"\
  \ AS IS_COMANAGED,\n    so.\"OptyCompetition\" AS OPTY_COMPETITION,\n    so.\"OptyCompititveStatus\"\
  \ AS COMPETITVE_STATUS,\n    so.\"OptyConstantFXRate\" AS CONSTANT_FX,\n    HASH(so.\"\
  OptyPSEngagementManagerSysID\") AS CUSTOMER_OUTCOME_OWNER_ID,\n    so.\"OptyPSEngagementManager\"\
  \ AS CUSTOMER_OUTCOME_OWNER,\n    emp_engm_mgr.\"EmpManagerName\" AS CUSTOMER_OUTCOME_OWNER_MANAGER,\n\
  \    sop.\"OptyDVOwner\" AS PARENT_OPTY_OWNER_NAME,--SS 1.5/Jay Modi/Updated on:\
  \ 19-06-2024/Release on: 19-07-2024/ Release Type: RTB\n    HASH(so.\"OptyDynamicsDealChampionName\"\
  ) AS DYNAMICS_DEAL_CHAMPION_ID,\n    so.\"OptyDynamicsDealChampionName\" AS DYNAMICS_DEAL_CHAMPION,\n\
  \    so.\"OptyDeploymentRegistrationNumber\" AS DEPLOYMENT_REGISTRATION_NUMBER,\n\
  \    so.\"OptyDataCenter\" AS DATA_CENTER,\n    so.\"OptyDidMarketingHelp\" AS DID_MARKETING_HELP,\n\
  \    so.\"OptyDoubleCompensationOverlay\" AS DOUBLE_COMP_OVERLAY,\n    overlay_emp.\"\
  EmpEmployeeNumber\" AS DOUBLE_COMP_OVERLAY_EMPLOYEE_NUMBER,\n    LOWER(so.\"OptyDynamicsGUID\"\
  ) AS DYNAMICS_GUID,\n    CONCAT(\n        'random',\n        DYNAMICS_GUID\n   \
  \ ) AS DYNAMICS_URL,\n    --SS 1.5/Jay Modi/Updated on: 24-04-2024/Release on: 15-05-2024/\
  \ Release Type: RTB\n    emp_engm_mgr.\"EmpUserName\" AS ENGAGEMENT_MANAGER_USER_NAME,\n\
  \    opty_extension.\"OptyExtnChannelTransactionType_CC\" as OPTY_EXTENSION_CHANNEL_TRANSACTION_TYPE,\
  \ --SS 1.5/Jay Modi/Updated on: 19-06-2024/Release on: 19-07-2024/ Release Type:\
  \ RTB\n    opty_extension.\"OptyExtnTransactingPartner\" as OPTY_EXTENSION_TRANSACTING_PARTNER,\
  \ --SS 1.5/Jay Modi/Updated on: 19-06-2024/Release on: 19-07-2024/ Release Type:\
  \ RTB\n    so.\"OptyLogoOverrideLabel\" AS ENTERPRISE_LOGO_OVERRIDE,\n    so.\"\
  OptyMSPEnvironmentType\" AS OPTY_ENVIRONMENT_TYPE,\n    so.\"OptyExpressNewLogoOverride\"\
  \ AS EXPRESS_NEWLOGO_OVERRIDE,\n    so.\"OptyExtension\" AS OPTY_EXTENSION,\n  \
  \  emp_opty_owner.\"EmpTitle\" AS FIELD_SALES_BUSINESS_TITLE,\n    HASH(so.\"OptyOwnerSysID\"\
  ) AS FIELD_SALES_MANAGER_ID,\n    emp_opty_owner.\"EmpManagerName\" AS FIELD_SALES_MANAGER,\n\
  \    HASH(opty.\"OptyMSPTerritorySysID\") AS FIELD_SALES_TERRITORY_ID,\n    HASH(so.\"\
  OptyApprovalTerritorySysID\") AS APPROVAL_TERRITORY_ID,\n    so.\"OptyApprovalTerritorySysID\"\
  \ AS APPROVAL_TERRITORY_SYSID,\n    so.\"OptyFirstClosedByValue\" AS FIRST_CLOSED_BY,\n\
  \    so.\"OptyFirstClosedOn\" AS FIRST_CLOSED_TS,\n    so.\"OptyFlags\" AS OPTY_FLAGS,\n\
  \    opty.\"OptyForeCastTypeValue\" AS FORECAST_TYPE, ---This attribute is present\
  \ on PROD, SS1.5 has Developed  21-June.\n    so.\"OptyNewLogo\" AS IS_NEW_LOGO,\n\
  \    --SS 1.5/Jay Modi/Updated on: 04-01-2024/Release on: 02-02-2024/ Release Type:\
  \ RTB\n    so.\"OptyPartnerInfluencer\" AS GSI_PARTNER,\n    so.\"OptyImplementationPartnerPS\"\
  \ AS IMPLEMENTATION_PARTNER,\n    opty_dynamics.\"ImplementationModeName\" AS IMPLEMENTATION_MODE,\n\
  \    IFNULL(opty_dynamics.\"OptyTechnicalWinName_CC\", 'random') as OPTY_TECHNICAL_WIN,\
  \   --SS 1.5/Jay Modi/Updated on: 22-05-2024/Release on: 19-07-2024/ Release Type:\
  \ RTB\n    case\n    when parent_opty.\"OptyNumber\"=opty.\"OptyNumber\" then IFNULL(opty_dynamics.\"\
  OptyTechnicalWinName_CC\", 'random')\n      else IFNULL(opty_dynamics.\"OptyParentTechnicalWinName_CC\"\
  , IFNULL(parent_opty_dynamics.\"OptyTechnicalWinName_CC\", 'random'))\n    end as\
  \ PARENT_OPTY_TECHNICAL_WIN,  --SS 1.5/Jay Modi/Updated on: 22-05-2024/Release on:\
  \ 19-07-2024/ Release Type: RTB\n    opty.\"OptyIncumbent\" AS OPTY_INCUMBENT,\n\
  \    so.\"OptyIsBIU\" AS IS_BIU,\n    so.\"OptyJournalNotes\" AS JOURNAL_NOTES,\n\
  \    so.\"OptyOpportunityLinkReason\" AS LINK_REASON,\n    so.\"OptyLinkReasonFlag\"\
  \ AS LINK_REASON_CATEGORY,\n    so.\"OptyLinkReasonFlag\" AS LINK_REASON_FLAG,\n\
  \    so.\"OptyMarketingProgramEvent\" AS MARKETING_PROGRAM_EVENT,\n    so.\"OptyMeetingID\"\
  \ AS MEETING_NUMBER,\n    NXT_STEPS.\"NextStepsFull\" AS NEXT_STEPS,\n    NXT_STEPS.\"\
  NextSteps\" AS NEXT_STEPS_BRIEF,\n    NXT_STEPS.\"NextStepsLastUpdatedDate\" AS\
  \ NEXT_STEPS_LAST_UPDATED_TS,\n    so.\"OptyNextStepsJournaled\" AS NEXT_STEPS_JOURNALED,\n\
  \    NXT_STEPS.\"Notes\" AS NOTES,\n    NXT_STEPS.\"NotesLastUpdatedDate\" AS NOTES_LAST_UPDATED_TS,\n\
  \    so.\"OptyOffsettingValue\" AS OFFSET_VALUE,\n    so.\"OptyOtherCompetitor\"\
  \ AS OTHER_COMPETITOR,\n    Overlayadr.\"EmpManagerName\" AS OVERLAY_ADR_MANAGER,\n\
  \    so.\"OptyPartnered\" AS IS_PARTNERED,\n    opty.\"OptyPartnershipType\" AS\
  \ PARTNERSHIP_TYPE,\n    so.\"OptyPipelineSourced\" AS PIPELINE_SOURCE,\n    so.\"\
  OptyPriceBand\" AS PRICE_BAND,\n    so.\"OptyPriceBook\" AS PRICE_BOOK,\n    so.\"\
  OptyPrimaryCompetitor\" AS PRIMARY_COMPETITOR,\n    so.\"OptyProductTechnologyPartner\"\
  \ AS PRODUCT_TECHNOLOGY_PARTNER,\n    HASH(so.\"OptyPSTerritorySysID\") AS PS_TERRITORY_ID,\n\
  \    so.\"OptyPSTeaming\" AS PS_TEAM,\n    so.\"OptyReasonCode\" AS REASON_CODE,\n\
  \    so.\"OptySalesOrderNumber\" AS SALES_ORDER_NUMBER,\n    so.\"OptySAPContractID\"\
  \ AS SAP_CONTRACT_ID,\n    HASH(so.\"OptyContractSysID\") AS CONTRACT_ID,\n    --SS\
  \ 1.5/Jay Modi/Updated on: 04-01-2024/Release on: 02-02-2024/ Release Type: RTB\n\
  \    so.\"OptySecondaryCompetitor\" AS SECONDARY_COMPETITOR,\n    so.\"OptyMSPPartner\"\
  \ AS OPTY_SERVICE_PROVIDER,\n    so.\"OptyMSPUsageType\" AS OPTY_SERVICE_PROVIDER_USAGE_TYPE,\n\
  \    opty.\"OptyImplementationPartner\" AS OPTY_SERVICES_PARTNER,\n    so.\"OptyServicesType\"\
  \ AS OPTY_SERVICES_TYPE,\n    HASH(so.\"OptySolutionConsultant\") AS SOLUTION_CONSULTANT_ID,\n\
  \    so.\"OptySolutionConsultantValue\" AS SOLUTION_CONSULTANT,\n    emp_solut_mgr.\"\
  OpportunitySolutionConsultantManager\" AS SOLUTION_CONSULTANT_MANAGER,\n    emp_solut_mgr.\"\
  OpportunitySolutionConsultantManagerManager\" AS SOLUTION_CONSULTANT_MANAGER_MANAGER,\n\
  \    so.\"OptyOpportunitySourceValue\" AS OPTY_SOURCE,\n    so.\"OptySourced\" AS\
  \ IS_OPTY_SOURCED,\n    so.\"OptyEndCustomerName\" AS SP_END_CUSTOMER_NAME,\n  \
  \  so.\"OptyStartDateDimension\" AS OPTY_START_DT,\n    so.\"OptySuccessServiceAttach\"\
  \ AS SUCCESS_SERVICE_ATTACH_STATUS,\n    so.\"OptySupportPartner\" AS SUPPORT_PARTNER,\n\
  \    so.\"OptyTermMonthsDays\" AS TERM_MONTHS_AND_DAYS,\n    so.\"OptyTiming\" AS\
  \ OPTY_TIMING,\n    HASH(so.\"OptyEducationISRID\") AS TRAINING_ACCOUNT_EXECUTIVE_ID,\n\
  \    so.\"OptyEducationISRID\" AS TRAINING_ACCOUNT_EXECUTIVE_SYSID,\n    so.\"OptyEducationISR\"\
  \ AS TRAINING_ACCOUNT_EXECUTIVE,\n    so.\"OptyUpdatedBy\" AS OPTY_UPDATED_BY,\n\
  \    so.\"OptyUpdatedOn\" AS OPTY_UPDATED_TS,\n    so.\"OptySalesClosedDate\" as\
  \ OPTY_SALES_COMPLETED_TS,\n    --SS 1.5/Avantika Keshav/Updated on: 12-03-2024/Release\
  \ on: 15-03-2024/ Release Type: RTB -- Updated by Jay Modi on 15-04-2024/Release\
  \ on: 17-04-2024/ Release Type: RTB\n    so.\"OptyFirstSubmittedDate\" as OPTY_FIRST_SUBMITTED_TS,\n\
  \    --SS 1.5/Avantika Keshav/Updated on: 12-03-2024/Release on: 15-03-2024/ Release\
  \ Type: RTB\n    so.\"OptyUpdatedToContract\" AS IS_UPDATED_TO_CONTRACT,\n    so.\"\
  OptyWinLossDeadNotes\" AS WINLOSS_NODECISION_NOTES,\n    so.\"OptyCompititiveReason\"\
  \ AS WINLOSS_NODECISION_REASON,\n    so.\"OptyChangeOrder\" AS IS_CHANGE_ORDER,\n\
  \    so.\"OptyContractDuration\" AS OPTY_TERM,\n    so.\"OptyTerm\" AS OPTY_TERM_PRECISE,\n\
  \    CASE\n        WHEN \"CHQNewLogoFlag\" IS not NULL\n        AND \"CHQNewLogoFlag\"\
  \ = 'random' THEN 'random'\n        ELSE 'random'\n    END AS IS_GP_NEW_LOGO,\n\
  \    CASE\n        WHEN \"CHQNewLogoFlag\" IS not NULL\n        AND \"CHQNewLogoFlag\"\
  \ = 'random' THEN 'random'\n        ELSE 'random'\n    END AS IS_GP_POTENTIAL_NEW_LOGO,\n\
  \    CASE\n        WHEN \"FSPNewLogoFlag\" IS not NULL\n        AND \"FSPNewLogoFlag\"\
  \ = 'random' THEN 'random'\n        ELSE 'random'\n    END AS IS_DP_NEW_LOGO,CASE\n\
  \        WHEN \"FSPNewLogoFlag\" IS not NULL\n        AND \"FSPNewLogoFlag\" = 'random'\
  \ THEN 'random'\n        ELSE 'random'\n    END AS IS_DP_POTENTIAL_NEW_LOGO,\n \
  \   CASE\n        WHEN \"AnaplanAccountFlag\" IS not NULL\n        AND \"AnaplanAccountFlag\"\
  \ = 'random' THEN 'random'\n        ELSE 'random'\n    END AS IS_ELIGIBLE_NEW_LOGO,\n\
  \    so.\"OptyRenewalDriven\" AS IS_RENEWAL_DRIVEN,\n    /*CASE   WHEN so.\"OptyStageValue\"\
  \ IN(\n                '1 - Opportunity (1%)',\n                '2 - Discovery (5%)',\n\
  \                '3 - Objectives (10%)',\n                '4 - Present Solution\
  \ (20%)',\n                '4 - Economic Buyer Identified (30%)',\n            \
  \    '5 - Economic Buyer Validation (40%)',\n                '6 - Validation Completed\
  \ (70%)',\n                '7 - Deal Imminent (90%)'\n            )\n          \
  \  AND LOWER(so.\"OptyPipelineStatusValue\") not in(\n                'lead',\n\
  \                'omitted',\n                'closed',\n                'inactive',\n\
  \                'lost',\n                'pre-pipeline'\n            ) OR\n   \
  \         (CASE WHEN  so.\"OptyStageValue\" = '8 - Closed Won (100%)'\n        \
  \                OR (\n                            so.\"OptyStageValue\" = '8 -\
  \ Closed Lost (100%)'\n                            and so.\"OptyType\" = 'Renewal'\n\
  \                        )\n                  THEN 1\n                  ELSE 0\n\
  \            END\n            ) = 1\n        THEN 1\n        ELSE 0\n    END as\
  \ IS_PIPELINE_ACTIVE,*/\n    opty.IS_PIPELINE_ACTIVE, --SS 1.5/Avantika Keshav/Updated\
  \ on: 19-06-2024/Release on: 19-07-2024/ Release Type: RTB\n    --SS1.5\n    ds.\"\
  ProbabilityToCloseInQtr\" as PROBABILITY_TO_CLOSE_IN_QTR,\n    --SS 1.5/Jay Modi/Updated\
  \ on: 24-04-2024/Release on: 15-05-2024/ Release Type: RTB\n    opty.\"OptySysID\"\
  \ AS OPTY_SYSID,\n    so.\"OptyOwnerSysID\" AS OPTY_OWNER_SYSID,\n    opty.\"OptyTerritorySysID\"\
  \ AS OPTY_TERRITORY_SYSID,\n    so.\"OptyTerritorySysID\" AS FIELD_TERRITORY_SYSID,\n\
  \    --SS 1.5/Jaya Prakash/Updated on: 25-01-2024/Release on: 02-02-2024/ Release\
  \ Type: Regular\n    terr.\"TerrGeoSysID\" AS GEO_SYSID,\n    opty.\"OptyAccountSysID\"\
  \ AS OPTY_ACCOUNT_SYSID,\n    so.\"OptyPSTerritorySysID\" AS PS_TERRITORY_SYSID,\n\
  \    opty.\"OptyParentSysID\" AS PARENT_OPTY_SYSID,\n    sop.\"OptyAccountSysID\"\
  \ AS PARENT_OPTY_ACCOUNT_SYSID,\n    --SS 1.5/Avantika Keshav/Updated on: 02-02-2024/Release\
  \ on: 02-02-204/ Release Type: Normal\n    sap.\"AcctTerritorySysID\" AS PARENT_OPTY_ACCOUNT_TERRITORY_SYSID,\n\
  \    sop.\"OptyTerritorySysID\" AS PARENT_OPTY_TERRITORY_SYSID,\n    --SS 1.5/Avantika\
  \ Keshav/Updated on: 02-02-2024/Release on: 02-02-204/ Release Type: Normal\n  \
  \  so.\"OptyOverlayIsr\" AS OPTY_ADR_EMPLOYEE_SYSID,\n    so.\"OptyMSPSalesSysID\"\
  \ AS ACE_SALESREP_SYSID,\n    so.\"OptyMSPTerritorySysID\" AS ACE_TERRITORY_SYSID,\n\
  \    so.\"OptyInsideSalesRepSysID\" AS ESR_OWNER_SYSID,\n    so.\"OptyPSEngagementManagerSysID\"\
  \ AS CUSTOMER_OUTCOME_OWNER_SYSID,\n    so.\"OptySolutionConsultant\" AS SOLUTION_CONSULTANT_SYSID,\n\
  \    so.\"OptyRenewalRepSysID\" AS RENEWAL_ACCOUNT_MANAGER_SYSID,\n    so.\"OptyContractSysID\"\
  \ AS CONTRACT_SYSID,\n    --SS 1.5/Jay Modi/Updated on: 04-01-2024/Release on: 02-02-2024/\
  \ Release Type: RTB\n    so.\"OptyCOManaged\" AS PARENT_OPTY_MANAGEMENT,\n    ds.\"\
  ReasonCode1\" AS OPTY_ML_PREDICTION_RISK_REASON1,\n    ds.\"ReasonCode2\" AS OPTY_ML_PREDICTION_RISK_REASON2,\n\
  \    ds.\"ReasonCode3\" AS OPTY_ML_PREDICTION_RISK_REASON3,\n    ds.\"ReasonCode4\"\
  \ AS OPTY_ML_PREDICTION_RISK_REASON4,\n    ds.\"ReasonCode5\" AS OPTY_ML_PREDICTION_RISK_REASON5,\n\
  \    ds.\"ReasonCode6\" AS OPTY_ML_PREDICTION_RISK_REASON6,\n    ds.\"PredictedToCloseInQtr\"\
  \ AS IS_OPTY_PREDICTED_TO_CLOSE,\n    ds.\"ProbabilityToCloseInQtr\" AS OPTY_CLOSE_PROBABILITY,\n\
  \    ----Prabhat commented as SS is already added the same source column with differtnt\
  \ name\n    sop.\"OptyRenewalCategoryValue\" AS PARENT_OPTY_RENEWAL_CATEGORY,\n\
  \    Rank1.\"JournalCreatedOn\" AS JOURNAL_CREATED_DT,\n    /*\n        \t  IFF(\"\
  JournalCreatedOn\" is NULL, NULL, IFF(\"JournalCreatedOn\" >= DATEADD(DAY, -7, convert_timezone('America/Los_Angeles',\
  \ CURRENT_TIMESTAMP())), 'G',\n        \t\t IFF(\"JournalCreatedOn\" >= DATEADD(DAY,\
  \ -15, convert_timezone('America/Los_Angeles', CURRENT_TIMESTAMP())), 'Y', 'R'))\n\
  \        \t*/\n    CASE\n        WHEN (Rank1.\"JournalCreatedOn\" IS NULL) THEN\
  \ 'random'\n        WHEN (\n            Rank1.\"JournalCreatedOn\" >= DATEADD(\n\
  \                DAY,\n                'random',\n                convert_timezone('random',\
  \ CURRENT_TIMESTAMP())\n            )\n        ) THEN 'random'\n        WHEN (\n\
  \            Rank1.\"JournalCreatedOn\" >= DATEADD(\n                DAY,\n    \
  \            'random',\n                convert_timezone('random', CURRENT_TIMESTAMP())\n\
  \            )\n        ) THEN 'random'\n        ELSE 'random'\n    END AS JOURNAL_STATUS,\n\
  \    --Rank1.\"JournalCreatedOn\" >= DATEADD(DAY, -15, convert_timezone('America/Los_Angeles',\
  \ CURRENT_TIMESTAMP())), 'Y', 'R'))) as JOURNAL_STATUS),\n    --IFF(Rank1.\"JournalCreatedOn\"\
  \ >= DATEADD(DAY, -15, convert_timezone('America/Los_Angeles', CURRENT_TIMESTAMP())),\
  \ 'Y', 'R'))) as JOURNAL_STATUS),\n    ----ds.\"JournalDateFlag\" AS JOURNAL_STATUS,\n\
  \    SNOS.\"SN_CHALLENGES\" AS OPTY_CHALLENGES,\n    SNOS.\"SN_OBJECTIVES\" AS OPTY_OBJECTIVE,\n\
  \    SNOS.\"SN_OUTCOMES\" AS OPTY_OUTCOMES,\n    IFF(\n        (opty_dynamics.\"\
  OptyParentTechnicalWinName\") IS NULL,\n        'random',\n        opty_dynamics.\"\
  OptyParentTechnicalWinName\"\n    ) AS PARENT_OPTY_TECHNICAL_WIN_NAME,\n    opty_dynamics.\"\
  OptyParentTechnicalWinName_CC\" AS PARENT_OPTY_TECHNICAL_WIN_STATUS,\n    ds.\"\
  PredictedToCloseInQtr\" AS IS_PARENT_OPTY_PREDICTED_TO_CLOSE,\n    ds.\"ProbabilityToCloseInQtr\"\
  \ AS PARENT_OPTY_CLOSE_PROBABALILITY,\n    so.\"OptyRenewalStatusValue\" AS PARENT_OPTY_RENEWAL_STATUS,(\n\
  \        CASE\n            WHEN sop.\"OptyDynamicsGUID\" = SNOS.\"SN_OPPORTUNITYID\"\
  \ THEN 'random'\n            ELSE 'random'\n        END\n    ) AS \"OptySummaryFlag\"\
  ,\n    opd.\"PartnerAccountSysID\" AS PARENT_PARTNER_ACCOUNT_SYSID,\n    opd.\"\
  ParentPartnerAccount\" AS PARENT_PARTNER_ACCOUNT_NAME,\n    so.\"OptyPipelineSourced\"\
  \ AS PARENT_OPTY_SOURCE,\n    opd.\"PartnerUltimateParentAccount\" AS PARTNER_ULTIMATE_PARENT_ACCOUNT,\n\
  \    opd.\"PartnerUltimateParentAccount\" AS PARTNER_ULTIMATE_CHILD_ACCOUNT,\n \
  \   CASE\n        WHEN (\n            opty.\"OptyStageValue\" IN (\n           \
  \     'random',\n                'random'\n            )\n        ) THEN 'random'\n\
  \        ELSE 'random'\n    END AS OPTY_OPEN_CLOSED_FLAG,\n    /*Renamed by Accn\
  \ Prabhat on 01-April*/\n    (current_date() - so.\"OptyContEndDate\") AS CC_DAYS_OVERDUE,\n\
  \    CASE\n        WHEN (\n            so.\"OptyContEndDate\" < current_date()\n\
  \            AND opty.\"OptyPipelineStatusValue\" <> 'random'\n        ) THEN 'random'\n\
  \        ELSE 'random'\n    END AS CC_OVERDUE_RENEWAL_FLAG ------columns are added\
  \ as part of enhancements for tableau calculated column to backend by Yash-----\n\
  ,CASE\n        WHEN opty.\"OptyPipelineStatusValue\" = 'random'\n        AND opty.\"\
  OptyStageValue\" = 'random' THEN 'random'\n        WHEN opty.\"OptyPipelineStatusValue\"\
  \ = 'random'\n        AND opty.\"OptyStageValue\" = 'random' THEN 'random'\n   \
  \     ELSE 'random'\n    END AS RENEWAL_OPTY_OPEN_CLOSED_STATUS,\n    CASE\n   \
  \     WHEN sop.\"OptyPipelineStatusValue\" = 'random'\n        AND sop.\"OptyStageValue\"\
  \ = 'random' THEN 'random'\n        WHEN sop.\"OptyPipelineStatusValue\" = 'random'\n\
  \        AND sop.\"OptyStageValue\" = 'random' THEN 'random'\n        ELSE 'random'\n\
  \    END AS CC_PARENT_CLOSED_OPEN_STATUS,\n    CASE\n        WHEN (\n          \
  \  opty.\"OptyStageValue\" IN ('random')\n            OR opty.\"OptyStageValue\"\
  \ IN ('random')\n        ) THEN LEFT(opty.\"OptyStageValue\", 'random') || 'random'\
  \ || REPLACE(RIGHT(opty.\"OptyStageValue\", 'random'), 'random', 'random')\n   \
  \     WHEN opty.\"OptyStageValue\" <> 'random' THEN LEFT(opty.\"OptyStageValue\"\
  , 'random') || 'random' || REPLACE(RIGHT(opty.\"OptyStageValue\", 'random'), 'random',\
  \ 'random')\n        ELSE LEFT(opty.\"OptyStageValue\", 'random') || 'random' ||\
  \ REPLACE(RIGHT(opty.\"OptyStageValue\", 'random'), 'random', 'random')\n    END\
  \ AS OPTY_STAGE_PCT_DV1,--Added by Accn Santhosh on 04/09 as part of PBI migration.\n\
  \    CASE\n        when (\n            sop.\"OptyStageValue\" IN ('random')\n  \
  \          OR sop.\"OptyStageValue\" IN ('random')\n        ) THEN LEFT(sop.\"OptyStageValue\"\
  , 'random') || 'random' || REPLACE(RIGHT(sop.\"OptyStageValue\", 'random'), 'random',\
  \ 'random')\n        WHEN sop.\"OptyStageValue\" <> 'random' THEN LEFT(sop.\"OptyStageValue\"\
  , 'random') || 'random' || REPLACE(RIGHT(sop.\"OptyStageValue\", 'random'), 'random',\
  \ 'random')\n        ELSE LEFT(sop.\"OptyStageValue\", 'random') || 'random' ||\
  \ REPLACE(RIGHT(sop.\"OptyStageValue\", 'random'), 'random', 'random')\n    END\
  \ AS CC_PARENT_OPTY_STAGE,\n    GN.\"GeneralNotes\" AS OPTY_NOTES,\n    -- Added\
  \ by Santhosh on 03/20/2024(Accenture)\n    /*Below attributes are added by Prabhat\
  \ Start*/\n    GN.\"GeneralNotesCreatedOn\" AS OPTY_NOTES_CREATED_TS,\n    IFNULL(opty_dynamics.\"\
  OptyTechnicalWinName_CC\", 'random') AS OPTY_TECHNICAL_WIN_STATUS,\n    ext.\"OptyExtnChannelTransactionType\"\
  \ AS OPTY_TRANSACTION_TYPE,\n    ext.\"ChildPartnerAccount\" AS PARTNER_ACCOUNT_NAME,\n\
  \    /* attributes are added by Prabhat end */\n    CASE\n        WHEN (\n     \
  \       \"RISK_REASON_CODE_NAME\" IS not NULL\n            AND \"LINK_REASON\" IS\
  \ NULL\n        ) THEN 'random'\n        ELSE 'random'\n    END AS IS_RENEWAL_OPTY_AT_RSK,\n\
  \    -- Added by Sneha on 3/25/2024 (Accenture)\n    CASE\n        WHEN (\n    \
  \        \"RISK_REASON_CODE_NAME\" IS not NULL\n            AND \"LINK_REASON\"\
  \ IS NULL\n            AND \"OPTY_OPEN_CLOSED_FLAG\" = 'random'\n        ) THEN\
  \ 'random'\n        ELSE 'random'\n    END AS IS_RENEWAL_OPTY_OPEN_AT_RSK,\n   \
  \ -- Added by Sneha on 3/26/2024 (Accenture)\n    CASE\n        -- Added by Prabhat\
  \ on 01/04/2024 (Accenture)\n        WHEN oert.\"OptyStage\" = 'random'\n      \
  \  AND oert.\"OptyType\" = 'random'\n        AND oert.\"AccountConsolidationFlag_CC\"\
  \ != 'random' THEN 'random'\n        WHEN oert.\"OptyStage\" = 'random'\n      \
  \  AND oert.\"OptyType\" = 'random'\n        OR (\n            oert.\"OptyStage\"\
  \ = 'random'\n            AND oert.\"OptyType\" = 'random'\n            AND oert.\"\
  AccountConsolidationFlag_CC\" = 'random'\n        ) THEN 'random'\n        WHEN\
  \ oert.\"OptyRenewalStatus\" IN (\n            'random',\n            'random',\n\
  \            'random',\n            'random'\n        )\n        AND oert.\"OptyType\"\
  \ = 'random'\n        AND (oert.\"OptyRenewalStatus\") IS not NULL THEN 'random'\n\
  \        WHEN oert.\"OptyStage\" IN (\n            'random',\n            'random',\n\
  \            'random',\n            'random',\n            'random',\n         \
  \   'random',\n            'random',\n            'random'\n        ) THEN 'random'\n\
  \        ELSE 'random'\n    END AS RENEWAL_STATUS_LEGACY,\n    ---- Added by Prabhat\
  \ on 01/04/2024 (Accenture)\n    CASE\n        -- Added by Prabhat on 01/04/2024\
  \ (Accenture)\n        WHEN oert.\"RenewalStatusFlag_CC\" = 'random' THEN 'random'\n\
  \        WHEN oert.\"RenewalStatusFlag_CC\" in ('random') THEN 'random'\n      \
  \  WHEN oert.\"RenewalStatusFlag_CC\" in ('random', 'random', 'random')\n      \
  \  or oert.\"RenewalStatusFlag_CC\" IS NULL THEN 'random' ----- start of PQOverdueRenewals\
  \ flag\n        WHEN (\n            oert.\"OptySalesQuarter\" = right(\n       \
  \         YEAR(\n                    convert_timezone(\n                       \
  \ 'random',\n                        ADD_MONTHS(current_timestamp, 'random')\n \
  \                   )\n                ) || 'random' || QUARTER(\n             \
  \       convert_timezone(\n                        'random',\n                 \
  \       ADD_MONTHS(current_timestamp, 'random')\n                    )\n       \
  \         ),\n                'random'\n            )\n            AND (\n     \
  \           RIGHT(\n                    YEAR(oert.\"OptyContEndDate\") || 'random'\
  \ || QUARTER(oert.\"OptyContEndDate\"),\n                    'random'\n        \
  \        )\n            ) < right(\n                YEAR(\n                    convert_timezone(\n\
  \                        'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ) || 'random' || QUARTER(\n\
  \                    convert_timezone(\n                        'random',\n    \
  \                    ADD_MONTHS(current_timestamp, 'random')\n                 \
  \   )\n                ),\n                'random'\n            )\n        )\n\
  \        OR (\n            oert.\"OptySalesQuarter\" = RIGHT(\n                YEAR(\n\
  \                    convert_timezone('random', current_timestamp)\n           \
  \     ) || 'random' || QUARTER(\n                    convert_timezone('random',\
  \ current_timestamp)\n                ),\n                'random'\n           \
  \ )\n            AND RIGHT(\n                YEAR(oert.\"OptyContEndDate\") || 'random'\
  \ || QUARTER(oert.\"OptyContEndDate\"),\n                'random'\n            )\
  \ < RIGHT(\n                YEAR(\n                    convert_timezone('random',\
  \ current_timestamp)\n                ) || 'random' || QUARTER(\n              \
  \      convert_timezone('random', current_timestamp)\n                ),\n     \
  \           'random'\n            )\n        )\n        OR (\n            oert.\"\
  OptySalesQuarter\" = RIGHT(\n                YEAR(\n                    convert_timezone(\n\
  \                        'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ) || 'random' || QUARTER(\n\
  \                    convert_timezone(\n                        'random',\n    \
  \                    ADD_MONTHS(current_timestamp, 'random')\n                 \
  \   )\n                ),\n                'random'\n            )\n           \
  \ AND RIGHT(\n                YEAR(oert.\"OptyContEndDate\") || 'random' || QUARTER(oert.\"\
  OptyContEndDate\"),\n                'random'\n            ) < RIGHT(\n        \
  \        YEAR(\n                    convert_timezone(\n                        'random',\n\
  \                        ADD_MONTHS(current_timestamp, 'random')\n             \
  \       )\n                ) || 'random' || QUARTER(\n                    convert_timezone(\n\
  \                        'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n        )\n        OR (\n            oert.\"OptySalesQuarter\" =\
  \ RIGHT(\n                YEAR(\n                    convert_timezone(\n       \
  \                 'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ) || 'random' || QUARTER(\n\
  \                    convert_timezone(\n                        'random',\n    \
  \                    ADD_MONTHS(current_timestamp, 'random')\n                 \
  \   )\n                ),\n                'random'\n            )\n           \
  \ AND RIGHT(\n                YEAR(oert.\"OptyContEndDate\") || 'random' || QUARTER(oert.\"\
  OptyContEndDate\"),\n                'random'\n            ) < RIGHT(\n        \
  \        YEAR(\n                    convert_timezone(\n                        'random',\n\
  \                        ADD_MONTHS(current_timestamp, 'random')\n             \
  \       )\n                ) || 'random' || QUARTER(\n                    convert_timezone(\n\
  \                        'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n        )\n        OR (\n            oert.\"OptySalesQuarter\" =\
  \ RIGHT(\n                YEAR(\n                    convert_timezone(\n       \
  \                 'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ) || 'random' || QUARTER(\n\
  \                    convert_timezone(\n                        'random',\n    \
  \                    ADD_MONTHS(current_timestamp, 'random')\n                 \
  \   )\n                ),\n                'random'\n            )\n           \
  \ AND RIGHT(\n                YEAR(oert.\"OptyContEndDate\") || 'random' || QUARTER(oert.\"\
  OptyContEndDate\"),\n                'random'\n            ) < RIGHT(\n        \
  \        YEAR(\n                    convert_timezone(\n                        'random',\n\
  \                        ADD_MONTHS(current_timestamp, 'random')\n             \
  \       )\n                ) || 'random' || QUARTER(\n                    convert_timezone(\n\
  \                        'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n        )\n        OR (\n            oert.\"OptySalesQuarter\" =\
  \ right(\n                YEAR(\n                    convert_timezone(\n       \
  \                 'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ) || 'random' || QUARTER(\n\
  \                    convert_timezone(\n                        'random',\n    \
  \                    ADD_MONTHS(current_timestamp, 'random')\n                 \
  \   )\n                ),\n                'random'\n            )\n           \
  \ AND RIGHT(\n                YEAR(oert.\"OptyContEndDate\") || 'random' || QUARTER(oert.\"\
  OptyContEndDate\"),\n                'random'\n            ) < RIGHT(\n        \
  \        YEAR(\n                    convert_timezone(\n                        'random',\n\
  \                        ADD_MONTHS(current_timestamp, 'random')\n             \
  \       )\n                ) || 'random' || QUARTER(\n                    convert_timezone(\n\
  \                        'random',\n                        ADD_MONTHS(current_timestamp,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n        )\n        AND oert.\"RenewalStatusFlag_CC\" = 'random'\
  \ THEN 'random'\n        ELSE 'random'\n    END AS TIMELINE_STATUS,\n    -- Added\
  \ by Prabhat on 01/04/2024 (Accenture)\n    CASE\n        WHEN ROUND(\"OPTY_CLOSE_PROBABILITY\"\
  , 'random') <= 'random' THEN 'random'\n        WHEN ROUND(\"OPTY_CLOSE_PROBABILITY\"\
  , 'random') > 'random'\n        AND ROUND(\"OPTY_CLOSE_PROBABILITY\", 'random')\
  \ <= 'random' THEN 'random'\n        WHEN ROUND(\"OPTY_CLOSE_PROBABILITY\", 'random')\
  \ > 'random'\n        AND ROUND(\"OPTY_CLOSE_PROBABILITY\", 'random') <= 'random'\
  \ THEN 'random'\n        WHEN ROUND(\"OPTY_CLOSE_PROBABILITY\", 'random') > 'random'\
  \ THEN 'random'\n    END AS OPTY_CLOSE_PROBABILITY_BUCKET,\n    -- Added by Matt\
  \ on April 2 2024 (Accenture)\n    CASE\n        WHEN so.\"OptyPipelineStatusValue\"\
  \ = 'random'\n        AND(\n            so.\"OptyStageValue\" = 'random'\n     \
  \       OR so.\"OptyStageValue\" = 'random'\n            OR so.\"OptyStageValue\"\
  \ = 'random'\n        ) THEN 'random'\n        ELSE 'random'\n    END AS OPTY_OPEN_CLOSED_INCL_NO_DECISION_STATUS,\n\
  \    --Added by Jyoti(Accenture) on 04/19/24\n    ------ Start of code by Santhosh(Accenture)\
  \ on 23-Apr-2024 ------------------------------\n    CASE\n        WHEN DATEDIFF('random',\
  \ CONTRACT_END_DT, OPTY_CLOSE_DT) > 'random'\n        OR RIGHT(OPTY_CLOSE_DT, 'random')\
  \ IN (\n            'random',\n            'random',\n            'random',\n  \
  \          'random',\n            'random',\n            'random',\n           \
  \ 'random',\n            'random'\n        ) THEN 'random'\n        ELSE 'random'\n\
  \    END AS IS_RENEWAL_OPTY_CQ_LATE_RSK,\n    ------ End code by Santhosh(Accenture)\
  \ on 23-Apr-2024 ------------------------------\n    ------ Start of code by Santhosh(Accenture)\
  \ on 08-May-2024 ------------------------------\n    CASE\n        WHEN opty.\"\
  OptyPipelineStatusValue\" = 'random'\n        AND RENEWAL_STATUS_LEGACY = 'random'\n\
  \        AND BA.\"AcctWWNNACVBridgeFlag\" = 'random' THEN RENEWAL_STATUS_LEGACY\n\
  \        WHEN opty.\"OptyPipelineStatusValue\" = 'random'\n        AND BA.\"AcctWWNNACVBridgeFlag\"\
  \ = 'random' THEN ('random' || \"AcctWWNNACVBridgeFlag\")\n        WHEN opty.\"\
  OptyPipelineStatusValue\" = 'random'\n        AND BA.\"AcctWWNNACVBridgeFlag\" =\
  \ 'random'\n        AND BA.\"AcctWWAtRenewalFlag_CC\" = 'random' THEN ('random'\
  \ || \"AcctWWAtRenewalFlag_CC\")\n        WHEN opty.\"OptyPipelineStatusValue\"\
  \ = 'random' THEN ('random' || 'random')\n        WHEN opty.\"OptyPipelineStatusValue\"\
  \ <> 'random'\n        AND BA.\"AcctWWNNACVBridgeFlag\" = 'random' THEN (\n    \
  \        'random' || BA.\"AcctWWNNACVBridgeFlag\" || 'random'\n        )\n     \
  \   WHEN opty.\"OptyPipelineStatusValue\" <> 'random'\n        AND BA.\"AcctWWNNACVBridgeFlag\"\
  \ = 'random'\n        AND RENEWAL_STATUS_LEGACY = 'random' THEN (\n            'random'\
  \ || BA.\"AcctWWNNACVBridgeFlag\" || 'random'\n        )\n        WHEN opty.\"OptyPipelineStatusValue\"\
  \ <> 'random'\n        AND BA.\"AcctWWNNACVBridgeFlag\" = 'random'\n        AND\
  \ BA.\"AcctWWAtRenewalFlag_CC\" = 'random' THEN ('random' || \"AcctWWAtRenewalFlag_CC\"\
  )\n        WHEN opty.\"OptyPipelineStatusValue\" <> 'random' THEN ('random' || 'random')\n\
  \    END AS ACCT_RENEWAL_WATERFALL_STATUS,\n    CASE\n        WHEN opty.\"OptyPipelineStatusValue\"\
  \ = 'random'\n        AND RENEWAL_STATUS_LEGACY = 'random' THEN RENEWAL_STATUS_LEGACY\n\
  \        WHEN opty.\"OptyPipelineStatusValue\" = 'random'\n        AND BU.\"SurvivorOppBridgeFlag_CC\"\
  \ = 'random' THEN ('random' || 'random')\n        WHEN opty.\"OptyPipelineStatusValue\"\
  \ = 'random'\n        AND BU.\"SurvivorOppBridgeFlag_CC\" = 'random' THEN ('random'\
  \ || 'random')\n        WHEN opty.\"OptyPipelineStatusValue\" = 'random' THEN ('random'\
  \ || 'random')\n        WHEN opty.\"OptyPipelineStatusValue\" <> 'random'\n    \
  \    AND BU.\"SurvivorOppBridgeFlag_CC\" = 'random' THEN ('random' || 'random' ||\
  \ 'random')\n        WHEN opty.\"OptyPipelineStatusValue\" <> 'random'\n       \
  \ AND BU.\"SurvivorOppBridgeFlag_CC\" = 'random'\n        AND RENEWAL_STATUS_LEGACY\
  \ = 'random' THEN ('random' || 'random' || 'random')\n        WHEN opty.\"OptyPipelineStatusValue\"\
  \ <> 'random'\n        AND BU.\"SurvivorOppBridgeFlag_CC\" = 'random' THEN ('random'\
  \ || 'random')\n        WHEN opty.\"OptyPipelineStatusValue\" <> 'random' THEN ('random'\
  \ || 'random')\n    END AS RENEWAL_WATERFALL_STATUS,\n    ------ End code by Santhosh(Accenture)\
  \ on 08-May-2024 ------------------------------\n    --------- Start of code by\
  \ Matt(Accenture) on 14-May-2024 ------------------------------\n    ACE.\"ACESubcategory\"\
  \ AS ACE_SUBCATEGORY,\n    ACE.\"ACETransactionType\" AS ACE_TRANSACTION_TYPE,\n\
  \    ------ End code by Matt(Accenture) on 14-May-2024 ------------------------------\n\
  \    ------ Start of code by Matt(Accenture) on 15-May-2024 ------------------------------\n\
  \    ACE.\"GoToMarketSegmentVCU\" AS ACE_MARKET_SEGMENT_VCU,\n    ISO.\"SOType\"\
  \ AS SO_TYPE,\n    ------ End code by Matt(Accenture) on 15-May-2024 ------------------------------\n\
  \    ------ Start of code by Matt(Accenture) on 16-May-2024 ------------------------------\n\
  \    ACE.\"SourcingPartnerUltimateParentAccount\" AS SOURCING_PARTNER_PARENT_ACCOUNT_NAME,\n\
  \    ------ End code by Matt(Accenture) on 16-May-2024 ------------------------------\n\
  \    ------ Start of code by Matt(Accenture) on 24-May-2024 ------------------------------\n\
  \    CASE\n        WHEN (\n            (\n                LR.\"SalesQuarter\" >\
  \ RIGHT(\n                    YEAR(\n                        CONVERT_TIMEZONE(\n\
  \                            'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n                AND (LR.\"ContractEndDateQuarter\") = RIGHT(\n   \
  \                 YEAR(\n                        CONVERT_TIMEZONE(\n           \
  \                 'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n            )\n            OR (\n                LR.\"SalesQuarter\"\
  \ > RIGHT(\n                    YEAR(\n                        CONVERT_TIMEZONE('random',\
  \ CURRENT_TIMESTAMP)\n                    ) || 'random' || QUARTER(\n          \
  \              CONVERT_TIMEZONE('random', CURRENT_TIMESTAMP)\n                 \
  \   ),\n                    'random'\n                )\n                AND LR.\"\
  ContractEndDateQuarter\" = RIGHT(\n                    YEAR(\n                 \
  \       CONVERT_TIMEZONE('random', CURRENT_TIMESTAMP)\n                    ) ||\
  \ 'random' || QUARTER(\n                        CONVERT_TIMEZONE('random', CURRENT_TIMESTAMP)\n\
  \                    ),\n                    'random'\n                )\n     \
  \       )\n            OR (\n                LR.\"SalesQuarter\" > RIGHT(\n    \
  \                YEAR(\n                        CONVERT_TIMEZONE(\n            \
  \                'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n                AND LR.\"ContractEndDateQuarter\" = RIGHT(\n     \
  \               YEAR(\n                        CONVERT_TIMEZONE(\n             \
  \               'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n            )\n            OR (\n                LR.\"SalesQuarter\"\
  \ > RIGHT(\n                    YEAR(\n                        CONVERT_TIMEZONE(\n\
  \                            'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n                AND LR.\"ContractEndDateQuarter\" = RIGHT(\n     \
  \               YEAR(\n                        CONVERT_TIMEZONE(\n             \
  \               'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n            )\n            OR (\n                LR.\"SalesQuarter\"\
  \ > right(\n                    YEAR(\n                        CONVERT_TIMEZONE(\n\
  \                            'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n                AND LR.\"ContractEndDateQuarter\" = RIGHT(\n     \
  \               YEAR(\n                        CONVERT_TIMEZONE(\n             \
  \               'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n            )\n            OR (\n                LR.\"SalesQuarter\"\
  \ > RIGHT(\n                    YEAR(\n                        CONVERT_TIMEZONE(\n\
  \                            'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        convert_timezone(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n                AND LR.\"ContractEndDateQuarter\" = RIGHT(\n     \
  \               YEAR(\n                        CONVERT_TIMEZONE(\n             \
  \               'random',\n                            ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                        )\n                    ) || 'random' || QUARTER(\n\
  \                        CONVERT_TIMEZONE(\n                            'random',\n\
  \                            ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n         \
  \               )\n                    ),\n                    'random'\n      \
  \          )\n            )\n        ) THEN 'random'\n    END AS CQ_PUSHED_RENEWAL_FLAG,\n\
  \    CASE\n        WHEN (\n            LR.\"SalesQuarter\" > RIGHT(\n          \
  \      YEAR(\n                    CONVERT_TIMEZONE(\n                        'random',\n\
  \                        ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n             \
  \       )\n                ) || 'random' || QUARTER(\n                    CONVERT_TIMEZONE(\n\
  \                        'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n            AND (LR.\"ContractEndDateQuarter\") < RIGHT(\n     \
  \           YEAR(\n                    CONVERT_TIMEZONE(\n                     \
  \   'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n\
  \                    )\n                ) || 'random' || QUARTER(\n            \
  \        CONVERT_TIMEZONE(\n                        'random',\n                \
  \        ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                    )\n      \
  \          ),\n                'random'\n            )\n        )\n        OR (\n\
  \            LR.\"SalesQuarter\" > RIGHT(\n                YEAR(\n             \
  \       CONVERT_TIMEZONE('random', CURRENT_TIMESTAMP)\n                ) || 'random'\
  \ || QUARTER(\n                    CONVERT_TIMEZONE('random', CURRENT_TIMESTAMP)\n\
  \                ),\n                'random'\n            )\n            AND LR.\"\
  ContractEndDateQuarter\" < RIGHT(\n                YEAR(\n                    CONVERT_TIMEZONE('random',\
  \ CURRENT_TIMESTAMP)\n                ) || 'random' || QUARTER(\n              \
  \      CONVERT_TIMEZONE('random', CURRENT_TIMESTAMP)\n                ),\n     \
  \           'random'\n            )\n        )\n        OR (\n            LR.\"\
  SalesQuarter\" > RIGHT(\n                YEAR(\n                    CONVERT_TIMEZONE(\n\
  \                        'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                    )\n                ) || 'random' || QUARTER(\n\
  \                    CONVERT_TIMEZONE(\n                        'random',\n    \
  \                    ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                 \
  \   )\n                ),\n                'random'\n            )\n           \
  \ AND LR.\"ContractEndDateQuarter\" < RIGHT(\n                YEAR(\n          \
  \          CONVERT_TIMEZONE(\n                        'random',\n              \
  \          ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                    )\n    \
  \            ) || 'random' || QUARTER(\n                    CONVERT_TIMEZONE(\n\
  \                        'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n        )\n        OR (\n            LR.\"SalesQuarter\" > RIGHT(\n\
  \                YEAR(\n                    CONVERT_TIMEZONE(\n                \
  \        'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n\
  \                    )\n                ) || 'random' || QUARTER(\n            \
  \        CONVERT_TIMEZONE(\n                        'random',\n                \
  \        ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                    )\n      \
  \          ),\n                'random'\n            )\n            AND LR.\"ContractEndDateQuarter\"\
  \ < RIGHT(\n                YEAR(\n                    convert_timezone(\n     \
  \                   'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                    )\n                ) || 'random' || QUARTER(\n\
  \                    CONVERT_TIMEZONE(\n                        'random',\n    \
  \                    ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                 \
  \   )\n                ),\n                'random'\n            )\n        )\n\
  \        OR (\n            LR.\"SalesQuarter\" > RIGHT(\n                YEAR(\n\
  \                    CONVERT_TIMEZONE(\n                        'random',\n    \
  \                    ADD_MONTHS(current_timestamp, 'random')\n                 \
  \   )\n                ) || 'random' || QUARTER(\n                    CONVERT_TIMEZONE(\n\
  \                        'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n            AND LR.\"ContractEndDateQuarter\" < RIGHT(\n       \
  \         YEAR(\n                    CONVERT_TIMEZONE(\n                       \
  \ 'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n \
  \                   )\n                ) || 'random' || QUARTER(\n             \
  \       CONVERT_TIMEZONE(\n                        'random',\n                 \
  \       ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                    )\n       \
  \         ),\n                'random'\n            )\n        )\n        OR (\n\
  \            LR.\"SalesQuarter\" > RIGHT(\n                YEAR(\n             \
  \       CONVERT_TIMEZONE(\n                        'random',\n                 \
  \       ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                    )\n       \
  \         ) || 'random' || QUARTER(\n                    convert_timezone(\n   \
  \                     'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP,\
  \ 'random')\n                    )\n                ),\n                'random'\n\
  \            )\n            AND LR.\"ContractEndDateQuarter\" < RIGHT(\n       \
  \         YEAR(\n                    CONVERT_TIMEZONE(\n                       \
  \ 'random',\n                        ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n \
  \                   )\n                ) || 'random' || QUARTER(\n             \
  \       CONVERT_TIMEZONE(\n                        'random',\n                 \
  \       ADD_MONTHS(CURRENT_TIMESTAMP, 'random')\n                    )\n       \
  \         ),\n                'random'\n            )\n        ) THEN 'random'\n\
  \    END AS PQ_PUSHED_RENEWAL_FLAG,\n    ------ END of code by Matt(Accenture) on\
  \ 24-May-2024 ------------------------------\n    (\n        case\n            when\
  \ \"PYTD\" <> 'random' then 'random'\n            else 'random'\n        end\n \
  \   ) as IS_NEW_LOGO_PYTD,\n        ------ Start of code by Matt(Accenture) on 30-May-2024\
  \ ------------------------------\n    FSP.\"ParentFSPNewLogoFlag\" as PARENT_ACCOUNT_FSP_NEW_LOGO_FLAG,\n\
  \        ------ End of code by Matt(Accenture) on 30-May-2024 ------------------------------\n\
  \    opty.IS_MEGA_SKU\nFROM\n    OPTY opty\n    LEFT JOIN ODS_LS.SURF.SALES_OPPORTUNITY\
  \ so ON opty.\"OptyNumber\" = so.\"OptyNumber\"\n    LEFT JOIN ODS_LS.\"SURF\".\"\
  EMPLOYEE\" opty_sales_mgr ON so.\"OptyMSPSalesSysID\" = opty_sales_mgr.\"EmpSysID\"\
  \n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_esr_mgr ON so.\"OptyInsideSalesRepSysID\"\
  \ = emp_esr_mgr.\"EmpSysID\"\n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_engm_mgr\
  \ ON so.\"OptyPSEngagementManagerSysID\" = emp_engm_mgr.\"EmpSysID\"\n    LEFT JOIN\
  \ ODS_LS.\"SURF\".\"EMPLOYEE\" overlay_emp ON so.\"OptyDoubleCompensationOverlaySysID\"\
  \ = overlay_emp.\"EmpSysID\"\n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_opty_owner\
  \ ON so.\"OptyOwnerSysID\" = emp_opty_owner.\"EmpSysID\"\n    LEFT JOIN ODS_LS.\"\
  SURF\".\"SALES_TERRITORY_ALL\" terr ON opty.\"OptyTerritorySysID\" = terr.\"TerrSysID\"\
  \n    LEFT JOIN ODS_LS.\"SURF\".\"SALES_TERRITORY_ALL\" msp_terr ON opty.\"OptyMSPTerritorySysID\"\
  \ = msp_terr.\"TerrSysID\"\n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" Overlayadr\
  \ ON so.\"OptyOverlayIsr\" = Overlayadr.\"EmpSysID\"\n    LEFT JOIN OPTY parent_opty\
  \ ON parent_opty.\"OptySysID\" = opty.\"OptyParentSysID\" --SS 1.5/Avantika Keshav/Updated\
  \ on: 02-02-2024/Release on: 02-02-204/ Release Type: Normal\n    LEFT JOIN ODS_LS.\"\
  DYNAMICS365\".\"OPPORTUNITIES\" opty_dynamics ON so.\"OptyNumber\" = opty_dynamics.\"\
  OpportunityNumber\"\n    LEFT JOIN ODS_LS.\"DYNAMICS365\".\"OPPORTUNITIES\" parent_opty_dynamics\
  \ ON parent_opty.\"OptyNumber\" = parent_opty_dynamics.\"OpportunityNumber\" --SS\
  \ 1.5/Jay Modi/Updated on: 19-06-2024/Release on: 19-07-2024/ Release Type: RTB\n\
  \    LEFT JOIN ODS_LS.SURF.SALES_OPPORTUNITY sop ON sop.\"OptySysID\" = opty.\"\
  OptyParentSysID\"\n    LEFT JOIN ODS_LS.SURF.SALES_CONTRACT con ON con.\"ContractSysID\"\
  \ = so.\"OptyContractSysID\" --SS 1.5/Jay Modi/Updated on: 10-05-2024/Release on:\
  \ 15-05-2024/ Release Type: Normal\n    LEFT JOIN ODS_LS.SURF.SALES_CONTRACT parent_con\
  \ ON parent_con.\"ContractSysID\" = sop.\"OptyContractSysID\" --SS 1.5/Jaya Prakash/Updated\
  \ on: 24-04-2024/Release on: 15-05-2024/ Release Type: Normal\n    LEFT JOIN EDW_LS.\"\
  SALES_EM\".\"EM_OPTY_NOTES_NEXTSTEP\" NXT_STEPS_PAR ON sop.\"OptySysID\" = NXT_STEPS_PAR.\"\
  JournalElementID\"\n    LEFT JOIN ODS_LS.SURF.SALES_ACCOUNT sap ON IFNULL(sop.\"\
  OptyAccountSysID\", 'random') = IFNULL(sap.\"AcctSysID\", 'random')\n    LEFT JOIN(\n\
  \        SELECT\n            emp_opty_sol_mgr.\"EmpManagerName\" AS \"OpportunitySolutionConsultantManager\"\
  ,\n            emp_opty_sol_mgr.\"EmpSysID\" AS \"EmpSysID\",\n            emp_opty_sol_mgr2.\"\
  EmpManagerName\" AS \"OpportunitySolutionConsultantManagerManager\"\n        FROM\n\
  \            (\n                SELECT\n                    \"EmpSysID\" AS \"EmpSysID\"\
  ,\n                    \"EmpManagerName\" AS \"EmpManagerName\",\n             \
  \       \"EmpManagerSysID\" AS \"EmpManagerSysID\"\n                FROM\n     \
  \               ODS_LS.\"SURF\".\"EMPLOYEE\"\n            ) emp_opty_sol_mgr\n \
  \           LEFT JOIN (\n                SELECT\n                    \"EmpSysID\"\
  \ AS \"EmpSysID\",\n                    \"EmpManagerName\" AS \"EmpManagerName\"\
  \n                FROM\n                    ODS_LS.\"SURF\".\"EMPLOYEE\"\n     \
  \       ) emp_opty_sol_mgr2 ON emp_opty_sol_mgr.\"EmpManagerSysID\" = emp_opty_sol_mgr2.\"\
  EmpSysID\"\n    ) emp_solut_mgr ON so.\"OptySolutionConsultant\" = emp_solut_mgr.\"\
  EmpSysID\"\n    LEFT JOIN (\n        SELECT\n            DISTINCT QUARTER_ID,\n\
  \            QUARTER_DT,\n            QUARTER_YYQQ\n        FROM\n            EDW.ENTERPRISE.DIM_QUARTER\n\
  \    ) qtr ON opty.\"OptySalesQuarter\" = qtr.QUARTER_YYQQ\n    LEFT JOIN EDW_LS.\"\
  SALES_EM\".\"EM_OPTY_NOTES_NEXTSTEP\" NXT_STEPS ON so.\"OptySysID\" = NXT_STEPS.\"\
  JournalElementID\"\n    LEFT JOIN (\n                select\n                  \
  \  distinct \"OpportunityNumber\",\n                    \"CHQNewLogoFlag\"\n   \
  \             from\n                    EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n\
  \                where\n                    \"RecordType\" in ('random')\n     \
  \               and\n                    (\n                        (\"CHQNewLogoFlag\"\
  \ in ('random')\n                        and\n                        \"HQBusinessSegment\"\
  \ in ('random',\n                                                'random',\n   \
  \                                             'random',\n                      \
  \                          'random'\n                                          \
  \      )\n                        )\n                        OR\n              \
  \          (\"CHQNewLogoFlag\" in ('random')\n                        and\n    \
  \                    \"AccountHQSegment\" in ('random',\n                      \
  \                          'random',\n                                         \
  \       'random',\n                                                'random'\n  \
  \                                              )\n                        )\n  \
  \                  )\n            ) GP on OPTY.\"OptyNumber\" = GP.\"OpportunityNumber\"\
  \  --SS 1.5 Changes /Avantika Keshav/Updated on: 09-07-2024/ Updated the filter\
  \ condition for IS_GP_POTENTIAL_NEW_LOGO to match with the New logo dashboard\n\
  \    LEFT JOIN (\n        SELECT\n            DISTINCT \"OpportunityNumber\",\n\
  \            \"FSPNewLogoFlag\"\n        FROM\n            EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n\
  \        WHERE\n            \"RecordType\" = 'random'\n            AND \"FSPNewLogoFlag\"\
  \ IN ('random', 'random')\n    ) DP ON OPTY.\"OptyNumber\" = DP.\"OpportunityNumber\"\
  \n    LEFT JOIN (\n        SELECT\n            DISTINCT \"OpportunityNumber\",\n\
  \            \"AnaplanAccountFlag\"\n        FROM\n            EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n\
  \        WHERE\n            \"RecordType\" IN ('random')\n            AND \"AnaplanAccountFlag\"\
  \ = 'random'\n    ) VERIFIED_NL ON OPTY.\"OptyNumber\" = VERIFIED_NL.\"OpportunityNumber\"\
  \n    /*\tBegin New joins by Accenture Team Dec-2023 */\n    left outer join (\n\
  \        select\n            DISTINCT \"SN_OPPORTUNITYID\",\n            LEFT(\"\
  SN_OBJECTIVES\", 'random') AS \"SN_OBJECTIVES\",\n            LEFT(\"SN_CHALLENGES\"\
  , 'random') \"SN_CHALLENGES\",\n            LEFT(\"SN_OUTCOMES\", 'random') AS \"\
  SN_OUTCOMES\"\n        from\n            RDS.\"DYNAMICS365\".\"SN_OPPORTUNITYSUMMARIES\"\
  \n        WHERE\n            STATUSCODE = 'random'\n            AND SN_MASTER =\
  \ 'random'\n    ) SNOS ON sop.\"OptyDynamicsGUID\" = SNOS.\"SN_OPPORTUNITYID\" ----LEFT\
  \ OUTER JOIN\n    /* commented by by Prabhat while doing the code merge.\n     \
  \   \tCDL_LS.DATASCIENCE_RPT.RPT_PIPELINE_PREDICTION_CURRENT\n        \tppc ON OPTY.\"\
  OptyNumber\" = ppc.\"OpportunityNumber\"\n        \t*/\n    LEFT JOIN (\n      \
  \  SELECT\n            \"OptyNumber\" as \"OptyNumber\",\n            \"ProbabilityToCloseInQtr\"\
  \ as \"ProbabilityToCloseInQtr\",\n            \"PredictedToCloseInQtr\",\n    \
  \        \"ReasonCode1\",\n            \"ReasonCode2\",\n            \"ReasonCode3\"\
  ,\n            \"ReasonCode4\",\n            \"ReasonCode5\",\n            \"ReasonCode6\"\
  ,\n        FROM\n            EDW_LS.\"DATASCIENCE\".\"V_PIPELINE_PREDICTION_CURRENT\"\
  \n    ) ds ON OPTY.\"OptyNumber\" = ds.\"OptyNumber\"\n    LEFT JOIN (\n       \
  \ SELECT\n            \"JournalElementID\" as \"JournalElementID\",\n          \
  \  \"RecordType\" as \"RecordType\",\n            \"JournalCreatedOn\" as \"JournalCreatedOn\"\
  ,\n            ROW_NUMBER() OVER(\n                PARTITION BY \"JournalElementID\"\
  ,\n                \"RecordType\"\n                ORDER BY\n                  \
  \  \"JournalCreatedOn\" DESC\n            ) \"Rank_Column\"\n        FROM\n    \
  \        (\n                SELECT\n                    \"JournalElement\" as \"\
  JournalElement\",\n                    \"JournalElementID\" as \"JournalElementID\"\
  ,\n                    \"JournalCreatedOn\" as \"JournalCreatedOn\",\n         \
  \           'random' as \"RecordType\"\n                FROM\n                 \
  \   ODS_LS.\"SURF\".\"SYS_JOURNAL_FIELD\"\n                WHERE\n             \
  \       (\"JournalElement\" = 'random')\n            ) Rank_column QUALIFY \"Rank_Column\"\
  \ <= 'random'\n    ) Rank1 ON so.\"OptySysID\" = Rank1.\"JournalElementID\"\n  \
  \  LEFT OUTER JOIN (\n        SELECT\n            LISTAGG(distinct \"PartnerUltimateParentAccount\"\
  , 'random') WITHIN GROUP (\n                ORDER BY\n                    \"PartnerUltimateParentAccount\"\
  \n            ) AS \"PartnerUltimateParentAccount\",\n            \"OptySysID\"\
  ,\n            IFF(\n                LISTAGG(distinct \"PartnerAccount\", 'random')\
  \ = 'random',\n                'random',\n                LISTAGG(distinct \"PartnerAccount\"\
  , 'random')\n            ) AS \"ParentPartnerAccount\",\n            IFF(\n    \
  \            LISTAGG(distinct \"PartnerAccountSysID\", 'random') = 'random',\n \
  \               'random',\n                LISTAGG(distinct \"PartnerAccountSysID\"\
  , 'random')\n            ) AS \"PartnerAccountSysID\"\n        FROM\n          \
  \  (\n                SELECT\n                    DISTINCT \"PartnerUltimateParentAccount\"\
  ,\n                    \"OptySysID\",\n                    \"PartnerAccount\",\n\
  \                    \"PartnerAccountSysID\"\n                FROM\n           \
  \         EDW_LS.\"PARTNER_EM\".\"EM_OPPORTUNITY_PARTNER360_DEAL\"\n           \
  \ )\n        GROUP BY\n            \"OptySysID\"\n    ) opd ON opty.\"OptyParentSysID\"\
  \ = opd.\"OptySysID\"\n    LEFT OUTER JOIN SYS_JOURNAL_FIELD GN ON GN.\"JournalElementID\"\
  \ = so.\"OptySysID\"\n    /*below code added by Prabhat on 03/26 for deriving PARTNER_ACCOUNT_NAME,\
  \ OPTY_TECHNICAL_WIN_STATUS*/\n    LEFT OUTER JOIN (\n        SELECT\n         \
  \   \"OptySysID\",\n            \"OptyExtnTransactingPartner\",\n            \"\
  OptyExtnChannelTransactionType\",\n            LISTAGG(distinct \"PartnerAccount\"\
  , 'random') AS \"ChildPartnerAccount\"\n        FROM\n            EDW_LS.\"PARTNER_EM\"\
  .\"EM_OPPORTUNITY_PARTNER360_DEAL\"\n        GROUP BY\n            \"OptySysID\"\
  ,\n            \"OptyExtnTransactingPartner\",\n            \"OptyExtnChannelTransactionType\"\
  \n    ) ext ON ext.\"OptySysID\" = opty.\"OptySysID\"\n    /*below code added by\
  \ prabhat Accenture 04-01*/\n    LEFT OUTER JOIN (\n        SELECT\n           \
  \ DISTINCT \"OptyNumber\",\n            \"RenewalStatusFlag_CC\",\n            \"\
  OptyStage\",\n            \"OptyType\",\n            \"OptyRenewalStatus\",\n  \
  \          \"AccountConsolidationFlag_CC\",\n            \"OptySalesQuarter\",\n\
  \            \"OptyContEndDate\"\n        FROM\n            EDW_LS.SALES_EM.EM_SALES_OPPORTUNITY_EXTENDED_RT\n\
  \    ) oert ON oert.\"OptyNumber\" = so.\"OptyNumber\"\n    /*Added by Prabhat on\
  \ 01/04/2024 end (Accenture) */\n    -----------Added by Santhosh(Accenture) on\
  \ 08-May-2024 for Waterfall change------------------------------\n    LEFT OUTER\
  \ JOIN (\n        SELECT\n            DISTINCT \"OptyNumber\",\n            \"AcctWWNNACVBridgeFlag\"\
  ,\n            \"AcctWWAtRenewalFlag_CC\"\n        FROM\n            CDL_LS.\"FINANCE_FPA_RPT\"\
  .\"BOOKINGS_ADHOC\"\n        WHERE\n            \"AcctWWNNACVBridgeFlag\" IS not\
  \ NULL\n            AND \"AcctWWAtRenewalFlag_CC\" IS not NULL\n            AND\
  \ \"OptySalesQuarter\" >= RIGHT(\n                YEAR(\n                    ADD_MONTHS(\n\
  \                        convert_timezone('random', current_timestamp),\n      \
  \                  'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ current_timestamp),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            )\n            AND \"\
  OptySalesQuarter\" <= RIGHT(\n                YEAR(\n                    ADD_MONTHS(\n\
  \                        convert_timezone('random', current_timestamp),\n      \
  \                  'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ current_timestamp),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            )\n    ) BA ON BA.\"\
  OptyNumber\" = opty.\"OptyNumber\"\n    LEFT OUTER JOIN (\n        SELECT\n    \
  \        DISTINCT \"OptyNumber\",\n            \"SurvivorOppBridgeFlag_CC\"\n  \
  \      FROM\n            CDL_LS.\"FINANCE_FPA_RPT\".\"BOOKINGS_UNIVERSE\"\n    \
  \    WHERE\n            \"SurvivorOppBridgeFlag_CC\" IS not NULL\n            AND\
  \ \"OptySalesQuarter\" >= RIGHT(\n                YEAR(\n                    ADD_MONTHS(\n\
  \                        convert_timezone('random', current_timestamp),\n      \
  \                  'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ current_timestamp),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            )\n            AND \"\
  OptySalesQuarter\" <= RIGHT(\n                YEAR(\n                    ADD_MONTHS(\n\
  \                        convert_timezone('random', current_timestamp),\n      \
  \                  'random'\n                    )\n                ) || 'random'\
  \ || QUARTER(\n                    ADD_MONTHS(\n                        convert_timezone('random',\
  \ current_timestamp),\n                        'random'\n                    )\n\
  \                ),\n                'random'\n            )\n    ) BU ON BU.\"\
  OptyNumber\" = opty.\"OptyNumber\" -----------------------End ---------------------------------------------------------\n\
  \    LEFT OUTER JOIN ODS_LS.\"PARTNER\".\"TBL_ACEPIPELINEINSIGHTS\" ACE ON so.\"\
  OptyNumber\" = ACE.\"OptyNumber\"\n    AND ACE.\"OpportunityPipelineSourced\" =\
  \ 'random'\n    LEFT OUTER JOIN (\n        select\n            \"OptyNumber\",\n\
  \            case\n                when count(distinct \"IdeaTypePP\") > 'random'\
  \ then 'random'\n                else max(\"IdeaTypePP\")\n            end as \"\
  SOType\"\n        from\n            EDW_LS.PARTNER_EM.INDUSTRYSOLUTIONSANDOFFERINGS\n\
  \        WHERE\n            \"RecordType\" = 'random'\n            and \"Quarter\"\
  \ >= RIGHT(\n                YEAR(\n                    convert_timezone('random',\
  \ CURRENT_TIMESTAMP())\n                ) || 'random' || QUARTER(\n            \
  \        convert_timezone('random', CURRENT_TIMESTAMP())\n                ),\n \
  \               'random'\n            )\n            and \"Quarter\" <= RIGHT(\n\
  \                YEAR(\n                    ADD_MONTHS(\n                      \
  \  convert_timezone('random', CURRENT_TIMESTAMP()),\n                        'random'\n\
  \                    )\n                ) || 'random' || QUARTER(\n            \
  \        ADD_MONTHS(\n                        convert_timezone('random', CURRENT_TIMESTAMP()),\n\
  \                        'random'\n                    )\n                ),\n \
  \               'random'\n            )\n        group by\n            \"OptyNumber\"\
  \n    ) ISO ON so.\"OptyNumber\" = ISO.\"OptyNumber\"\n    LEFT OUTER JOIN EDW_LS.SALES_EM.SALES_LATE_RENEWALS\
  \ LR ON LR.\"OpportunityNumber\" = so.\"OptyNumber\"\n    left join NEW_LOGO_PYTD\
  \ py on py.\"OpportunityNumber\" = so.\"OptyNumber\" ---added by Yash as part of\
  \ PYTD\n    LEFT OUTER JOIN (\n        select\n            distinct \"AccountNumber\"\
  \ as \"AcctNumber\",\n            \"FSPNewLogoFlag\" as \"ParentFSPNewLogoFlag\"\
  ,\n            \"Quarter\" as \"FSPQuarter\"\n        from\n            FSP_NEW_LOGO\n\
  \    ) FSP on PARENT_OPTY_ACCOUNT_NUMBER = FSP.\"AcctNumber\"\n    and QUARTER_YYQQ\
  \ = FSP.\"FSPQuarter\"\n    LEFT JOIN ODS_LS.SURF.U_OPPORTUNITY_EXTENSION opty_extension\n\
  \    ON so.\"OptySysID\" = opty_extension.\"OptySysID\"   --SS 1.5/Jay Modi/Updated\
  \ on: 19-06-2024/Release on: 19-07-2024/ Release Type: RTB\n    LEFT JOIN (SELECT\
  \ CALENDAR_DT, WEEK_NUMBER_OF_QUARTER from CDL.ENTERPRISE.V_DIM_DATE) close_date_dim\
  \ on OPTY_CLOSE_DT = close_date_dim.CALENDAR_DT  --SS 1.5/Jay Modi/Updated on: 03-07-2024/Release\
  \ on: 19-07-2024/ Release Type: RTB\n    LEFT JOIN (SELECT CALENDAR_DT, WEEK_NUMBER_OF_QUARTER\
  \ from CDL.ENTERPRISE.V_DIM_DATE) create_date_dim on OPTY_CREATED_DT = create_date_dim.CALENDAR_DT\
  \  --SS 1.5/Jay Modi/Updated on: 03-07-2024/Release on: 19-07-2024/ Release Type:\
  \ RTB\n    LEFT JOIN (SELECT distinct \"Label\",\"LabelTableKey\" FROM ODS_LS.SURF.LABEL_ENTRY\n\
  \              WHERE \"LabelTableName\" = 'random' AND \"Label\" in ('random','random'))\
  \ LBL on opty.\"OptySysID\" = LBL.\"LabelTableKey\";"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
