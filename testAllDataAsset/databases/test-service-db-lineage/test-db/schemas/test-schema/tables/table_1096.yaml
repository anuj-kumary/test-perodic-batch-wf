name: table_1096
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1096
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1096.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view VICTIM_ACCT_BU_ROLLING_CACV_DC_PQ(\n\t\"\
  AcctBURollingCACVDCPQ\",\n\t\"OptySalesQuarter\",\n\t\"SurvivorOptyAcctNumberXYZ\"\
  ,\n\t\"ProductBusinessUnitValue\"\n) as -- SEMANTIC LAYER BEGINS\n\nSELECT \"AcctBURollingCACVDCPQ\"\
  \ as \"AcctBURollingCACVDCPQ\",\n       \"OptySalesQuarter\" as \"OptySalesQuarter\"\
  ,\n       \"SurvivorOptyAcctNumberXYZ\" as \"SurvivorOptyAcctNumberXYZ\",\n    \
  \   \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\nFROM\n  (SELECT\
  \ SUM(\"AcctBURollingCACVDCPQ\") as \"AcctBURollingCACVDCPQ\",\n          \"OptySalesQuarter\"\
  \ as \"OptySalesQuarter\",\n          \"SurvivorOptyAcctNumberXYZ\" as \"SurvivorOptyAcctNumberXYZ\"\
  ,\n          \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\n   FROM\n\
  \     (SELECT \"Aggregation_2\".\"OptyAccountSysID\" as \"OptyAccountSysID\",\n\
  \             \"Aggregation_2\".\"OptySalesQuarter\" as \"OptySalesQuarter\",\n\
  \             \"Aggregation_2\".\"AcctBURollingCACVDCPQ\" as \"AcctBURollingCACVDCPQ\"\
  ,\n             \"Aggregation_3\".\"OptySalesQuarterXYZ\" as \"OptySalesQuarterXYZ\"\
  ,\n             \"Aggregation_3\".\"SurvivorOptyAcctNumberXYZ\" as \"SurvivorOptyAcctNumberXYZ\"\
  ,\n             \"Aggregation_2\".\"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\
  \n      FROM\n        (SELECT MAX(\"FinNNACVDC_CC\") as \"FinNNACVDC_CC1\",\n  \
  \              \"OptyAccountSysID\" as \"OptyAccountSysID\",\n                \"\
  OptySalesQuarter\" as \"OptySalesQuarter\",\n                SUM(\"FinNNACVDC_CC_1\"\
  ) as \"AcctBURollingCACVDC\",\n                \"ProductBusinessUnitValue\" as \"\
  ProductBusinessUnitValue\",\n                \"AcctBURollingCACVDC\" - IFNULL(\"\
  FinNNACVDC_CC1\", 'random') as \"AcctBURollingCACVDCPQ\"\n         FROM\n      \
  \     (SELECT \"OptySalesQuarter\" as \"OptySalesQuarter\",\n                  \
  \ \"FinNNACVDC_CC\" as \"FinNNACVDC_CC\",\n                   \"OptySalesQuarter_1\"\
  \ as \"OptySalesQuarter_1\",\n                   \"OptyAccountSysID\" as \"OptyAccountSysID\"\
  ,\n                   \"FinNNACVDC_CC_1\" as \"FinNNACVDC_CC_1\",\n            \
  \       \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\n         \
  \   FROM\n              (SELECT \"Aggregation_1\".\"FinNNACVDC_CC\" as \"FinNNACVDC_CC\"\
  ,\n                      \"Aggregation_1\".\"OptySalesQuarter\" as \"OptySalesQuarter\"\
  ,\n                      \"MaxQuarter\".\"OptySalesQuarter\" as \"OptySalesQuarter_1\"\
  ,\n                      \"MaxQuarter\".\"OptyAccountSysID\" as \"OptyAccountSysID\"\
  ,\n                      \"MaxQuarter\".\"FinNNACVDC_CC\" as \"FinNNACVDC_CC_1\"\
  ,\n                      \"MaxQuarter\".\"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\
  \n               FROM\n                 (SELECT SUM(\"FinNNACVDC_CC\") as \"FinNNACVDC_CC\"\
  ,\n                         \"OptySalesQuarter\" as \"OptySalesQuarter\",\n    \
  \                     \"OptyAccountSysID\" as \"OptyAccountSysID\",\n          \
  \               \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\n \
  \                 FROM\n                    (SELECT \"FinNNACVDC_CC\" as \"FinNNACVDC_CC\"\
  ,\n                            \"OptySalesQuarter\" as \"OptySalesQuarter\",\n \
  \                           \"OptyAccountSysID\" as \"OptyAccountSysID\",\n    \
  \                        \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\
  \n                     FROM \"CDL_LS\".\"PRODUCT_RPT\".\"SURVIVOR_OPP_ACCOUNT\"\
  )\"Projection_9\"\n                  GROUP BY \"OptySalesQuarter\",\n          \
  \                 \"OptyAccountSysID\",\n                           \"ProductBusinessUnitValue\"\
  )\"Aggregation_1\"\n               INNER JOIN\n                 (SELECT \"OptySalesQuarter\"\
  \ as \"OptySalesQuarter\",\n                         \"OptyAccountSysID\" as \"\
  OptyAccountSysID\",\n                         SUM(\"FinNNACVDC_CC\") as \"FinNNACVDC_CC\"\
  ,\n                         \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\
  \n                  FROM\n                    (SELECT \"OptySalesQuarter\" as \"\
  OptySalesQuarter\",\n                            \"OptyAccountSysID\" as \"OptyAccountSysID\"\
  ,\n                            \"FinNNACVDC_CC\" as \"FinNNACVDC_CC\",\n       \
  \                     \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\
  \n                     FROM \"CDL_LS\".\"PRODUCT_RPT\".\"SURVIVOR_OPP_ACCOUNT\"\
  )\"Projection_2\"\n                  GROUP BY \"OptySalesQuarter\",\n          \
  \                 \"OptyAccountSysID\",\n                           \"ProductBusinessUnitValue\"\
  )\"MaxQuarter\" ON \"Aggregation_1\".\"OptyAccountSysID\" = \"MaxQuarter\".\"OptyAccountSysID\"\
  \n               AND \"Aggregation_1\".\"ProductBusinessUnitValue\" = \"MaxQuarter\"\
  .\"ProductBusinessUnitValue\")\"Join_1\"\n            WHERE \"OptySalesQuarter_1\"\
  \ <= \"OptySalesQuarter\")\"Projection_1\"\n         GROUP BY \"OptyAccountSysID\"\
  ,\n                  \"OptySalesQuarter\",\n                  \"ProductBusinessUnitValue\"\
  )\"Aggregation_2\"\n      LEFT JOIN\n        (SELECT \"OptyAccountSysID\" as \"\
  OptyAccountSysID\",\n                \"OptySalesQuarter\" as \"OptySalesQuarterXYZ\"\
  ,\n                \"SurvivorOptyAcctNumber\" as \"SurvivorOptyAcctNumberXYZ\",\n\
  \                \"ProductBusinessUnitValue\" as \"ProductBusinessUnitValue\"\n\
  \         FROM\n           (SELECT \"SurvivorOptyAcctNumber\" as \"SurvivorOptyAcctNumber\"\
  ,\n                   \"OptySalesQuarter\" as \"OptySalesQuarter\",\n          \
  \         \"OptyAccountSysID\" as \"OptyAccountSysID\",\n                   \"ProductBusinessUnitValue\"\
  \ as \"ProductBusinessUnitValue\"\n            FROM \"CDL_LS\".\"PRODUCT_RPT\".\"\
  SURVIVOR_OPP_ACCOUNT\")\"Projection_3\"\n         GROUP BY \"OptyAccountSysID\"\
  ,\n                  \"OptySalesQuarterXYZ\",\n                  \"SurvivorOptyAcctNumberXYZ\"\
  ,\n                  \"ProductBusinessUnitValue\")\"Aggregation_3\" ON \"Aggregation_2\"\
  .\"OptyAccountSysID\" = \"Aggregation_3\".\"OptyAccountSysID\"\n      AND \"Aggregation_2\"\
  .\"OptySalesQuarter\" = \"Aggregation_3\".\"OptySalesQuarterXYZ\"\n      AND \"\
  Aggregation_2\".\"ProductBusinessUnitValue\" = \"Aggregation_3\".\"ProductBusinessUnitValue\"\
  )\"Join_2\"\n   GROUP BY \"OptySalesQuarter\",\n            \"SurvivorOptyAcctNumberXYZ\"\
  ,\n            \"ProductBusinessUnitValue\")Aggregation_4;"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
