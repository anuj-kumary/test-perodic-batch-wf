name: TOP_5_CUSTOMERS_BY_SALES
fullyQualifiedName: snow_new_111.FIVETRAN.DBT_COLLATE.TOP_5_CUSTOMERS_BY_SALES
tableType: View
columns:
  - name: CUSTOMERID
    dataType: DECIMAL
    dataLength: 1
    precision: 38
    scale: 0
    dataTypeDisplay: "number(38,0)"
    fullyQualifiedName: snow_new_111.FIVETRAN.DBT_COLLATE.TOP_5_CUSTOMERS_BY_SALES.CUSTOMERID
    tags: []
    constraint: NOT_NULL
    children: []
    customMetrics: []
  - name: FIRSTNAME
    dataType: VARCHAR
    dataLength: 100
    dataTypeDisplay: text(100)
    fullyQualifiedName: snow_new_111.FIVETRAN.DBT_COLLATE.TOP_5_CUSTOMERS_BY_SALES.FIRSTNAME
    tags: []
    constraint: "NULL"
    children: []
    customMetrics: []
  - name: LASTNAME
    dataType: VARCHAR
    dataLength: 100
    dataTypeDisplay: text(100)
    fullyQualifiedName: snow_new_111.FIVETRAN.DBT_COLLATE.TOP_5_CUSTOMERS_BY_SALES.LASTNAME
    tags: []
    constraint: "NULL"
    children: []
    customMetrics: []
  - name: TOTAL_SALES
    dataType: DECIMAL
    dataLength: 1
    precision: 30
    scale: 2
    dataTypeDisplay: "number(30,2)"
    fullyQualifiedName: snow_new_111.FIVETRAN.DBT_COLLATE.TOP_5_CUSTOMERS_BY_SALES.TOTAL_SALES
    tags: []
    constraint: "NULL"
    children: []
    customMetrics: []
tableConstraints: []
owners: []
databaseSchema:
  id: 3a7e34bd-9a79-4fb5-926a-cd3f654c3bef
  type: databaseSchema
  name: DBT_COLLATE
  fullyQualifiedName: snow_new_111.FIVETRAN.DBT_COLLATE
  displayName: DBT_COLLATE
  deleted: false
database:
  id: 83b0c25a-1dad-46ff-b20b-d088fa50e414
  type: database
  name: FIVETRAN
  fullyQualifiedName: snow_new_111.FIVETRAN
  displayName: FIVETRAN
  deleted: false
service:
  id: 16c4356d-5e3d-4c8f-a20c-f1eb2af8f2eb
  type: databaseService
  name: snow_new_111
  fullyQualifiedName: snow_new_111
  description: ""
  displayName: snow_new_111
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace   view FIVETRAN.dbt_collate.top_5_customers_by_sales\n\
  \  \n  \n  \n  \n  as (\n    \n\n/*\n * Top 5 customers ranked by their total sales\
  \ amount across all transactions. Joins CUSTOMERACCOUNTS and TRANSACT tables for\
  \ the calculation.\n */\n\nWITH \"CustomerSales\" AS (\n  SELECT\n    \"ca\".\"\
  CUSTOMERID\",\n    \"ca\".\"FIRSTNAME\",\n    \"ca\".\"LASTNAME\",\n    SUM(\"t\"\
  .\"AMOUNT\") AS \"TOTAL_SALES\"\n  FROM FIVETRAN.MSSQLBANKING_STG.CUSTOMERACCOUNTS\
  \ AS \"ca\"\n  INNER JOIN FIVETRAN.MSSQLBANKING_STG.TRANSACT AS \"t\"\n    ON \"\
  ca\".\"ACCOUNTID\" = \"t\".\"ACCOUNTID\"\n  GROUP BY\n    \"ca\".\"CUSTOMERID\"\
  ,\n    \"ca\".\"FIRSTNAME\",\n    \"ca\".\"LASTNAME\"\n)\nSELECT\n  \"CUSTOMERID\"\
  ,\n  \"FIRSTNAME\",\n  \"LASTNAME\",\n  \"TOTAL_SALES\"\nFROM \"CustomerSales\"\n\
  ORDER BY\n  \"TOTAL_SALES\" DESC NULLS LAST\nFETCH FIRST 5 ROWS ONLY\n  )\n/* {\"\
  app\": \"dbt\", \"dbt_version\": \"2025.10.3+e006d20\", \"profile_name\": \"user\"\
  , \"target_name\": \"default\", \"node_id\": \"model.collate_dbt_snowflake.top_5_customers_by_sales\"\
  } */;"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
sourceUrl: https://app.snowflake.com/fmfahqk/gi58232/#/data/databases/FIVETRAN/schemas/DBT_COLLATE/view/TOP_5_CUSTOMERS_BY_SALES
domains: []
dataProducts: []
sourceHash: 8a888b4169fa1dfd306ec5daeb6918e9
processedLineage: false
entityStatus: Unprocessed
