name: table_1328
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1328
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1328.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view ST_SALES_CONTRACT_ITEMS_BCKP(\n\t\"STConItemQuantity\"\
  ,\n\t\"STConItemTotalValUSD\",\n\t\"STConItemContractNumber\",\n\t\"STConItemContractSysID\"\
  ,\n\t\"STConItemProdPrice\",\n\t\"STConItemSysID\",\n\t\"STConItemDVProdPrice\"\
  ,\n\t\"STConItemACV_USD\",\n\t\"STConItemExtractDate\",\n\t\"STConItemNumber\",\n\
  \t\"STConItemACV\",\n\t\"STConItemFXRate\",\n\t\"STConItemACVConCurr\",\n\t\"STConItemSalesPriceUSD\"\
  ,\n\t\"STConItemConstantFXRateEffectiveYear\",\n\t\"STConItemUSDConstantFXAdjustment\"\
  ,\n\t\"STConItemUSDConstantFXAnnualListValue\",\n\t\"STConItemUSDConstantFXSalesPrice\"\
  ,\n\t\"STConItemUSDConstantFXTotalValue\",\n\t\"STConItemAdjustment\",\n\t\"STConItemAnnualListValueUSD\"\
  ,\n\t\"STConItemUSDAdjustment\",\n\t\"STConItemSalesPrice\",\n\t\"STConItemSysCretaedOn\"\
  ,\n\t\"STConItemAccountSysId\",\n\t\"STConItemACV_DailyRate_USD\",\n\t\"STConItemFXRateMAX\"\
  \n) as\nselect\n\t   A.\"QUANTITY\" as \"STConItemQuantity\",\n       A.\"TOTAL_VALUE_USD\"\
  \ as \"STConItemTotalValUSD\",\n       A.\"DV_CONTRACT\" as \"STConItemContractNumber\"\
  ,\n       A.\"CONTRACT\" as \"STConItemContractSysID\",\n       A.\"PRODUCT_PRICE\"\
  \ as \"STConItemProdPrice\",\n       A.\"SYS_ID\" as \"STConItemSysID\",\n     \
  \  A.\"DV_PRODUCT_PRICE\" as \"STConItemDVProdPrice\",\n       A.\"ACV\"/ B.\"FXRateMax\"\
  \ as \"STConItemACV_USD\",\n       A.\"EXTRACT_DATE\" as \"STConItemExtractDate\"\
  ,\n       A.\"NUMBER\" as \"STConItemNumber\",\n       A.\"ACV\" as \"STConItemACV\"\
  ,\n       A.\"U_CONSTANT_FX_RATE\" as \"STConItemFXRate\",\n       A.\"U_ACV_USD_C_LI_CONST\"\
  \ as \"STConItemACVConCurr\",\n       A.\"SALES_PRICE_USD\" as \"STConItemSalesPriceUSD\"\
  ,\n       A.\"U_CONSTANT_FISCAL_YEAR\" as \"STConItemConstantFXRateEffectiveYear\"\
  ,\n       A.\"U_USD_ADJUSTMENT_A_C_LI_CONST\" as \"STConItemUSDConstantFXAdjustment\"\
  ,\n       A.\"U_ANNUAL_LIST_VALUE_USD_C_LI_CONST\" as \"STConItemUSDConstantFXAnnualListValue\"\
  ,\n       A.\"U_SALES_PRICE_USD_C_LI_CONST\" as \"STConItemUSDConstantFXSalesPrice\"\
  ,\n       A.\"U_TOTAL_VALUE_USD_C_LI_CONST\" as \"STConItemUSDConstantFXTotalValue\"\
  ,\n       A.\"U_ADJUSTMENT_A\" as \"STConItemAdjustment\",\n       A.\"ANNUAL_LIST_VALUE_USD\"\
  \ as \"STConItemAnnualListValueUSD\",\n       A.\"U_USD_ADJUSTMENT_A\" as \"STConItemUSDAdjustment\"\
  ,\n       A.\"SALES_PRICE\" as \"STConItemSalesPrice\",\n       A.\"SYS_CREATED_ON\"\
  \ as \"STConItemSysCretaedOn\",\n\t   A.\"U_ACCOUNT\" as \"STConItemAccountSysId\"\
  ,\n\t   A.\"ACV_USD\" as \"STConItemACV_DailyRate_USD\",\n\t   B.\"FXRateMax\" as\
  \ \"STConItemFXRateMAX\"\nfrom RDS.\"SURF\".\"ST_SALES_CONTRACT_ITEM\" A\nleft join\n\
  (select distinct rank() over (partition by \"DV_CONTRACT\", \"NUMBER\" order by\
  \ \"EXTRACT_DATE\" desc) as rnk,\"EXTRACT_DATE\" as  \"ExtractDateMax\",\ncoalesce(\"\
  U_CONSTANT_FX_RATE\",'random') as \"FXRateMax\", \"DV_CONTRACT\",\"NUMBER\"\nfrom\
  \ RDS.\"SURF\".\"ST_SALES_CONTRACT_ITEM\"\nqualify rnk='random')B\non A.\"DV_CONTRACT\"\
  =B.\"DV_CONTRACT\"\nand A.\"NUMBER\"=B.\"NUMBER\"\n--where A.\"DV_CONTRACT\"='CON0065931'--\
  \ and A.\"NUMBER\"='CLI0227084'----CLI0032120  --CLI0032120\norder by A.\"DV_CONTRACT\"\
  ,A.\"NUMBER\",A.\"EXTRACT_DATE\" desc;"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
