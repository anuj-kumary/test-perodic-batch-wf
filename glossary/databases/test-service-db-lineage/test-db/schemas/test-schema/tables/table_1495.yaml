name: table_1495
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1495
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1495.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view SRC_V_DIM_OPPORTUNITY_MR(\n\tOPTY_ID,\n\t\
  OPTY_NUMBER,\n\tOPTY_NAME,\n\tOPTY_TYPE,\n\tOPTY_STAGE,\n\tOPTY_FORECAST_CATEGORY,\n\
  \tOPTY_CLOSE_DT,\n\tOPTY_CREATED_DT,\n\tOPTY_CLOSE_MONTH,\n\tIS_ACTIVE,\n\tQUARTER_ID,\n\
  \tQUARTER_DT,\n\tQUARTER_YYQQ,\n\tOPTY_OWNER_ID,\n\tOPTY_OWNER,\n\tOPTY_TERRITORY_ID,\n\
  \tGEO_ID,\n\tOPTY_ACCOUNT_ID,\n\tEXPECTED_DT,\n\tCONTRACT_TYPE,\n\tCONTRACT_SIGNED_DT,\n\
  \tCONTRACT_END_DT,\n\tPARENT_OPTY_ID,\n\tPARENT_OPTY_NUMBER,\n\tPARENT_OPTY_CLOSE_DT,\n\
  \tPARENT_OPTY_ACCOUNT_ID,\n\tPARENT_OPTY_ACCOUNT_NUMBER,\n\tPARENT_OPTY_ACCOUNT_TERRITORY_ID,\n\
  \tPARENT_OPTY_TERRITORY_ID,\n\tPARENT_OPTY_FORECAST_CATEGORY,\n\tPARENT_OPTY_STAGE,\n\
  \tPARENT_OPTY_TYPE,\n\tPARENT_OPTY_LINK_REASON,\n\tPARENT_OPTY_NAME,\n\tPARENT_OPTY_CONTRACT_END_DT,\n\
  \tPARENT_OPTY_CONTRACT_TYPE,\n\tPARENT_OPTY_ORDER_TERM_END_DT,\n\tPARENT_OPTY_ORDER_TERM_START_DT,\n\
  \tPARENT_OPTY_TERM,\n\tPARENT_OPTY_DYNAMICS_GUID,\n\tPARENT_OPTY_NEXT_STEPS,\n\t\
  PARENT_OPTY_NOTES,\n\tPARENT_OPTY_LINK_REASON_FLAG,\n\tSURVIVOR_OPTY_ID,\n\tSURVIVOR_OPTY_ACCOUNT_ID,\n\
  \tSURVIVOR_OPTY_NUMBER,\n\tORDER_FORM_STATUS,\n\tORDER_FORM_OUTPUT_REASON,\n\tORDER_FORM_START_DT,\n\
  \tORDER_FORM_END_DT,\n\tLEAD_ID,\n\tLEAD_NUMBER,\n\tLEAD_SOURCE,\n\tRENEWAL_ACCOUNT_MANAGER_ID,\n\
  \tRENEWAL_ACCOUNT_MANAGER,\n\tRENEWAL_CATEGORY,\n\tRENEWAL_STATUS,\n\tRENEWALS_ENGAGEMENT,\n\
  \tRENEWAL_GEO,\n\tRENEWAL_MAJOR_AREA,\n\tRENEWAL_AREA,\n\tRENEWAL_REGION,\n\tRENEWAL_DISTRICT,\n\
  \tRENEWAL_TERRITORY,\n\tOPTY_RISK,\n\tRISK_MITIGATION_STEPS,\n\tRISK_REASON_CODE_NAME,\n\
  \tOPTY_CREATED_BY,\n\tOPTY_ADR_ID,\n\tOPTY_ADR,\n\tBASE_CURRENCY,\n\tAR_NOTES,\n\
  \tAUDIT_NOTES,\n\tADR_INTERACTION,\n\tACE_SALESREP,\n\tACE_SALESREP_ID,\n\tACE_SALESREP_NUMBER,\n\
  \tACE_SALES_MANAGER,\n\tACE_TERRITORY_ID,\n\tACE_TERRITORY_NAME,\n\tALLOWABLE_DISCOUNT_LEVEL,\n\
  \tESR_OWNER_ID,\n\tESR_OWNER,\n\tESR_MANAGER,\n\tCAMPAIGN_HISTORY,\n\tCODELIVERY,\n\
  \tIS_COMANAGED,\n\tOPTY_COMPETITION,\n\tCOMPETITVE_STATUS,\n\tCONSTANT_FX,\n\tCUSTOMER_OUTCOME_OWNER_ID,\n\
  \tCUSTOMER_OUTCOME_OWNER,\n\tCUSTOMER_OUTCOME_OWNER_MANAGER,\n\tDYNAMICS_DEAL_CHAMPION_ID,\n\
  \tDYNAMICS_DEAL_CHAMPION,\n\tDEPLOYMENT_REGISTRATION_NUMBER,\n\tDATA_CENTER,\n\t\
  DID_MARKETING_HELP,\n\tDOUBLE_COMP_OVERLAY,\n\tDOUBLE_COMP_OVERLAY_EMPLOYEE_NUMBER,\n\
  \tDYNAMICS_GUID,\n\tENGAGEMENT_MANAGER_USER_NAME,\n\tENTERPRISE_LOGO_OVERRIDE,\n\
  \tOPTY_ENVIRONMENT_TYPE,\n\tEXPRESS_NEWLOGO_OVERRIDE,\n\tOPTY_EXTENSION,\n\tFIELD_SALES_BUSINESS_TITLE,\n\
  \tFIELD_SALES_MANAGER_ID,\n\tFIELD_SALES_MANAGER,\n\tFIELD_SALES_TERRITORY_ID,\n\
  \tAPPROVAL_TERRITORY_ID,\n\tAPPROVAL_TERRITORY_SYSID,\n\tFIRST_CLOSED_BY,\n\tFIRST_CLOSED_TS,\n\
  \tOPTY_FLAGS,\n\tFORECAST_TYPE,\n\tGSI_PARTNER,\n\tIMPLEMENTATION_PARTNER,\n\tIMPLEMENTATION_MODE,\n\
  \tOPTY_INCUMBENT,\n\tIS_BIU,\n\tJOURNAL_NOTES,\n\tLINK_REASON,\n\tLINK_REASON_CATEGORY,\n\
  \tLINK_REASON_FLAG,\n\tMARKETING_PROGRAM_EVENT,\n\tMEETING_NUMBER,\n\tNEXT_STEPS,\n\
  \tNEXT_STEPS_BRIEF,\n\tNEXT_STEPS_LAST_UPDATED_TS,\n\tNEXT_STEPS_JOURNALED,\n\t\
  NOTES,\n\tNOTES_LAST_UPDATED_TS,\n\tOFFSET_VALUE,\n\tOTHER_COMPETITOR,\n\tOVERLAY_ADR_MANAGER,\n\
  \tIS_PARTNERED,\n\tPARTNERSHIP_TYPE,\n\tPIPELINE_SOURCE,\n\tPRICE_BAND,\n\tPRICE_BOOK,\n\
  \tPRIMARY_COMPETITOR,\n\tPRODUCT_TECHNOLOGY_PARTNER,\n\tPS_TERRITORY_ID,\n\tPS_TEAM,\n\
  \tREASON_CODE,\n\tSALES_ORDER_NUMBER,\n\tSAP_CONTRACT_ID,\n\tSECONDARY_COMPETITOR,\n\
  \tOPTY_SERVICE_PROVIDER,\n\tOPTY_SERVICE_PROVIDER_USAGE_TYPE,\n\tOPTY_SERVICES_PARTNER,\n\
  \tOPTY_SERVICES_TYPE,\n\tSOLUTION_CONSULTANT_ID,\n\tSOLUTION_CONSULTANT,\n\tSOLUTION_CONSULTANT_MANAGER,\n\
  \tSOLUTION_CONSULTANT_MANAGER_MANAGER,\n\tOPTY_SOURCE,\n\tIS_OPTY_SOURCED,\n\tSP_END_CUSTOMER_NAME,\n\
  \tOPTY_START_DT,\n\tSUCCESS_SERVICE_ATTACH_STATUS,\n\tSUPPORT_PARTNER,\n\tTERM_MONTHS_AND_DAYS,\n\
  \tOPTY_TIMING,\n\tTRAINING_ACCOUNT_EXECUTIVE_ID,\n\tTRAINING_ACCOUNT_EXECUTIVE_SYSID,\n\
  \tTRAINING_ACCOUNT_EXECUTIVE,\n\tOPTY_UPDATED_BY,\n\tOPTY_UPDATED_TS,\n\tIS_UPDATED_TO_CONTRACT,\n\
  \tWINLOSS_NODECISION_NOTES,\n\tWINLOSS_NODECISION_REASON,\n\tIS_CHANGE_ORDER,\n\t\
  OPTY_TERM,\n\tOPTY_TERM_PRECISE,\n\tIS_GP_NEW_LOGO,\n\tIS_GP_POTENTIAL_NEW_LOGO,\n\
  \tIS_DP_NEW_LOGO,\n\tIS_DP_POTENTIAL_NEW_LOGO,\n\tIS_DP_VERIFIED_NEW_LOGO,\n\tOPTY_SYSID,\n\
  \tOPTY_OWNER_SYSID,\n\tOPTY_TERRITORY_SYSID,\n\tGEO_SYSID,\n\tOPTY_ACCOUNT_SYSID,\n\
  \tPS_TERRITORY_SYSID,\n\tPARENT_OPTY_SYSID,\n\tPARENT_OPTY_ACCOUNT_SYSID,\n\tPARENT_OPTY_ACCOUNT_TERRITORY_SYSID,\n\
  \tPARENT_OPTY_TERRITORY_SYSID,\n\tOPTY_ADR_EMPLOYEE_SYSID,\n\tACE_SALESREP_SYSID,\n\
  \tACE_TERRITORY_SYSID,\n\tESR_OWNER_SYSID,\n\tCUSTOMER_OUTCOME_OWNER_SYSID,\n\t\
  SOLUTION_CONSULTANT_SYSID,\n\tRENEWAL_ACCOUNT_MANAGER_SYSID,\n\tPARENT_OPTY_MANAGEMENT,\n\
  \tOPTY_ML_PREDICTION_RISK_REASON1,\n\tOPTY_ML_PREDICTION_RISK_REASON2,\n\tOPTY_ML_PREDICTION_RISK_REASON3,\n\
  \tOPTY_ML_PREDICTION_RISK_REASON4,\n\tOPTY_ML_PREDICTION_RISK_REASON5,\n\tOPTY_ML_PREDICTION_RISK_REASON6,\n\
  \tIS_OPTY_PREDICTED_TO_CLOSE,\n\tOPTY_CLOSE_PROBABILITY,\n\tPARENT_OPTY_RENEWAL_CATEGORY,\n\
  \tJOURNAL_CREATED_DT,\n\tJOURNAL_STATUS,\n\tOPTY_CHALLENGES,\n\tOPTY_OBJECTIVE,\n\
  \tOPTY_OUTCOMES,\n\tPARENT_OPTY_TECHNICAL_WIN_NAME,\n\tPARENT_OPTY_TECHNICAL_WIN_STATUS,\n\
  \tIS_PARENT_OPTY_PREDICTED_TO_CLOSE,\n\tPARENT_OPTY_CLOSE_PROBABALILITY,\n\tPARENT_OPTY_RENEWAL_STATUS,\n\
  \tIS_PRESENT_IN_DYNAMIC_SUMMARY,\n\tPARENT_PARTNER_ACCOUNT_SYSID,\n\tPARENT_PARTNER_ACCOUNT_NAME,\n\
  \tPARENT_OPTY_SOURCE,\n\tPARTNER_ULTIMATE_PARENT_ACCOUNT,\n\tPARTNER_ULTIMATE_CHILD_ACCOUNT\n\
  ) as\nSELECT distinct                        --distinct is added to address the\
  \ duplicate Opportunity issue in Dynamics\n\n     HASH(opty.\"OptySysID\")  AS OPTY_ID\n\
  \    ,opty.\"OptyNumber\" AS OPTY_NUMBER\n    ,opty.\"OptyName\" as OPTY_NAME\n\
  \    ,opty.\"OptyTypeValue\" as OPTY_TYPE\n    ,opty.\"OptyStageValue\" AS OPTY_STAGE\n\
  \    ,opty.\"OptyPipelineStatusValue\" AS OPTY_FORECAST_CATEGORY\n    ,opty.\"OptyCloseDate\"\
  \ as OPTY_CLOSE_DT\n    ,so.\"OptyStartDate\" as OPTY_CREATED_DT\n    ,opty.\"OptyCloseMonth\"\
  \ as OPTY_CLOSE_MONTH\n    ,opty.\"OptyActive\" as IS_ACTIVE\n    ,qtr.QUARTER_ID\
  \ as QUARTER_ID\n    ,qtr.QUARTER_DT as QUARTER_DT\n    ,opty.\"OptySalesQuarter\"\
  \ as QUARTER_YYQQ\n    ,HASH(so.\"OptyOwnerSysID\") AS OPTY_OWNER_ID\n    ,so.\"\
  OptyDVOwner\" as OPTY_OWNER\n    ,hash(opty.\"OptyTerritorySysID\") as OPTY_TERRITORY_ID\n\
  \    ,hash(terr.\"TerrGeoSysID\") AS GEO_ID\n    ,hash(opty.\"OptyAccountSysID\"\
  ) as OPTY_ACCOUNT_ID\n    ,so.\"OptyExpectedDate\"  AS EXPECTED_DT\n    ,so.\"OptyContractType\"\
  \ AS  CONTRACT_TYPE\n    ,so.\"OptyContractSignedDate\" AS CONTRACT_SIGNED_DT\n\
  \    ,so.\"OptyContEndDate\" AS  CONTRACT_END_DT\n    ,HASH(opty.\"OptyParentSysID\"\
  ) AS PARENT_OPTY_ID\n    ,sop.\"OptyNumber\" AS PARENT_OPTY_NUMBER\n    ,sop.\"\
  OptyCloseDate\" as PARENT_OPTY_CLOSE_DT\n    ,HASH(sop.\"OptyAccountSysID\") AS\
  \ PARENT_OPTY_ACCOUNT_ID\n    ,sap.\"AcctNumber\" AS PARENT_OPTY_ACCOUNT_NUMBER\n\
  \    ,HASH(sap.\"AcctTerritorySysID\") as PARENT_OPTY_ACCOUNT_TERRITORY_ID\n   \
  \ ,HASH(sop.\"OptyTerritorySysID\") AS PARENT_OPTY_TERRITORY_ID\n    ,sop.\"OptyPipelineStatusValue\"\
  \ AS PARENT_OPTY_FORECAST_CATEGORY\n    ,sop.\"OptyStageValue\" AS PARENT_OPTY_STAGE\n\
  \    ,sop.\"OptyTypeValue\" as PARENT_OPTY_TYPE\n    ,sop.\"OptyOpportunityLinkReason\"\
  \ as PARENT_OPTY_LINK_REASON\n    ,sop.\"OptyName\" as PARENT_OPTY_NAME\n    ,sop.\"\
  OptyContEndDate\" as PARENT_OPTY_CONTRACT_END_DT\n    ,sop.\"OptyContractType\"\
  \ as PARENT_OPTY_CONTRACT_TYPE\n    ,sop.\"OptyOrderTermEndDate\" as PARENT_OPTY_ORDER_TERM_END_DT\n\
  \    ,sop.\"OptyOrderTermStartDate\" as PARENT_OPTY_ORDER_TERM_START_DT\n    ,sop.\"\
  OptyContractDuration\" as PARENT_OPTY_TERM\n    ,sop.\"OptyDynamicsGUID\" as PARENT_OPTY_DYNAMICS_GUID\n\
  \    ,NXT_STEPS_PAR.\"NextStepsFull\" as PARENT_OPTY_NEXT_STEPS\n    ,NXT_STEPS_PAR.\"\
  Notes\" as PARENT_OPTY_NOTES\n    ,sop.\"OptyLinkReasonFlag\" as PARENT_OPTY_LINK_REASON_FLAG\n\
  \    ,nvl(PARENT_OPTY_ID, OPTY_ID) as SURVIVOR_OPTY_ID\n    ,nvl(PARENT_OPTY_ACCOUNT_ID,\
  \ OPTY_ACCOUNT_ID) as SURVIVOR_OPTY_ACCOUNT_ID\n    ,nvl(PARENT_OPTY_NUMBER, OPTY_NUMBER)\
  \ as SURVIVOR_OPTY_NUMBER\n    ,so.\"OptyContractStatus\" as ORDER_FORM_STATUS\n\
  \    ,so.\"OptyOrderFormOutputReason\" as ORDER_FORM_OUTPUT_REASON\n    ,so.\"OptyOrderTermStartDate\"\
  \ as ORDER_FORM_START_DT\n    ,so.\"OptyOrderTermEndDate\" as ORDER_FORM_END_DT\n\
  \    ,HASH(so.\"OptyLeadNumberValue\") as LEAD_ID\n    ,so.\"OptyLeadNumberValue\"\
  \ as LEAD_NUMBER\n    ,so.\"OptyLeadSource\" as LEAD_SOURCE\n    ,HASH(so.\"OptyRenewalRepSysID\"\
  ) AS RENEWAL_ACCOUNT_MANAGER_ID\n    ,so.\"OptyRenewalRep\" as RENEWAL_ACCOUNT_MANAGER\n\
  \    ,so.\"OptyRenewalCategoryValue\" as RENEWAL_CATEGORY\n    ,so.\"OptyRenewalStatusValue\"\
  \ as RENEWAL_STATUS\n    ,so.\"OptyRenewalsEngagement\" as RENEWALS_ENGAGEMENT\n\
  \    ,case when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when\
  \ opty.\"OptyForeCastTypeValue\" in ('random','random')\n        then msp_terr.\"\
  TerrGeo\"\n        else terr.\"TerrGeo\"\n     end as RENEWAL_GEO\n    ,case when\
  \ opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n       when opty.\"OptyForeCastTypeValue\"\
  \ in ('random','random')\n       then msp_terr.\"TerrMajorArea\"\n       else terr.\"\
  TerrMajorArea\"\n     end as RENEWAL_MAJOR_AREA\n    ,case when opty.\"OptyForeCastTypeValue\"\
  \ IS NULL then 'random'\n       when opty.\"OptyForeCastTypeValue\" in ('random','random')\n\
  \       then msp_terr.\"TerrArea\"\n       else terr.\"TerrArea\"\n     end as RENEWAL_AREA\n\
  \    ,case when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when\
  \ opty.\"OptyForeCastTypeValue\" in ('random','random')\n        then msp_terr.\"\
  TerrRegion\"\n        else terr.\"TerrRegion\"\n     end as RENEWAL_REGION\n   \
  \ ,case when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when\
  \ opty.\"OptyForeCastTypeValue\" in ('random','random')\n        then msp_terr.\"\
  TerrDistrict\"\n        else terr.\"TerrDistrict\"\n     end as RENEWAL_DISTRICT\n\
  \    ,case when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when\
  \ opty.\"OptyForeCastTypeValue\" in ('random','random')\n        then msp_terr.\"\
  TerrName\"\n        else terr.\"TerrName\"\n     end as RENEWAL_TERRITORY\n    ,so.\"\
  OptyRisk\" as OPTY_RISK\n    ,opty_dynamics.\"OpportunityRiskMitigationSteps\" \
  \ as RISK_MITIGATION_STEPS\n    ,opty_dynamics.\"OpportunityRiskReasonCodeName\"\
  \ as RISK_REASON_CODE_NAME\n    ,so.\"OptyCreatedBy\" as OPTY_CREATED_BY\n    ,HASH(so.\"\
  OptyOverlayIsr\")  AS  OPTY_ADR_ID\n    ,so.\"OptyADR\" as OPTY_ADR\n    ,so.\"\
  OptyBaseCurrency\" as BASE_CURRENCY\n    ,so.\"OptyARNotes\" as AR_NOTES\n    ,so.\"\
  OptyAuditingNotes\" as AUDIT_NOTES\n    ,so.\"OptyISRInteraction\"  as ADR_INTERACTION\n\
  \    ,so.\"OptyMSPSalesValue\" AS ACE_SALESREP\n    ,HASH(so.\"OptyMSPSalesSysID\"\
  ) AS ACE_SALESREP_ID\n    ,opty_sales_mgr.\"EmpEmployeeNumber\" AS ACE_SALESREP_NUMBER\n\
  \    ,opty_sales_mgr.\"EmpManagerName\" AS ACE_SALES_MANAGER\n    ,HASH(so.\"OptyMSPTerritorySysID\"\
  ) AS ACE_TERRITORY_ID\n    ,so.\"OptyMSPTerritory\" AS ACE_TERRITORY_NAME\n    ,so.\"\
  OptyAllowableDiscountLevel\" as ALLOWABLE_DISCOUNT_LEVEL\n    ,HASH(so.\"OptyInsideSalesRepSysID\"\
  )  AS ESR_OWNER_ID\n    ,emp_esr_mgr.\"EmpName\" AS ESR_OWNER\n    ,emp_esr_mgr.\"\
  EmpManagerName\" AS ESR_MANAGER\n    ,LEFT(so.\"OptyCampaignHistoryValue\",'random')\
  \ as CAMPAIGN_HISTORY\n    ,opty.\"OptyCoDelivery\" as CODELIVERY\n    ,so.\"OptyCOManaged\"\
  \ AS IS_COMANAGED\n    ,so.\"OptyCompetition\" AS  OPTY_COMPETITION\n    ,so.\"\
  OptyCompititveStatus\" AS  COMPETITVE_STATUS\n    ,so.\"OptyConstantFXRate\" AS\
  \  CONSTANT_FX\n    ,HASH(so.\"OptyPSEngagementManagerSysID\") AS  CUSTOMER_OUTCOME_OWNER_ID\n\
  \    ,so.\"OptyPSEngagementManager\" AS CUSTOMER_OUTCOME_OWNER\n    ,emp_engm_mgr.\"\
  EmpManagerName\"  AS CUSTOMER_OUTCOME_OWNER_MANAGER\n    ,HASH(so.\"OptyDynamicsDealChampionName\"\
  )  AS DYNAMICS_DEAL_CHAMPION_ID\n    ,so.\"OptyDynamicsDealChampionName\"  AS DYNAMICS_DEAL_CHAMPION\n\
  \    ,so.\"OptyDeploymentRegistrationNumber\" AS DEPLOYMENT_REGISTRATION_NUMBER\n\
  \    ,so.\"OptyDataCenter\" AS DATA_CENTER\n    ,so.\"OptyDidMarketingHelp\" AS\
  \ DID_MARKETING_HELP\n    ,so.\"OptyDoubleCompensationOverlay\"  AS DOUBLE_COMP_OVERLAY\n\
  \    ,overlay_emp.\"EmpEmployeeNumber\" AS DOUBLE_COMP_OVERLAY_EMPLOYEE_NUMBER\n\
  \    ,LOWER(so.\"OptyDynamicsGUID\") AS DYNAMICS_GUID\n    ,emp_engm_mgr.\"EmpUserName\"\
  \ AS ENGAGEMENT_MANAGER_USER_NAME\n    ,so.\"OptyLogoOverrideLabel\" AS ENTERPRISE_LOGO_OVERRIDE\n\
  \    ,so.\"OptyMSPEnvironmentType\" AS OPTY_ENVIRONMENT_TYPE\n    ,so.\"OptyExpressNewLogoOverride\"\
  \ AS EXPRESS_NEWLOGO_OVERRIDE\n    ,so.\"OptyExtension\" as OPTY_EXTENSION\n   \
  \ ,emp_opty_owner.\"EmpTitle\"  AS FIELD_SALES_BUSINESS_TITLE\n    ,HASH(so.\"OptyOwnerSysID\"\
  ) AS FIELD_SALES_MANAGER_ID\n    ,emp_opty_owner.\"EmpManagerName\" AS FIELD_SALES_MANAGER\n\
  \    ,HASH(opty.\"OptyMSPTerritorySysID\") AS FIELD_SALES_TERRITORY_ID\n    ,HASH(so.\"\
  OptyApprovalTerritorySysID\") AS APPROVAL_TERRITORY_ID\n    ,so.\"OptyApprovalTerritorySysID\"\
  \ as APPROVAL_TERRITORY_SYSID\n    ,so.\"OptyFirstClosedByValue\"  as FIRST_CLOSED_BY\n\
  \    ,so.\"OptyFirstClosedOn\" as FIRST_CLOSED_TS\n    ,so.\"OptyFlags\" as OPTY_FLAGS\n\
  \    ,opty.\"OptyForeCastTypeValue\" as FORECAST_TYPE\n    ,so.\"OptyPartnerInfluencer\"\
  \  as GSI_PARTNER\n    ,so.\"OptyImplementationPartnerPS\" as IMPLEMENTATION_PARTNER\n\
  \    ,opty_dynamics.\"ImplementationModeName\" as IMPLEMENTATION_MODE\n    ,opty.\"\
  OptyIncumbent\" as OPTY_INCUMBENT\n    ,so.\"OptyIsBIU\" as IS_BIU\n    ,so.\"OptyJournalNotes\"\
  \ as JOURNAL_NOTES\n    ,so.\"OptyOpportunityLinkReason\" as LINK_REASON\n    ,so.\"\
  OptyLinkReasonFlag\" as LINK_REASON_CATEGORY\n    ,so.\"OptyLinkReasonFlag\" as\
  \ LINK_REASON_FLAG\n    ,so.\"OptyMarketingProgramEvent\" as MARKETING_PROGRAM_EVENT\n\
  \    ,so.\"OptyMeetingID\" as MEETING_NUMBER\n    ,NXT_STEPS.\"NextStepsFull\" as\
  \ NEXT_STEPS\n    ,NXT_STEPS.\"NextSteps\" as NEXT_STEPS_BRIEF\n    ,NXT_STEPS.\"\
  NextStepsLastUpdatedDate\" as NEXT_STEPS_LAST_UPDATED_TS\n    ,so.\"OptyNextStepsJournaled\"\
  \ as NEXT_STEPS_JOURNALED\n    ,NXT_STEPS.\"Notes\" as NOTES\n    ,NXT_STEPS.\"\
  NotesLastUpdatedDate\" as NOTES_LAST_UPDATED_TS\n    ,so.\"OptyOffsettingValue\"\
  \ as OFFSET_VALUE\n    ,so.\"OptyOtherCompetitor\" as OTHER_COMPETITOR\n    ,Overlayadr.\"\
  EmpManagerName\" as OVERLAY_ADR_MANAGER\n    ,so.\"OptyPartnered\" as IS_PARTNERED\n\
  \    ,opty.\"OptyPartnershipType\" as PARTNERSHIP_TYPE\n    ,so.\"OptyPipelineSourced\"\
  \ as PIPELINE_SOURCE\n    ,so.\"OptyPriceBand\" as PRICE_BAND\n    ,so.\"OptyPriceBook\"\
  \ as PRICE_BOOK\n    ,so.\"OptyPrimaryCompetitor\" as PRIMARY_COMPETITOR\n    ,so.\"\
  OptyProductTechnologyPartner\" as PRODUCT_TECHNOLOGY_PARTNER\n    ,HASH(so.\"OptyPSTerritorySysID\"\
  ) as PS_TERRITORY_ID\n    ,so.\"OptyPSTeaming\" as PS_TEAM\n    ,so.\"OptyReasonCode\"\
  \ as REASON_CODE\n    ,so.\"OptySalesOrderNumber\" as SALES_ORDER_NUMBER\n    ,so.\"\
  OptySAPContractID\" as SAP_CONTRACT_ID\n    ,so.\"OptySecondaryCompetitor\" as SECONDARY_COMPETITOR\n\
  \    ,so.\"OptyMSPPartner\" as OPTY_SERVICE_PROVIDER\n    ,so.\"OptyMSPUsageType\"\
  \ as OPTY_SERVICE_PROVIDER_USAGE_TYPE\n    ,opty.\"OptyImplementationPartner\" as\
  \ OPTY_SERVICES_PARTNER\n    ,so.\"OptyServicesType\" as OPTY_SERVICES_TYPE\n  \
  \  ,HASH(so.\"OptySolutionConsultant\") as SOLUTION_CONSULTANT_ID\n    ,so.\"OptySolutionConsultantValue\"\
  \ as SOLUTION_CONSULTANT\n    ,emp_solut_mgr.\"OpportunitySolutionConsultantManager\"\
  \ AS  SOLUTION_CONSULTANT_MANAGER\n    ,emp_solut_mgr.\"OpportunitySolutionConsultantManagerManager\"\
  \  AS  SOLUTION_CONSULTANT_MANAGER_MANAGER\n    ,so.\"OptyOpportunitySourceValue\"\
  \ as OPTY_SOURCE\n    ,so.\"OptySourced\" as IS_OPTY_SOURCED\n    ,so.\"OptyEndCustomerName\"\
  \ as SP_END_CUSTOMER_NAME\n    ,so.\"OptyStartDateDimension\" as OPTY_START_DT\n\
  \    ,so.\"OptySuccessServiceAttach\" as SUCCESS_SERVICE_ATTACH_STATUS\n    ,so.\"\
  OptySupportPartner\" as SUPPORT_PARTNER\n    ,so.\"OptyTermMonthsDays\" as TERM_MONTHS_AND_DAYS\n\
  \    ,so.\"OptyTiming\" as OPTY_TIMING\n    ,HASH(so.\"OptyEducationISRID\") AS\
  \ TRAINING_ACCOUNT_EXECUTIVE_ID\n    ,so.\"OptyEducationISRID\" as TRAINING_ACCOUNT_EXECUTIVE_SYSID\n\
  \    ,so.\"OptyEducationISR\" as TRAINING_ACCOUNT_EXECUTIVE\n    ,so.\"OptyUpdatedBy\"\
  \ AS OPTY_UPDATED_BY\n    ,so.\"OptyUpdatedOn\" as OPTY_UPDATED_TS\n    ,so.\"OptyUpdatedToContract\"\
  \ as IS_UPDATED_TO_CONTRACT\n    ,so.\"OptyWinLossDeadNotes\" as WINLOSS_NODECISION_NOTES\n\
  \    ,so.\"OptyCompititiveReason\" as WINLOSS_NODECISION_REASON\n    ,so.\"OptyChangeOrder\"\
  \ as IS_CHANGE_ORDER\n    ,so.\"OptyContractDuration\" as OPTY_TERM\n    ,so.\"\
  OptyTerm\" as OPTY_TERM_PRECISE\n    ,case when \"CHQNewLogoFlag\" IS not NULL and\
  \ \"CHQNewLogoFlag\" = 'random' then 'random' else 'random' end as IS_GP_NEW_LOGO\n\
  \    ,case when \"CHQNewLogoFlag\" IS not NULL and \"CHQNewLogoFlag\" = 'random'\
  \ then 'random' else 'random' end as IS_GP_POTENTIAL_NEW_LOGO\n    ,case when \"\
  FSPNewLogoFlag\" IS not NULL and \"FSPNewLogoFlag\" = 'random' then 'random' else\
  \ 'random' end as IS_DP_NEW_LOGO\n    ,case when \"FSPNewLogoFlag\" IS not NULL\
  \ and \"FSPNewLogoFlag\" = 'random' then 'random' else 'random' end as IS_DP_POTENTIAL_NEW_LOGO\n\
  \    ,case when \"AnaplanAccountFlag\" IS not NULL and \"AnaplanAccountFlag\" =\
  \ 'random' then 'random' else 'random' end as IS_DP_VERIFIED_NEW_LOGO\n    ,opty.\"\
  OptySysID\" as OPTY_SYSID\n    ,so.\"OptyOwnerSysID\" as OPTY_OWNER_SYSID\n    ,opty.\"\
  OptyTerritorySysID\" as OPTY_TERRITORY_SYSID\n    ,terr.\"TerrGeoSysID\" as GEO_SYSID\n\
  \    ,opty.\"OptyAccountSysID\" as OPTY_ACCOUNT_SYSID\n    ,so.\"OptyPSTerritorySysID\"\
  \ as PS_TERRITORY_SYSID\n    ,opty.\"OptyParentSysID\" as PARENT_OPTY_SYSID\n  \
  \  ,sop.\"OptyAccountSysID\" as PARENT_OPTY_ACCOUNT_SYSID\n    ,sap.\"AcctTerritorySysID\"\
  \ as   PARENT_OPTY_ACCOUNT_TERRITORY_SYSID\n    ,sop.\"OptyTerritorySysID\"  AS\
  \ PARENT_OPTY_TERRITORY_SYSID\n    ,so.\"OptyOverlayIsr\" as OPTY_ADR_EMPLOYEE_SYSID\n\
  \    ,so.\"OptyMSPSalesSysID\" AS ACE_SALESREP_SYSID\n    ,so.\"OptyMSPTerritorySysID\"\
  \ AS ACE_TERRITORY_SYSID\n    ,so.\"OptyInsideSalesRepSysID\" AS ESR_OWNER_SYSID\n\
  \    ,so.\"OptyPSEngagementManagerSysID\" as CUSTOMER_OUTCOME_OWNER_SYSID\n    ,so.\"\
  OptySolutionConsultant\" as SOLUTION_CONSULTANT_SYSID\n    ,so.\"OptyRenewalRepSysID\"\
  \ as RENEWAL_ACCOUNT_MANAGER_SYSID\n\n\t/* Begin\tNew columns added by Accenture\
  \ Team Dec-2023 */\n\n\t,so.\"OptyCOManaged\" AS PARENT_OPTY_MANAGEMENT\n\t,ppc.\"\
  OptyReasonCode1\" as OPTY_ML_PREDICTION_RISK_REASON1\n\t,ppc.\"OptyReasonCode2\"\
  \ as OPTY_ML_PREDICTION_RISK_REASON2\n\t,ppc.\"OptyReasonCode3\" as OPTY_ML_PREDICTION_RISK_REASON3\n\
  \t,ppc.\"OptyReasonCode4\" as OPTY_ML_PREDICTION_RISK_REASON4\n\t,ppc.\"OptyReasonCode5\"\
  \ as OPTY_ML_PREDICTION_RISK_REASON5\n\t,ppc.\"OptyReasonCode6\" as OPTY_ML_PREDICTION_RISK_REASON6\n\
  \t,ppc.\"PredictedToCloseInQuarter\" as IS_OPTY_PREDICTED_TO_CLOSE\n\t,ppc.\"ProbabailityToCloseInQuarter\"\
  \ as OPTY_CLOSE_PROBABILITY\n\t,sop.\"OptyRenewalCategoryValue\" as PARENT_OPTY_RENEWAL_CATEGORY\n\
  \t,ppc.\"JournalCreatedOn\" as JOURNAL_CREATED_DT\n\t,ppc.\"JournalDateFlag\" as\
  \ JOURNAL_STATUS\n\t,SNOS.\"SN_CHALLENGES\" as OPTY_CHALLENGES\n\t,SNOS.\"SN_OBJECTIVES\"\
  \ as OPTY_OBJECTIVE\n\t,SNOS.\"SN_OUTCOMES\" as OPTY_OUTCOMES\n    ,IFF((opty_dynamics.\"\
  OptyParentTechnicalWinName\") IS NULL, 'random', opty_dynamics.\"OptyParentTechnicalWinName\"\
  ) as PARENT_OPTY_TECHNICAL_WIN_NAME\n\t,opty_dynamics.\"OptyParentTechnicalWinName_CC\"\
  \ as PARENT_OPTY_TECHNICAL_WIN_STATUS\n\t,ppc.\"PredictedToCloseInQuarter\" as IS_PARENT_OPTY_PREDICTED_TO_CLOSE\n\
  \t,ppc.\"ProbabailityToCloseInQuarter\" as PARENT_OPTY_CLOSE_PROBABALILITY\n\t,so.\"\
  OptyRenewalStatusValue\" as PARENT_OPTY_RENEWAL_STATUS\n\t,(case when sop.\"OptyDynamicsGUID\"\
  \ = SNOS.\"SN_OPPORTUNITYID\" then 'random' else 'random' end) as \"OptySummaryFlag\"\
  \n\t,opd.\"PartnerAccountSysID\" as PARENT_PARTNER_ACCOUNT_SYSID\n\t,opd.\"ParentPartnerAccount\"\
  \ as PARENT_PARTNER_ACCOUNT_NAME\n\t,so.\"OptyPipelineSourced\" as PARENT_OPTY_SOURCE\n\
  \t,opd.\"PartnerUltimateParentAccount\" as PARTNER_ULTIMATE_PARENT_ACCOUNT\n\t,opd.\"\
  PartnerUltimateParentAccount\" as PARTNER_ULTIMATE_CHILD_ACCOUNT\n\n/*\t End New\
  \ columns added by Accenture Team Dec-2023 */\nFROM\n\n(select \"OptyNumber\",\n\
  \        \"OptyName\",\n        \"OptyTypeValue\",\n        \"OptyStageValue\",\n\
  \        \"OptyPipelineStatusValue\",\n        \"OptyCloseDate\",\n        \"OptyCloseMonth\"\
  ,\n        \"OptyActive\",\n        \"OptySalesQuarter\",\n        \"OptyAccountSysID\"\
  ,\n        \"OptyRenewalCategoryValue\",\n        \"OptyCoDelivery\",\n        \"\
  OptyForeCastTypeValue\",\n        \"OptyIncumbent\",\n        \"OptyOpportunityLinkReason\"\
  ,\n        \"OptyPartnershipType\",\n        \"OptyImplementationPartner\",\n  \
  \      \"OptySysID\",\n        \"OptyTerritorySysID\",\n        \"OptyParentSysID\"\
  ,\n        \"OptyMSPTerritorySysID\"\n\n from ODS_LS.SURF.SALES_OPPORTUNITY\n where\
  \ \"OptyNumber\" not in (select distinct \"SFixedDataOptyNumber\" from ODS_LS.FILES.SALES_OPPTY_FIXEDDATA\
  \  )\n\n UNION ALL\n\n SELECT distinct\n\n        fd.\"SFixedDataOptyNumber\" as\
  \ \"OptyNumber\",\n        fd.\"SFixedDataOptyName\" as \"OptyName\",\n        fd.\"\
  SFixedDataOptyType\" as \"OptyTypeValue\",\n        fd.\"SFixedDataOptyStage\" as\
  \ \"OptyStageValue\",\n        'random' as \"OptyPipelineStatusValue\",\n      \
  \  fd.\"SFixedDataOptyCloseDate\" as \"OptyCloseDate\",\n        fd.\"SFixedDataOptyCloseMonth\"\
  \ as \"OptyCloseMonth\",\n        case when fd.\"SFixedDataOptyActiveFlag\" IS NULL\
  \ then 'random' else fd.\"SFixedDataOptyActiveFlag\" end as \"OptyActive\",\n  \
  \      fd.\"SFixedDataOptyCloseQuarter\" as \"OptySalesQuarter\",\n        fd.\"\
  SFixedDataAcctSysID\" as \"OptyAccountSysID\",\n        case when fd.\"SFixedDataOptyRenewalCategory\"\
  \ in ('random','random') then 'random' else fd.\"SFixedDataOptyRenewalCategory\"\
  \ end as \"OptyRenewalCategoryValue\",\n        'random' as \"OptyCoDelivery\",\n\
  \        COALESCE(fd.\"SFixedDataRestatedForecastType\",so.\"OptyForeCastTypeValue\"\
  ) as \"OptyForeCastTypeValue\",\n        case when fd.\"SFixedDataOptyIncumbent\"\
  \ in ('random','random') then 'random' else fd.\"SFixedDataOptyIncumbent\" end as\
  \ \"OptyIncumbent\",\n        fd.\"SFixedDataOptyOpportunityLinkReason\" as \"OptyOpportunityLinkReason\"\
  ,\n        case when fd.\"SFixedDataPartnershipType\" in ('random','random','random')\
  \ then 'random' else fd.\"SFixedDataPartnershipType\" end as \"OptyPartnershipType\"\
  ,\n        case when fd.\"SFixedDataImplementationPartner\" in ('random','random','random')\
  \ then 'random' else fd.\"SFixedDataImplementationPartner\" end as \"OptyImplementationPartner\"\
  ,\n        fd.\"SFixedDataOptySysID\" as \"OptySysID\",\n        fd.\"SFixedDataRestatedTerritorySysID\"\
  \ as \"OptyTerritorySysID\",\n        fd.\"SFixedDataOptyParentsSysID\" as \"OptyParentSysID\"\
  ,\n        COALESCE(fd.\"SFixedDataRestatedACETerrSysID\",so.\"OptyMSPTerritorySysID\"\
  ) as \"OptyMSPTerritorySysID\"\n\n from ODS_LS.FILES.SALES_OPPTY_FIXEDDATA fd\n\
  \ left outer join ODS_LS.SURF.SALES_OPPORTUNITY so\n on so.\"OptyNumber\" = fd.\"\
  SFixedDataOptyNumber\"\n) opty\nLEFT JOIN ODS_LS.SURF.SALES_OPPORTUNITY so ON opty.\"\
  OptyNumber\" = so.\"OptyNumber\"\nLEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" opty_sales_mgr\
  \ ON so.\"OptyMSPSalesSysID\" = opty_sales_mgr.\"EmpSysID\"\nLEFT JOIN ODS_LS.\"\
  SURF\".\"EMPLOYEE\" emp_esr_mgr ON so.\"OptyInsideSalesRepSysID\" = emp_esr_mgr.\"\
  EmpSysID\"\nLEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_engm_mgr ON so.\"OptyPSEngagementManagerSysID\"\
  \ = emp_engm_mgr.\"EmpSysID\"\nLEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" overlay_emp\
  \ ON so.\"OptyDoubleCompensationOverlaySysID\" = overlay_emp.\"EmpSysID\"\nLEFT\
  \ JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_opty_owner ON so.\"OptyOwnerSysID\" = emp_opty_owner.\"\
  EmpSysID\"\nLEFT JOIN ODS_LS.\"SURF\".\"SALES_TERRITORY_ALL\" terr ON opty.\"OptyTerritorySysID\"\
  \ = terr.\"TerrSysID\"\nLEFT JOIN ODS_LS.\"SURF\".\"SALES_TERRITORY_ALL\" msp_terr\
  \ ON opty.\"OptyMSPTerritorySysID\" = msp_terr.\"TerrSysID\"\nLEFT JOIN ODS_LS.\"\
  SURF\".\"EMPLOYEE\" Overlayadr ON so.\"OptyOverlayIsr\" = Overlayadr.\"EmpSysID\"\
  \nLEFT JOIN ODS_LS.\"DYNAMICS365\".\"OPPORTUNITIES\" opty_dynamics ON so.\"OptyNumber\"\
  \ = opty_dynamics.\"OpportunityNumber\"\nleft outer join ODS_LS.SURF.SALES_OPPORTUNITY\
  \ sop ON sop.\"OptySysID\" = opty.\"OptyParentSysID\"\nLEFT JOIN EDW_LS.\"SALES_EM\"\
  .\"EM_OPTY_NOTES_NEXTSTEP\" NXT_STEPS_PAR ON SOP.\"OptySysID\" = NXT_STEPS_PAR.\"\
  JournalElementID\"\nleft outer join ODS_LS.SURF.SALES_ACCOUNT sap ON IFNULL(sop.\"\
  OptyAccountSysID\",'random')= IFNULL(sap.\"AcctSysID\",'random')\nleft outer join(SELECT\
  \ emp_opty_sol_mgr.\"EmpManagerName\" as \"OpportunitySolutionConsultantManager\"\
  ,\n                       emp_opty_sol_mgr.\"EmpSysID\" as \"EmpSysID\",\n     \
  \                  emp_opty_sol_mgr2.\"EmpManagerName\" as \"OpportunitySolutionConsultantManagerManager\"\
  \n\t\t\t\t           FROM (SELECT \"EmpSysID\" as \"EmpSysID\",\n\t\t\t\t\t\t  \
  \              \"EmpManagerName\" as \"EmpManagerName\",\n\t\t\t\t\t\t\t\t\t\t\"\
  EmpManagerSysID\" as \"EmpManagerSysID\" FROM  ODS_LS.\"SURF\".\"EMPLOYEE\") emp_opty_sol_mgr\n\
  \                           LEFT JOIN (SELECT \"EmpSysID\" as \"EmpSysID\",\"EmpManagerName\"\
  \ as \"EmpManagerName\"\n                                                      \
  \    FROM ODS_LS.\"SURF\".\"EMPLOYEE\")emp_opty_sol_mgr2\n\t\t\t\t\t\t   ON emp_opty_sol_mgr.\"\
  EmpManagerSysID\" = emp_opty_sol_mgr2.\"EmpSysID\"\n                ) emp_solut_mgr\n\
  ON so.\"OptySolutionConsultant\" = emp_solut_mgr.\"EmpSysID\"\nleft outer join (select\
  \ distinct QUARTER_ID, QUARTER_DT, QUARTER_YYQQ from EDW.ENTERPRISE.DIM_QUARTER)\
  \ qtr on opty.\"OptySalesQuarter\" = qtr.QUARTER_YYQQ\nLEFT JOIN EDW_LS.\"SALES_EM\"\
  .\"EM_OPTY_NOTES_NEXTSTEP\" NXT_STEPS ON so.\"OptySysID\" = NXT_STEPS.\"JournalElementID\"\
  \nleft outer join (select distinct \"OpportunityNumber\",\"CHQNewLogoFlag\"\n  \
  \              from EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n                where\
  \ \"RecordType\" in ('random')\n                and \"CHQNewLogoFlag\" in ('random',\
  \ 'random')\n                and \"HQBusinessSegment\" in ('random','random','random','random')\n\
  \                ) GP on OPTY.\"OptyNumber\" = GP.\"OpportunityNumber\"\n\nleft\
  \ outer join ( select distinct \"OpportunityNumber\",\"FSPNewLogoFlag\"\n      \
  \          from EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n                where \"\
  RecordType\" = 'random'\n                and \"FSPNewLogoFlag\" in ('random', 'random')\n\
  \                ) DP on OPTY.\"OptyNumber\" = DP.\"OpportunityNumber\"\n\nleft\
  \ outer join (select distinct \"OpportunityNumber\",\"AnaplanAccountFlag\"\n   \
  \             from EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n                where\
  \ \"RecordType\" in ('random') and \"AnaplanAccountFlag\" = 'random'\n         \
  \       ) VERIFIED_NL on OPTY.\"OptyNumber\" = VERIFIED_NL.\"OpportunityNumber\"\
  \n\n/*\tNew joins added by Accenture Team Dec-2023 */\n\nleft outer join (select\
  \ DISTINCT \"SN_OPPORTUNITYID\", LEFT(\"SN_OBJECTIVES\",'random') AS \"SN_OBJECTIVES\"\
  , LEFT(\"SN_CHALLENGES\",'random') \"SN_CHALLENGES\", LEFT(\"SN_OUTCOMES\",'random')\
  \ AS \"SN_OUTCOMES\"\n\t\t\t\tfrom RDS.\"DYNAMICS365\".\"SN_OPPORTUNITYSUMMARIES\"\
  \ WHERE STATUSCODE='random' AND SN_MASTER='random'\n\t\t\t\t) SNOS on sop.\"OptyDynamicsGUID\"\
  \ = SNOS.\"SN_OPPORTUNITYID\"\n\nleft outer join CDL_LS.DATASCIENCE_RPT.RPT_PIPELINE_PREDICTION_CURRENT\
  \ ppc on OPTY.\"OptyNumber\" = ppc.\"OpportunityNumber\"\n\nleft outer join (SELECT\
  \ LISTAGG( distinct \"PartnerUltimateParentAccount\", 'random') WITHIN GROUP (ORDER\
  \ BY \"PartnerUltimateParentAccount\")\n             AS \"PartnerUltimateParentAccount\"\
  \n             ,\"OptySysID\"\n             ,IFF(LISTAGG(distinct \"PartnerAccount\"\
  ,'random') ='random','random', LISTAGG(distinct \"PartnerAccount\",'random')) as\
  \ \"ParentPartnerAccount\"\n             ,IFF(LISTAGG(distinct \"PartnerAccountSysID\"\
  ,'random') ='random','random', LISTAGG(distinct \"PartnerAccountSysID\",'random'))\
  \ as \"PartnerAccountSysID\"\n      FROM\n        (SELECT DISTINCT\n           \
  \               \"PartnerUltimateParentAccount\"\n                         ,\"OptySysID\"\
  \n                         ,\"PartnerAccount\"\n                         ,\"PartnerAccountSysID\"\
  \n       FROM EDW_LS.\"PARTNER_EM\".\"EM_OPPORTUNITY_PARTNER360_DEAL\"\n )\n   \
  \   GROUP BY  \"OptySysID\" ) opd on opty.\"OptyParentSysID\"=opd.\"OptySysID\";"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
