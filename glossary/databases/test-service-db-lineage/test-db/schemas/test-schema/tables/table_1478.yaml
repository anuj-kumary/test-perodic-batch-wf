name: table_1478
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1478
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1478.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view SRC_V_FACT_NCP(\n\tQUARTER_ID,\n\tQUARTER_YYQQ,\n\
  \tTERRITORY_ID,\n\tGEO_ID,\n\tBU_GROUP_ID,\n\tOPTY_ID,\n\tPIPELINE_SOURCE,\n\tNNACV_NCP_USD,\n\
  \tTERRITORY_SYSID\n) as\nWITH CTE_GENERATED_PIPE AS\n(SELECT\nRIGHT(\n         \
  \   YEAR(\"OptyStagedOnDate\") || 'random' || QUARTER(\"OptyStagedOnDate\"),\n \
  \           'random'\n        ) \"CreatedQuarter\",\n\"OpportunitySysID\",\n\"OpportunityTerritorySysID\"\
  ,\nEDW_LS.SALES_EM.FN_BUGROUP('random',\"ProductBusinessUnitValue\") AS \"BU_GROUP\"\
  ,\ncase\n        when SO.\"OptySysCreatedOn\"< 'random' and SO.\"OptyPipelineSourced\"\
  ='random' then 'random'\n        when SO.\"OptySysCreatedOn\"< 'random' and SO.\"\
  OptyPipelineSourced\"!='random' then SO.\"OptyPipelineSourced\"\n        else t2.\"\
  OptyItemLineCreatedBy\" end \"LineCreatedBy\",\n\"TotalPipeline\",\nFROM EDW_LS.SALES_EM.VW_EM_SALES_NCP_QUARTERLY_FACT\
  \ GP\nLEFT JOIN ODS_LS.\"SURF\".\"SALES_PRODUCT\" SP\nON GP.\"OppItemProductSysID\"\
  \ = SP.\"ProductSysID\"\nLEFT JOIN  ODS_LS.\"SURF\".\"SALES_OPPORTUNITY\" SO\nON\
  \ GP.\"OpportunitySysID\" = SO.\"OptySysID\"\nLEFT JOIN (SELECT \"OptySysID\",\"\
  OptyItemLineItemNumber\",\"OptyItemLineCreatedBy\" from ODS_LS.\"SURF\".\"SALES_OPPORTUNITY_ITEM_CREATEDBY\"\
  ) t2\nON GP.\"OpportunitySysID\" = t2.\"OptySysID\"\nAND GP.\"OpportunityLineNumber\"\
  \ = t2.\"OptyItemLineItemNumber\"\nWHERE \"CreatedQuarter\" = RIGHT(\n         \
  \   YEAR(\n                convert_timezone('random', CURRENT_TIMESTAMP())\n   \
  \         ) || 'random' || QUARTER(\n                convert_timezone('random',\
  \ CURRENT_TIMESTAMP())\n            ),\n            'random'\n))\nSELECT\nDQ.QUARTER_ID,\n\
  DQ.QUARTER_YYQQ,\nhash(GEN_PIPE.\"OpportunityTerritorySysID\") AS TERRITORY_ID,\n\
  DT.GEO_ID,\nhash(GEN_PIPE.\"BU_GROUP\") AS BU_GROUP_ID,\nhash(\"OpportunitySysID\"\
  ) AS OPTY_ID,\n\"LineCreatedBy\" AS PIPELINE_SOURCE,\nSUM(\"TotalPipeline\") AS\
  \ NNACV_NCP_USD,\n\"OpportunityTerritorySysID\" as TERRITORY_SYSID\nFROM CTE_GENERATED_PIPE\
  \ GEN_PIPE\nLEFT JOIN EDW.ENTERPRISE.DIM_TERRITORY DT on DT.TERRITORY_SYSID=GEN_PIPE.\"\
  OpportunityTerritorySysID\"\nLEFT JOIN EDW.ENTERPRISE.DIM_QUARTER DQ on DQ.QUARTER_YYQQ=GEN_PIPE.\"\
  CreatedQuarter\"\nGROUP BY ALL;"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
