name: table_1336
fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1336
tableType: View
columns:
  - name: id
    dataType: BIGINT
    dataTypeDisplay: bigint
    fullyQualifiedName: test-service-db-lineage.test-db.test-schema.table_1336.id
    tags: []
    children: []
    customMetrics: []
owners: []
databaseSchema:
  id: 46334aff-5d83-4872-94c8-902145192247
  type: databaseSchema
  name: test-schema
  fullyQualifiedName: test-service-db-lineage.test-db.test-schema
  displayName: test-schema
  deleted: false
database:
  id: 252ee8f8-11a2-4af5-bf4b-05dcda48e1ec
  type: database
  name: test-db
  fullyQualifiedName: test-service-db-lineage.test-db
  displayName: test-db
  deleted: false
service:
  id: 7088ea8b-d5a8-4adf-bff1-a539758cd4ea
  type: databaseService
  name: test-service-db-lineage
  fullyQualifiedName: test-service-db-lineage
  displayName: test-service-db-lineage
  deleted: false
serviceType: Snowflake
schemaDefinition: "create or replace view SRC_V_DIM_OPPORTUNITY_TEST_0606(\n\tOPTY_ID,\n\
  \tOPTY_NUMBER,\n\tOPTY_NAME,\n\tOPTY_TYPE,\n\tOPTY_STAGE,\n\tOPTY_FORECAST_CATEGORY,\n\
  \tOPTY_CLOSE_DT,\n\tOPTY_CREATED_DT,\n\tOPTY_CLOSE_MONTH,\n\tOPTY_BU_LIST,\n\tIS_ACTIVE,\n\
  \tQUARTER_ID,\n\tQUARTER_DT,\n\tQUARTER_YYQQ,\n\tOPTY_OWNER_ID,\n\tOPTY_OWNER,\n\
  \tOPTY_TERRITORY_ID,\n\tFIELD_TERRITORY_ID,\n\tGEO_ID,\n\tOPTY_ACCOUNT_ID,\n\tEXPECTED_DT,\n\
  \tCONTRACT_NUMBER,\n\tCONTRACT_TYPE,\n\tCONTRACT_SIGNED_DT,\n\tCONTRACT_START_DT,\n\
  \tCONTRACT_END_DT,\n\tPARENT_OPTY_ID,\n\tPARENT_OPTY_NUMBER,\n\tPARENT_OPTY_CLOSE_DT,\n\
  \tPARENT_OPTY_ACCOUNT_ID,\n\tPARENT_OPTY_ACCOUNT_NUMBER,\n\tPARENT_OPTY_ACCOUNT_TERRITORY_ID,\n\
  \tPARENT_OPTY_TERRITORY_ID,\n\tPARENT_OPTY_FORECAST_CATEGORY,\n\tPARENT_OPTY_FORECAST_TYPE,\n\
  \tPARENT_OPTY_CONTRACT_SIGNED_DT,\n\tPARENT_OPTY_STAGE,\n\tPARENT_OPTY_TYPE,\n\t\
  PARENT_OPTY_LINK_REASON,\n\tPARENT_OPTY_NAME,\n\tPARENT_OPTY_CONTRACT_END_DT,\n\t\
  PARENT_OPTY_CONTRACT_START_DT,\n\tPARENT_OPTY_CONTRACT_TYPE,\n\tPARENT_OPTY_ORDER_TERM_END_DT,\n\
  \tPARENT_OPTY_ORDER_TERM_START_DT,\n\tPARENT_OPTY_TERM,\n\tPARENT_OPTY_DYNAMICS_GUID,\n\
  \tPARENT_OPTY_NEXT_STEPS,\n\tPARENT_OPTY_NOTES,\n\tPARENT_OPTY_LINK_REASON_FLAG,\n\
  \tPARENT_JOURNAL_DT_FLAG,\n\tREPORTING_PARENT_QUARTER_YYQQ,\n\tREPORTING_OPTY_ID,\n\
  \tREPORTING_OPTY_ACCOUNT_ID,\n\tSURVIVOR_OPTY_ID,\n\tSURVIVOR_OPTY_ACCOUNT_ID,\n\
  \tSURVIVOR_OPTY_NUMBER,\n\tORDER_FORM_STATUS,\n\tORDER_FORM_OUTPUT_REASON,\n\tORDER_FORM_START_DT,\n\
  \tORDER_FORM_END_DT,\n\tLEAD_ID,\n\tLEAD_NUMBER,\n\tLEAD_SOURCE,\n\tRENEWAL_ACCOUNT_MANAGER_ID,\n\
  \tRENEWAL_ACCOUNT_MANAGER,\n\tRENEWAL_CATEGORY,\n\tRENEWAL_STATUS,\n\tRENEWALS_ENGAGEMENT,\n\
  \tRENEWAL_GEO,\n\tRENEWAL_MAJOR_AREA,\n\tRENEWAL_AREA,\n\tRENEWAL_REGION,\n\tRENEWAL_DISTRICT,\n\
  \tRENEWAL_TERRITORY,\n\tRENEWAL_TERRITORY_SYSID,\n\tRENEWAL_TERRITORY_ID,\n\tIS_RENEWAL_CRITERIA,\n\
  \tOPTY_RISK,\n\tRISK_MITIGATION_STEPS,\n\tRISK_REASON_CODE_NAME,\n\tRISK_REASON_CATEGORY,\n\
  \tOPTY_CREATED_BY,\n\tOPTY_ADR_ID,\n\tOPTY_ADR,\n\tBASE_CURRENCY,\n\tAR_NOTES,\n\
  \tAUDIT_NOTES,\n\tADR_INTERACTION,\n\tACE_SALESREP,\n\tACE_SALESREP_ID,\n\tACE_SALESREP_NUMBER,\n\
  \tACE_SALES_MANAGER,\n\tACE_TERRITORY_ID,\n\tACE_TERRITORY_NAME,\n\tALLOWABLE_DISCOUNT_LEVEL,\n\
  \tESR_OWNER_ID,\n\tESR_OWNER,\n\tESR_MANAGER,\n\tCAMPAIGN_HISTORY,\n\tCODELIVERY,\n\
  \tIS_COMANAGED,\n\tOPTY_COMPETITION,\n\tCOMPETITVE_STATUS,\n\tCONSTANT_FX,\n\tCUSTOMER_OUTCOME_OWNER_ID,\n\
  \tCUSTOMER_OUTCOME_OWNER,\n\tCUSTOMER_OUTCOME_OWNER_MANAGER,\n\tPARENT_OPTY_OWNER_NAME,\n\
  \tDYNAMICS_DEAL_CHAMPION_ID,\n\tDYNAMICS_DEAL_CHAMPION,\n\tDEPLOYMENT_REGISTRATION_NUMBER,\n\
  \tDATA_CENTER,\n\tDID_MARKETING_HELP,\n\tDOUBLE_COMP_OVERLAY,\n\tDOUBLE_COMP_OVERLAY_EMPLOYEE_NUMBER,\n\
  \tDYNAMICS_GUID,\n\tDYNAMICS_URL,\n\tENGAGEMENT_MANAGER_USER_NAME,\n\tOPTY_ENGAGEMENT_TYPE_NAME,\n\
  \tOPTY_ENGAGEMENT_STATUS_CODE_NAME,\n\tOPTY_EXTENSION_CHANNEL_TRANSACTION_TYPE,\n\
  \tOPTY_EXTENSION_TRANSACTING_PARTNER,\n\tENTERPRISE_LOGO_OVERRIDE,\n\tOPTY_ENVIRONMENT_TYPE,\n\
  \tEXPRESS_NEWLOGO_OVERRIDE,\n\tOPTY_EXTENSION,\n\tFIELD_SALES_BUSINESS_TITLE,\n\t\
  FIELD_SALES_MANAGER_ID,\n\tFIELD_SALES_MANAGER,\n\tFIELD_SALES_TERRITORY_ID,\n\t\
  APPROVAL_TERRITORY_ID,\n\tAPPROVAL_TERRITORY_SYSID,\n\tFIRST_CLOSED_BY,\n\tFIRST_CLOSED_TS,\n\
  \tOPTY_FLAGS,\n\tFORECAST_TYPE,\n\tIS_NEW_LOGO,\n\tGSI_PARTNER,\n\tIMPLEMENTATION_PARTNER,\n\
  \tIMPLEMENTATION_MODE,\n\tOPTY_TECHNICAL_WIN,\n\tPARENT_OPTY_TECHNICAL_WIN,\n\t\
  OPTY_INCUMBENT,\n\tIS_BIU,\n\tJOURNAL_NOTES,\n\tLINK_REASON,\n\tLINK_REASON_CATEGORY,\n\
  \tLINK_REASON_FLAG,\n\tMARKETING_PROGRAM_EVENT,\n\tMEETING_NUMBER,\n\tNEXT_STEPS,\n\
  \tNEXT_STEPS_BRIEF,\n\tNEXT_STEPS_LAST_UPDATED_TS,\n\tNEXT_STEPS_JOURNALED,\n\t\
  NOTES,\n\tNOTES_LAST_UPDATED_TS,\n\tOFFSET_VALUE,\n\tOTHER_COMPETITOR,\n\tOVERLAY_ADR_MANAGER,\n\
  \tIS_PARTNERED,\n\tPARTNERSHIP_TYPE,\n\tPIPELINE_SOURCE,\n\tPRICE_BAND,\n\tPRICE_BOOK,\n\
  \tPRIMARY_COMPETITOR,\n\tPRODUCT_TECHNOLOGY_PARTNER,\n\tPS_TERRITORY_ID,\n\tPS_TEAM,\n\
  \tREASON_CODE,\n\tSALES_ORDER_NUMBER,\n\tSAP_CONTRACT_ID,\n\tCONTRACT_ID,\n\tSECONDARY_COMPETITOR,\n\
  \tOPTY_SERVICE_PROVIDER,\n\tOPTY_SERVICE_PROVIDER_USAGE_TYPE,\n\tOPTY_SERVICES_PARTNER,\n\
  \tOPTY_SERVICES_TYPE,\n\tSOLUTION_CONSULTANT_ID,\n\tSOLUTION_CONSULTANT,\n\tSOLUTION_CONSULTANT_MANAGER,\n\
  \tSOLUTION_CONSULTANT_MANAGER_MANAGER,\n\tOPTY_SOURCE,\n\tIS_OPTY_SOURCED,\n\tSP_END_CUSTOMER_NAME,\n\
  \tOPTY_START_DT,\n\tSUCCESS_SERVICE_ATTACH_STATUS,\n\tSUPPORT_PARTNER,\n\tTERM_MONTHS_AND_DAYS,\n\
  \tOPTY_TIMING,\n\tTRAINING_ACCOUNT_EXECUTIVE_ID,\n\tTRAINING_ACCOUNT_EXECUTIVE_SYSID,\n\
  \tTRAINING_ACCOUNT_EXECUTIVE,\n\tOPTY_UPDATED_BY,\n\tOPTY_UPDATED_TS,\n\tOPTY_SALES_COMPLETED_TS,\n\
  \tOPTY_FIRST_SUBMITTED_TS,\n\tIS_UPDATED_TO_CONTRACT,\n\tWINLOSS_NODECISION_NOTES,\n\
  \tWINLOSS_NODECISION_REASON,\n\tIS_CHANGE_ORDER,\n\tOPTY_TERM,\n\tOPTY_TERM_PRECISE,\n\
  \tIS_GP_NEW_LOGO,\n\tIS_GP_POTENTIAL_NEW_LOGO,\n\tIS_DP_NEW_LOGO,\n\tIS_DP_POTENTIAL_NEW_LOGO,\n\
  \tIS_ELIGIBLE_NEW_LOGO,\n\tIS_RENEWAL_DRIVEN,\n\tIS_PIPELINE_ACTIVE,\n\tPROBABILITY_TO_CLOSE_IN_QTR,\n\
  \tOPTY_SYSID,\n\tOPTY_OWNER_SYSID,\n\tOPTY_TERRITORY_SYSID,\n\tFIELD_TERRITORY_SYSID,\n\
  \tGEO_SYSID,\n\tOPTY_ACCOUNT_SYSID,\n\tPS_TERRITORY_SYSID,\n\tPARENT_OPTY_SYSID,\n\
  \tPARENT_OPTY_ACCOUNT_SYSID,\n\tPARENT_OPTY_ACCOUNT_TERRITORY_SYSID,\n\tPARENT_OPTY_TERRITORY_SYSID,\n\
  \tOPTY_ADR_EMPLOYEE_SYSID,\n\tACE_SALESREP_SYSID,\n\tACE_TERRITORY_SYSID,\n\tESR_OWNER_SYSID,\n\
  \tCUSTOMER_OUTCOME_OWNER_SYSID,\n\tSOLUTION_CONSULTANT_SYSID,\n\tRENEWAL_ACCOUNT_MANAGER_SYSID,\n\
  \tCONTRACT_SYSID\n) as\n\nWITH OPTY AS (                                       \
  \   --SS 1.5/Avantika Keshav/Updated on: 02-02-2024/Release on: 02-02-2024/ Release\
  \ Type: Normal\n                select  \"OptyNumber\",\n                      \
  \  \"OptyName\",\n                        \"OptyTypeValue\",\n                 \
  \       \"OptyStageValue\",\n                        \"OptyPipelineStatusValue\"\
  ,\n                        \"OptyCloseDate\",\n                        \"OptyCloseMonth\"\
  ,\n                        \"OptyActive\",\n                        \"OptySalesQuarter\"\
  ,\n                        \"OptyAccountSysID\",\n                        \"OptyRenewalCategoryValue\"\
  ,\n                        \"OptyCoDelivery\",\n                        \"OptyForeCastTypeValue\"\
  ,\n                        \"OptyIncumbent\",\n                        \"OptyOpportunityLinkReason\"\
  ,\n                        \"OptyPartnershipType\",\n                        \"\
  OptyImplementationPartner\",\n                        \"OptySysID\",\n         \
  \               \"OptyTerritorySysID\",\n                        \"OptyParentSysID\"\
  ,\n                        \"OptyMSPTerritorySysID\",\n                        CASE\
  \ WHEN\n                             \"OptySalesQuarter\" >= RIGHT(YEAR(convert_timezone('random',CURRENT_TIMESTAMP))\
  \ ||'random'|| QUARTER(convert_timezone('random',CURRENT_TIMESTAMP)), 'random')\n\
  \                             AND\n                             (\n            \
  \                 (\n                                 \"OptyStageValue\" IN(\n \
  \                                                   'random',\n                \
  \                                    'random',\n                               \
  \                     'random',\n                                              \
  \      'random',\n                                                    'random',\n\
  \                                                    'random',\n               \
  \                                     'random',\n                              \
  \                      'random'\n                                              \
  \      )\n                                AND LOWER(\"OptyPipelineStatusValue\"\
  ) not in(\n                                                                    \
  \        'random',\n                                                           \
  \                 'random',\n                                                  \
  \                          'random',\n                                         \
  \                                   'random',\n                                \
  \                                            'random',\n                       \
  \                                                     'random'\n               \
  \                                                             )\n              \
  \              )\n                            OR\n                            (CASE\
  \ WHEN  \"OptyStageValue\" = 'random'\n                                        OR\
  \ (\n                                            \"OptyStageValue\" = 'random'\n\
  \                                            and \"OptyType\" = 'random'\n     \
  \                                   )\n                                  THEN 'random'\n\
  \                                  ELSE 'random'\n                            END\n\
  \                            ) = 'random'\n                            )\n     \
  \                       THEN 'random'\n                            ELSE 'random'\n\
  \                        END as IS_PIPELINE_ACTIVE\n                from ODS_LS.SURF.SALES_OPPORTUNITY\n\
  \                where \"OptyNumber\" not in ( select distinct \"SFixedDataOptyNumber\"\
  \ from ODS_LS.FILES.SALES_OPPTY_FIXEDDATA )\n                and HASH(\"OptySysID\"\
  ) NOT IN ( -- Excluding the below Opty's which are having duplicate sysid's and\
  \ nulls. As per discussion with Aravind, this should be fixed at the FixedDataSource.\n\
  \                                    'random',\n                               \
  \     'random',\n                                    'random',\n               \
  \                     'random',\n                                    'random',\n\
  \                                    'random')\n\n                UNION ALL\n\n\
  \                SELECT distinct fd.\"SFixedDataOptyNumber\" as \"OptyNumber\",\n\
  \                        fd.\"SFixedDataOptyName\" as \"OptyName\",\n          \
  \              fd.\"SFixedDataOptyType\" as \"OptyTypeValue\",\n               \
  \         fd.\"SFixedDataOptyStage\" as \"OptyStageValue\",\n                  \
  \      'random' as \"OptyPipelineStatusValue\",\n                        fd.\"SFixedDataOptyCloseDate\"\
  \ as \"OptyCloseDate\",\n                        fd.\"SFixedDataOptyCloseMonth\"\
  \ as \"OptyCloseMonth\",\n                        case\n                       \
  \     when fd.\"SFixedDataOptyActiveFlag\" IS NULL then 'random'\n             \
  \               else fd.\"SFixedDataOptyActiveFlag\"\n                        end\
  \ as \"OptyActive\",\n                        fd.\"SFixedDataOptyCloseQuarter\"\
  \ as \"OptySalesQuarter\",\n                        fd.\"SFixedDataAcctSysID\" as\
  \ \"OptyAccountSysID\",\n                        case\n                        \
  \    when fd.\"SFixedDataOptyRenewalCategory\" in ('random', 'random') then 'random'\n\
  \                            else fd.\"SFixedDataOptyRenewalCategory\"\n       \
  \                 end as \"OptyRenewalCategoryValue\",\n                       \
  \ 'random' as \"OptyCoDelivery\",\n                        COALESCE(\n         \
  \                   fd.\"SFixedDataRestatedForecastType\",\n                   \
  \         so.\"OptyForeCastTypeValue\"\n                        ) as \"OptyForeCastTypeValue\"\
  ,\n                        case\n                            when fd.\"SFixedDataOptyIncumbent\"\
  \ in ('random', 'random') then 'random'\n                            else fd.\"\
  SFixedDataOptyIncumbent\"\n                        end as \"OptyIncumbent\",\n \
  \                       fd.\"SFixedDataOptyOpportunityLinkReason\" as \"OptyOpportunityLinkReason\"\
  ,\n                        case\n                            when fd.\"SFixedDataPartnershipType\"\
  \ in ('random', 'random', 'random') then 'random'\n                            else\
  \ fd.\"SFixedDataPartnershipType\"\n                        end as \"OptyPartnershipType\"\
  ,\n                        case\n                            when fd.\"SFixedDataImplementationPartner\"\
  \ in ('random', 'random', 'random') then 'random'\n                            else\
  \ fd.\"SFixedDataImplementationPartner\"\n                        end as \"OptyImplementationPartner\"\
  ,\n                        fd.\"SFixedDataOptySysID\" as \"OptySysID\",\n      \
  \                  fd.\"SFixedDataRestatedTerritorySysID\" as \"OptyTerritorySysID\"\
  ,\n                        fd.\"SFixedDataOptyParentsSysID\" as \"OptyParentSysID\"\
  ,\n                        COALESCE(\n                            fd.\"SFixedDataRestatedACETerrSysID\"\
  ,\n                            so.\"OptyMSPTerritorySysID\"\n                  \
  \      ) as \"OptyMSPTerritorySysID\",\n                        'random' as IS_PIPELINE_ACTIVE\n\
  \                from ODS_LS.FILES.SALES_OPPTY_FIXEDDATA fd\n                left\
  \ outer join ODS_LS.SURF.SALES_OPPORTUNITY so on so.\"OptyNumber\" = fd.\"SFixedDataOptyNumber\"\
  \n                where hash(fd.\"SFixedDataOptySysID\") NOT IN ( -- Excluding the\
  \ below Opty's which are having duplicate sysid's and nulls. As per discussion with\
  \ Aravind, this should be fixed at the FixedDataSource.\n                      \
  \                                      'random',\n                             \
  \                               'random',\n                                    \
  \                        'random',\n                                           \
  \                 'random',\n                                                  \
  \          'random',\n                                                         \
  \   'random')\n             )\n\nSELECT\n    distinct --distinct is added to address\
  \ the duplicate Opportunity issue in Dynamics\n    HASH(opty.\"OptySysID\") AS OPTY_ID,\n\
  \    opty.\"OptyNumber\" AS OPTY_NUMBER,\n    opty.\"OptyName\" as OPTY_NAME,\n\
  \    opty.\"OptyTypeValue\" as OPTY_TYPE,\n    opty.\"OptyStageValue\" AS OPTY_STAGE,\n\
  \    opty.\"OptyPipelineStatusValue\" AS OPTY_FORECAST_CATEGORY,\n    opty.\"OptyCloseDate\"\
  \ as OPTY_CLOSE_DT,\n    TO_DATE(so.\"OptySysCreatedOn\") as OPTY_CREATED_DT,  --SS\
  \ 1.5/Jay Modi/Updated on: 15-04-2024/Release on: 17-04-2024/ Release Type: RTB\n\
  \    opty.\"OptyCloseMonth\" as OPTY_CLOSE_MONTH,\n    so.\"OptyBUList\" as OPTY_BU_LIST,\
  \   --SS 1.5/Jay Modi/Updated on: 22-05-2024/Release on: 10-07-2024/ Release Type:\
  \ RTB\n    opty.\"OptyActive\" as IS_ACTIVE,\n    qtr.QUARTER_ID as QUARTER_ID,\n\
  \    qtr.QUARTER_DT as QUARTER_DT,\n    opty.\"OptySalesQuarter\" as QUARTER_YYQQ,\n\
  \    HASH(so.\"OptyOwnerSysID\") AS OPTY_OWNER_ID,\n    so.\"OptyDVOwner\" as OPTY_OWNER,\n\
  \    hash(opty.\"OptyTerritorySysID\") as OPTY_TERRITORY_ID,\n    HASH(so.\"OptyTerritorySysID\"\
  ) as FIELD_TERRITORY_ID, --SS 1.5/Jaya Prakash/Updated on: 25-01-2024/Release on:\
  \ 02-02-2024/ Release Type: Regular\n    hash(terr.\"TerrGeoSysID\") AS GEO_ID,\n\
  \    hash(opty.\"OptyAccountSysID\") as OPTY_ACCOUNT_ID,\n    so.\"OptyExpectedDate\"\
  \ AS EXPECTED_DT,\n    so.\"OptyContractValue\" as CONTRACT_NUMBER,   --SS 1.5/Jay\
  \ Modi/Updated on: 22-05-2024/Release on: 10-07-2024/ Release Type: RTB\n    so.\"\
  OptyContractType\" AS CONTRACT_TYPE,\n    so.\"OptyContractSignedDate\" AS CONTRACT_SIGNED_DT,\n\
  \    con.\"ContractStartDate\" as CONTRACT_START_DT,\n    so.\"OptyContEndDate\"\
  \ AS CONTRACT_END_DT,\n    HASH(opty.\"OptyParentSysID\") AS PARENT_OPTY_ID,\n \
  \   parent_opty.\"OptyNumber\" AS PARENT_OPTY_NUMBER, --SS 1.5/Avantika Keshav/Updated\
  \ on: 12-03-2024/Release on: 15-03-2024/ Release Type: RTB\n    sop.\"OptyCloseDate\"\
  \ as PARENT_OPTY_CLOSE_DT,\n    HASH(sop.\"OptyAccountSysID\") AS PARENT_OPTY_ACCOUNT_ID,\n\
  \    sap.\"AcctNumber\" AS PARENT_OPTY_ACCOUNT_NUMBER,\n    HASH(sap.\"AcctTerritorySysID\"\
  ) as PARENT_OPTY_ACCOUNT_TERRITORY_ID,\n    HASH(parent_opty.\"OptyTerritorySysID\"\
  ) AS PARENT_OPTY_TERRITORY_ID,\n    sop.\"OptyPipelineStatusValue\" AS PARENT_OPTY_FORECAST_CATEGORY,\n\
  \    parent_opty.\"OptyForeCastTypeValue\" AS PARENT_OPTY_FORECAST_TYPE, --SS 1.5/Jay\
  \ Modi/Updated on: 04-01-2024/Release on: 02-02-2024/ Release Type: RTB\n    sop.\"\
  OptyContractSignedDate\" AS PARENT_OPTY_CONTRACT_SIGNED_DT, --SS 1.5/Jay Modi/Updated\
  \ on: 04-01-2024/Release on: 02-02-2024/ Release Type: RTB\n    sop.\"OptyStageValue\"\
  \ AS PARENT_OPTY_STAGE,\n    sop.\"OptyTypeValue\" as PARENT_OPTY_TYPE,\n    sop.\"\
  OptyOpportunityLinkReason\" as PARENT_OPTY_LINK_REASON,\n    sop.\"OptyName\" as\
  \ PARENT_OPTY_NAME,\n    sop.\"OptyContEndDate\" as PARENT_OPTY_CONTRACT_END_DT,\n\
  \    parent_con.\"ContractStartDate\" as PARENT_OPTY_CONTRACT_START_DT,\n    sop.\"\
  OptyContractType\" as PARENT_OPTY_CONTRACT_TYPE,\n    sop.\"OptyOrderTermEndDate\"\
  \ as PARENT_OPTY_ORDER_TERM_END_DT,\n    sop.\"OptyOrderTermStartDate\" as PARENT_OPTY_ORDER_TERM_START_DT,\n\
  \    sop.\"OptyContractDuration\" as PARENT_OPTY_TERM,\n    sop.\"OptyDynamicsGUID\"\
  \ as PARENT_OPTY_DYNAMICS_GUID,\n    NXT_STEPS_PAR.\"NextStepsFull\" as PARENT_OPTY_NEXT_STEPS,\n\
  \    NXT_STEPS_PAR.\"Notes\" as PARENT_OPTY_NOTES,\n    sop.\"OptyLinkReasonFlag\"\
  \ as PARENT_OPTY_LINK_REASON_FLAG,case\n        when opty.\"OptySalesQuarter\" =\
  \ (\n            RIGHT(\n                YEAR(sop.\"OptyCloseDate\") || 'random'\
  \ || QUARTER(sop.\"OptyCloseDate\"),--SS 1.5/Avantika Keshav/Updated on: 02-02-2024/Release\
  \ on: 02-02-204/ Release Type: Normal\n                'random'\n            )\n\
  \        ) then NXT_STEPS_PAR.\"NextStepsDateFlag\"\n        else NXT_STEPS.\"NextStepsDateFlag\"\
  \n    end as PARENT_JOURNAL_DT_FLAG,\n    -- Start of Marquee Columns related changes\
  \ by Avantika/Updated on: 08-02-2024/Release on: 14-02-2024/ Release Type: Regular\n\
  \    CASE WHEN PARENT_OPTY_STAGE in ('random','random','random')\n          or (PARENT_OPTY_STAGE\
  \ = 'random' and PARENT_OPTY_TYPE in ('random','random'))\n         THEN 'random'\n\
  \         ELSE RIGHT(YEAR(PARENT_OPTY_CLOSE_DT) ||'random'|| QUARTER(PARENT_OPTY_CLOSE_DT),\
  \ 'random')\n    END AS REPORTING_PARENT_QUARTER_YYQQ,\n    case when QUARTER_YYQQ\
  \ = REPORTING_PARENT_QUARTER_YYQQ then PARENT_OPTY_ID else OPTY_ID end as REPORTING_OPTY_ID,\n\
  \    case when QUARTER_YYQQ = REPORTING_PARENT_QUARTER_YYQQ then PARENT_OPTY_ACCOUNT_ID\
  \ else OPTY_ACCOUNT_ID end as REPORTING_OPTY_ACCOUNT_ID,\n    -- End of Marquee\
  \ Columns related changes by Avantika/Updated on: 08-02-2024/Release on: 14-02-2024/\
  \ Release Type: Regular\n    nvl(PARENT_OPTY_ID, OPTY_ID) as SURVIVOR_OPTY_ID,\n\
  \    nvl(PARENT_OPTY_ACCOUNT_ID, OPTY_ACCOUNT_ID) as SURVIVOR_OPTY_ACCOUNT_ID,\n\
  \    nvl(PARENT_OPTY_NUMBER, OPTY_NUMBER) as SURVIVOR_OPTY_NUMBER,\n    so.\"OptyContractStatus\"\
  \ as ORDER_FORM_STATUS,\n    so.\"OptyOrderFormOutputReason\" as ORDER_FORM_OUTPUT_REASON,\n\
  \    so.\"OptyOrderTermStartDate\" as ORDER_FORM_START_DT,\n    so.\"OptyOrderTermEndDate\"\
  \ as ORDER_FORM_END_DT,\n    HASH(so.\"OptyLeadNumberValue\") as LEAD_ID,\n    so.\"\
  OptyLeadNumberValue\" as LEAD_NUMBER,\n    so.\"OptyLeadSource\" as LEAD_SOURCE,\n\
  \    HASH(so.\"OptyRenewalRepSysID\") AS RENEWAL_ACCOUNT_MANAGER_ID,\n    so.\"\
  OptyRenewalRep\" as RENEWAL_ACCOUNT_MANAGER,\n    so.\"OptyRenewalCategoryValue\"\
  \ as RENEWAL_CATEGORY,\n    so.\"OptyRenewalStatusValue\" as RENEWAL_STATUS,\n \
  \   so.\"OptyRenewalsEngagement\" as RENEWALS_ENGAGEMENT,\n    -- Renewal Columns\
  \ changes started by Jay Modi/Updated on: 22-02-2024/Release on: 01-03-2024/ Release\
  \ Type: Regular\n    case\n        when opty.\"OptyForeCastTypeValue\" IS NULL then\
  \ 'random'\n        when opty.\"OptyForeCastTypeValue\" in (\n            'random',\n\
  \            'random'\n        ) then msp_terr.\"TerrGeo\"\n        else terr.\"\
  TerrGeo\"\n    end as RENEWAL_GEO,\n   case\n        when opty.\"OptyForeCastTypeValue\"\
  \ IS NULL then 'random'\n        when opty.\"OptyForeCastTypeValue\" in (\n    \
  \        'random',\n            'random'\n        ) then msp_terr.\"TerrMajorArea\"\
  \n        else terr.\"TerrMajorArea\"\n    end as RENEWAL_MAJOR_AREA,\n    case\n\
  \        when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when\
  \ opty.\"OptyForeCastTypeValue\" in (\n            'random',\n            'random'\n\
  \        ) then msp_terr.\"TerrArea\"\n        else terr.\"TerrArea\"\n    end as\
  \ RENEWAL_AREA,\n    case\n        when opty.\"OptyForeCastTypeValue\" IS NULL then\
  \ 'random'\n        when opty.\"OptyForeCastTypeValue\" in (\n            'random',\n\
  \            'random'\n        ) then msp_terr.\"TerrRegion\"\n        else terr.\"\
  TerrRegion\"\n    end as RENEWAL_REGION,\n    case\n        when opty.\"OptyForeCastTypeValue\"\
  \ IS NULL then 'random'\n        when opty.\"OptyForeCastTypeValue\" in (\n    \
  \        'random',\n            'random'\n        ) then msp_terr.\"TerrDistrict\"\
  \n        else terr.\"TerrDistrict\"\n    end as RENEWAL_DISTRICT,\n    case\n \
  \       when opty.\"OptyForeCastTypeValue\" IS NULL then 'random'\n        when\
  \ opty.\"OptyForeCastTypeValue\" in (\n            'random',\n            'random'\n\
  \        ) then msp_terr.\"TerrName\"\n        else terr.\"TerrName\"\n    end as\
  \ RENEWAL_TERRITORY,\n    CASE\n        when opty.\"OptyForeCastTypeValue\" IS NULL\
  \ then 'random'\n        when opty.\"OptyForeCastTypeValue\" in (\n            'random',\n\
  \            'random'\n        ) then msp_terr.\"TerrSysID\"\n        else terr.\"\
  TerrSysID\"\n    END as RENEWAL_TERRITORY_SYSID,\n    HASH(RENEWAL_TERRITORY_SYSID)\
  \ as RENEWAL_TERRITORY_ID,\n --Renewal Columns changes ended by Jay Modi/Updated\
  \ on: 22-02-2024/Release on: 01-03-2024/ Release Type: Regular\n\tcase when (RENEWAL_MAJOR_AREA\
  \ IS NULL or RENEWAL_MAJOR_AREA != 'random')\n        and (CONTRACT_TYPE IS NULL\
  \ or CONTRACT_TYPE not in(\n            'random',\n            'random',\n     \
  \       'random',\n            'random',\n            'random'\n        )) then\
  \ 'random'\n        else 'random'\n    end as IS_RENEWAL_CRITERIA,  --SS 1.5/Jaya\
  \ Prakash/Updated on: 25-01-2024/Release on: 02-02-2024/ Release Type: Regular\n\
  \    so.\"OptyRisk\" as OPTY_RISK,\n    opty_dynamics.\"OpportunityRiskMitigationSteps\"\
  \ as RISK_MITIGATION_STEPS,\n    opty_dynamics.\"OpportunityRiskReasonCodeName\"\
  \ as RISK_REASON_CODE_NAME,\n    case\n        when opty_dynamics.\"OpportunityRiskReasonCodeName\"\
  \ in (\n            'random',\n            'random',\n            'random',\n  \
  \          'random',\n            'random'\n        ) then 'random'\n        when\
  \ opty_dynamics.\"OpportunityRiskReasonCodeName\" in ('random', 'random') then 'random'\n\
  \        when opty_dynamics.\"OpportunityRiskReasonCodeName\" in (\n           \
  \ 'random',\n            'random',\n            'random',\n            'random'\n\
  \        ) then 'random'\n        else 'random'\n    end as RISK_REASON_CATEGORY,\
  \  --SS 1.5/Jaya Prakash/Updated on: 04-01-2024/Release on: 02-02-2024/ Release\
  \ Type: Regular\n    so.\"OptyCreatedBy\" as OPTY_CREATED_BY,\n    HASH(so.\"OptyOverlayIsr\"\
  ) AS OPTY_ADR_ID,\n    so.\"OptyADR\" as OPTY_ADR,\n    so.\"OptyBaseCurrency\"\
  \ as BASE_CURRENCY,\n    so.\"OptyARNotes\" as AR_NOTES,\n    so.\"OptyAuditingNotes\"\
  \ as AUDIT_NOTES,\n    so.\"OptyISRInteraction\" as ADR_INTERACTION,\n    so.\"\
  OptyMSPSalesValue\" AS ACE_SALESREP,\n    HASH(so.\"OptyMSPSalesSysID\") AS ACE_SALESREP_ID,\n\
  \    opty_sales_mgr.\"EmpEmployeeNumber\" AS ACE_SALESREP_NUMBER,\n    opty_sales_mgr.\"\
  EmpManagerName\" AS ACE_SALES_MANAGER,\n    HASH(so.\"OptyMSPTerritorySysID\") AS\
  \ ACE_TERRITORY_ID,\n    so.\"OptyMSPTerritory\" AS ACE_TERRITORY_NAME,\n    so.\"\
  OptyAllowableDiscountLevel\" as ALLOWABLE_DISCOUNT_LEVEL,\n    HASH(so.\"OptyInsideSalesRepSysID\"\
  ) AS ESR_OWNER_ID,\n    emp_esr_mgr.\"EmpName\" AS ESR_OWNER,\n    emp_esr_mgr.\"\
  EmpManagerName\" AS ESR_MANAGER,\n    LEFT(so.\"OptyCampaignHistoryValue\", 'random')\
  \ as CAMPAIGN_HISTORY,\n    opty.\"OptyCoDelivery\" as CODELIVERY,\n    so.\"OptyCOManaged\"\
  \ AS IS_COMANAGED,\n    so.\"OptyCompetition\" AS OPTY_COMPETITION,\n    so.\"OptyCompititveStatus\"\
  \ AS COMPETITVE_STATUS,\n    so.\"OptyConstantFXRate\" AS CONSTANT_FX,\n    HASH(so.\"\
  OptyPSEngagementManagerSysID\") AS CUSTOMER_OUTCOME_OWNER_ID,\n    so.\"OptyPSEngagementManager\"\
  \ AS CUSTOMER_OUTCOME_OWNER,\n    emp_engm_mgr.\"EmpManagerName\" AS CUSTOMER_OUTCOME_OWNER_MANAGER,\n\
  \    so.\"OptyDVOwner\" AS PARENT_OPTY_OWNER_NAME,\n    HASH(so.\"OptyDynamicsDealChampionName\"\
  ) AS DYNAMICS_DEAL_CHAMPION_ID,\n    so.\"OptyDynamicsDealChampionName\" AS DYNAMICS_DEAL_CHAMPION,\n\
  \    so.\"OptyDeploymentRegistrationNumber\" AS DEPLOYMENT_REGISTRATION_NUMBER,\n\
  \    so.\"OptyDataCenter\" AS DATA_CENTER,\n    so.\"OptyDidMarketingHelp\" AS DID_MARKETING_HELP,\n\
  \    so.\"OptyDoubleCompensationOverlay\" AS DOUBLE_COMP_OVERLAY,\n    overlay_emp.\"\
  EmpEmployeeNumber\" AS DOUBLE_COMP_OVERLAY_EMPLOYEE_NUMBER,\n    LOWER(so.\"OptyDynamicsGUID\"\
  ) AS DYNAMICS_GUID,\n\tCONCAT('random',DYNAMICS_GUID)\nAS DYNAMICS_URL,--SS 1.5/Jay\
  \ Modi/Updated on: 24-04-2024/Release on: 15-05-2024/ Release Type: RTB\n    emp_engm_mgr.\"\
  EmpUserName\" AS ENGAGEMENT_MANAGER_USER_NAME,\n    opty_engagement_dynamics.\"\
  EngagementTypeName\" as OPTY_ENGAGEMENT_TYPE_NAME,  --SS 1.5/Jay Modi/Updated on:\
  \ 19-06-2024/Release on: 10-07-2024/ Release Type: RTB\n    opty_engagement_dynamics.\"\
  EngagementStatusCodeName\" as OPTY_ENGAGEMENT_STATUS_CODE_NAME,  --SS 1.5/Jay Modi/Updated\
  \ on: 19-06-2024/Release on: 10-07-2024/ Release Type: RTB\n    opty_extension.\"\
  OptyExtnChannelTransactionType\" as OPTY_EXTENSION_CHANNEL_TRANSACTION_TYPE, --SS\
  \ 1.5/Jay Modi/Updated on: 19-06-2024/Release on: 10-07-2024/ Release Type: RTB\n\
  \    opty_extension.\"OptyExtnTransactingPartner\" as OPTY_EXTENSION_TRANSACTING_PARTNER,\
  \ --SS 1.5/Jay Modi/Updated on: 19-06-2024/Release on: 10-07-2024/ Release Type:\
  \ RTB\n    so.\"OptyLogoOverrideLabel\" AS ENTERPRISE_LOGO_OVERRIDE,\n    so.\"\
  OptyMSPEnvironmentType\" AS OPTY_ENVIRONMENT_TYPE,\n    so.\"OptyExpressNewLogoOverride\"\
  \ AS EXPRESS_NEWLOGO_OVERRIDE,\n    so.\"OptyExtension\" as OPTY_EXTENSION,\n  \
  \  emp_opty_owner.\"EmpTitle\" AS FIELD_SALES_BUSINESS_TITLE,\n    HASH(so.\"OptyOwnerSysID\"\
  ) AS FIELD_SALES_MANAGER_ID,\n    emp_opty_owner.\"EmpManagerName\" AS FIELD_SALES_MANAGER,\n\
  \    HASH(opty.\"OptyMSPTerritorySysID\") AS FIELD_SALES_TERRITORY_ID,\n    HASH(so.\"\
  OptyApprovalTerritorySysID\") AS APPROVAL_TERRITORY_ID,\n    so.\"OptyApprovalTerritorySysID\"\
  \ as APPROVAL_TERRITORY_SYSID,\n    so.\"OptyFirstClosedByValue\" as FIRST_CLOSED_BY,\n\
  \    so.\"OptyFirstClosedOn\" as FIRST_CLOSED_TS,\n    so.\"OptyFlags\" as OPTY_FLAGS,\n\
  \    opty.\"OptyForeCastTypeValue\" as FORECAST_TYPE,\n    so.\"OptyNewLogo\" as\
  \ IS_NEW_LOGO, --SS 1.5/Jay Modi/Updated on: 04-01-2024/Release on: 02-02-2024/\
  \ Release Type: RTB\n    so.\"OptyPartnerInfluencer\" as GSI_PARTNER,\n    so.\"\
  OptyImplementationPartnerPS\" as IMPLEMENTATION_PARTNER,\n    opty_dynamics.\"ImplementationModeName\"\
  \ as IMPLEMENTATION_MODE,\n    IFNULL(opty_dynamics.\"OptyTechnicalWinName_CC\"\
  , 'random') as OPTY_TECHNICAL_WIN,   --SS 1.5/Jay Modi/Updated on: 22-05-2024/Release\
  \ on: 10-07-2024/ Release Type: RTB\n    case\n    when parent_opty.\"OptyNumber\"\
  =opty.\"OptyNumber\" then IFNULL(opty_dynamics.\"OptyTechnicalWinName_CC\", 'random')\n\
  \      else IFNULL(opty_dynamics.\"OptyParentTechnicalWinName_CC\", IFNULL(parent_opty_dynamics.\"\
  OptyTechnicalWinName_CC\", 'random'))\n    end as PARENT_OPTY_TECHNICAL_WIN,  --SS\
  \ 1.5/Jay Modi/Updated on: 22-05-2024/Release on: 10-07-2024/ Release Type: RTB\n\
  \    opty.\"OptyIncumbent\" as OPTY_INCUMBENT,\n    so.\"OptyIsBIU\" as IS_BIU,\n\
  \    so.\"OptyJournalNotes\" as JOURNAL_NOTES,\n    so.\"OptyOpportunityLinkReason\"\
  \ as LINK_REASON,\n    so.\"OptyLinkReasonFlag\" as LINK_REASON_CATEGORY,\n    so.\"\
  OptyLinkReasonFlag\" as LINK_REASON_FLAG,\n    so.\"OptyMarketingProgramEvent\"\
  \ as MARKETING_PROGRAM_EVENT,\n    so.\"OptyMeetingID\" as MEETING_NUMBER,\n   \
  \ NXT_STEPS.\"NextStepsFull\" as NEXT_STEPS,\n    NXT_STEPS.\"NextSteps\" as NEXT_STEPS_BRIEF,\n\
  \    NXT_STEPS.\"NextStepsLastUpdatedDate\" as NEXT_STEPS_LAST_UPDATED_TS,\n   \
  \ so.\"OptyNextStepsJournaled\" as NEXT_STEPS_JOURNALED,\n    NXT_STEPS.\"Notes\"\
  \ as NOTES,\n    NXT_STEPS.\"NotesLastUpdatedDate\" as NOTES_LAST_UPDATED_TS,\n\
  \    so.\"OptyOffsettingValue\" as OFFSET_VALUE,\n    so.\"OptyOtherCompetitor\"\
  \ as OTHER_COMPETITOR,\n    Overlayadr.\"EmpManagerName\" as OVERLAY_ADR_MANAGER,\n\
  \    so.\"OptyPartnered\" as IS_PARTNERED,\n    opty.\"OptyPartnershipType\" as\
  \ PARTNERSHIP_TYPE,\n    so.\"OptyPipelineSourced\" as PIPELINE_SOURCE,\n    so.\"\
  OptyPriceBand\" as PRICE_BAND,\n    so.\"OptyPriceBook\" as PRICE_BOOK,\n    so.\"\
  OptyPrimaryCompetitor\" as PRIMARY_COMPETITOR,\n    so.\"OptyProductTechnologyPartner\"\
  \ as PRODUCT_TECHNOLOGY_PARTNER,\n    HASH(so.\"OptyPSTerritorySysID\") as PS_TERRITORY_ID,\n\
  \    so.\"OptyPSTeaming\" as PS_TEAM,\n    so.\"OptyReasonCode\" as REASON_CODE,\n\
  \    so.\"OptySalesOrderNumber\" as SALES_ORDER_NUMBER,\n    so.\"OptySAPContractID\"\
  \ as SAP_CONTRACT_ID,\n    HASH(so.\"OptyContractSysID\") as CONTRACT_ID, --SS 1.5/Jay\
  \ Modi/Updated on: 04-01-2024/Release on: 02-02-2024/ Release Type: RTB\n    so.\"\
  OptySecondaryCompetitor\" as SECONDARY_COMPETITOR,\n    so.\"OptyMSPPartner\" as\
  \ OPTY_SERVICE_PROVIDER,\n    so.\"OptyMSPUsageType\" as OPTY_SERVICE_PROVIDER_USAGE_TYPE,\n\
  \    opty.\"OptyImplementationPartner\" as OPTY_SERVICES_PARTNER,\n    so.\"OptyServicesType\"\
  \ as OPTY_SERVICES_TYPE,\n    HASH(so.\"OptySolutionConsultant\") as SOLUTION_CONSULTANT_ID,\n\
  \    so.\"OptySolutionConsultantValue\" as SOLUTION_CONSULTANT,\n    emp_solut_mgr.\"\
  OpportunitySolutionConsultantManager\" AS SOLUTION_CONSULTANT_MANAGER,\n    emp_solut_mgr.\"\
  OpportunitySolutionConsultantManagerManager\" AS SOLUTION_CONSULTANT_MANAGER_MANAGER,\n\
  \    so.\"OptyOpportunitySourceValue\" as OPTY_SOURCE,\n    so.\"OptySourced\" as\
  \ IS_OPTY_SOURCED,\n    so.\"OptyEndCustomerName\" as SP_END_CUSTOMER_NAME,\n  \
  \  so.\"OptyStartDateDimension\" as OPTY_START_DT,\n    so.\"OptySuccessServiceAttach\"\
  \ as SUCCESS_SERVICE_ATTACH_STATUS,\n    so.\"OptySupportPartner\" as SUPPORT_PARTNER,\n\
  \    so.\"OptyTermMonthsDays\" as TERM_MONTHS_AND_DAYS,\n    so.\"OptyTiming\" as\
  \ OPTY_TIMING,\n    HASH(so.\"OptyEducationISRID\") AS TRAINING_ACCOUNT_EXECUTIVE_ID,\n\
  \    so.\"OptyEducationISRID\" as TRAINING_ACCOUNT_EXECUTIVE_SYSID,\n    so.\"OptyEducationISR\"\
  \ as TRAINING_ACCOUNT_EXECUTIVE,\n    so.\"OptyUpdatedBy\" AS OPTY_UPDATED_BY,\n\
  \    so.\"OptyUpdatedOn\" as OPTY_UPDATED_TS,\n    so.\"OptySalesClosedDate\" as\
  \ OPTY_SALES_COMPLETED_TS, --SS 1.5/Avantika Keshav/Updated on: 12-03-2024/Release\
  \ on: 15-03-2024/ Release Type: RTB -- Updated by Jay Modi on 15-04-2024/Release\
  \ on: 17-04-2024/ Release Type: RTB\n    so.\"OptyFirstSubmittedDate\" as OPTY_FIRST_SUBMITTED_TS,\
  \  --SS 1.5/Avantika Keshav/Updated on: 12-03-2024/Release on: 15-03-2024/ Release\
  \ Type: RTB\n    so.\"OptyUpdatedToContract\" as IS_UPDATED_TO_CONTRACT,\n    so.\"\
  OptyWinLossDeadNotes\" as WINLOSS_NODECISION_NOTES,\n    so.\"OptyCompititiveReason\"\
  \ as WINLOSS_NODECISION_REASON,\n    so.\"OptyChangeOrder\" as IS_CHANGE_ORDER,\n\
  \    so.\"OptyContractDuration\" as OPTY_TERM,\n    so.\"OptyTerm\" as OPTY_TERM_PRECISE,case\n\
  \        when \"CHQNewLogoFlag\" IS not NULL\n        and \"CHQNewLogoFlag\" = 'random'\
  \ then 'random'\n        else 'random'\n    end as IS_GP_NEW_LOGO,case\n       \
  \ when \"CHQNewLogoFlag\" IS not NULL\n        and \"CHQNewLogoFlag\" = 'random'\
  \ then 'random'\n        else 'random'\n    end as IS_GP_POTENTIAL_NEW_LOGO,case\n\
  \        when \"FSPNewLogoFlag\" IS not NULL\n        and \"FSPNewLogoFlag\" = 'random'\
  \ then 'random'\n        else 'random'\n    end as IS_DP_NEW_LOGO,case\n       \
  \ when \"FSPNewLogoFlag\" IS not NULL\n        and \"FSPNewLogoFlag\" = 'random'\
  \ then 'random'\n        else 'random'\n    end as IS_DP_POTENTIAL_NEW_LOGO,case\n\
  \        when \"AnaplanAccountFlag\" IS not NULL\n        and \"AnaplanAccountFlag\"\
  \ = 'random' then 'random'\n        else 'random'\n    end as IS_ELIGIBLE_NEW_LOGO,\n\
  \    so.\"OptyRenewalDriven\" as IS_RENEWAL_DRIVEN,\n    /*CASE   WHEN so.\"OptyStageValue\"\
  \ IN(\n                '1 - Opportunity (1%)',\n                '2 - Discovery (5%)',\n\
  \                '3 - Objectives (10%)',\n                '4 - Present Solution\
  \ (20%)',\n                '4 - Economic Buyer Identified (30%)',\n            \
  \    '5 - Economic Buyer Validation (40%)',\n                '6 - Validation Completed\
  \ (70%)',\n                '7 - Deal Imminent (90%)'\n            )\n          \
  \  AND LOWER(so.\"OptyPipelineStatusValue\") not in(\n                'lead',\n\
  \                'omitted',\n                'closed',\n                'inactive',\n\
  \                'lost',\n                'pre-pipeline'\n            ) OR\n   \
  \         (CASE WHEN  so.\"OptyStageValue\" = '8 - Closed Won (100%)'\n        \
  \                OR (\n                            so.\"OptyStageValue\" = '8 -\
  \ Closed Lost (100%)'\n                            and so.\"OptyType\" = 'Renewal'\n\
  \                        )\n                  THEN 1\n                  ELSE 0\n\
  \            END\n            ) = 1\n        THEN 1\n        ELSE 0\n    END as\
  \ IS_PIPELINE_ACTIVE,*/\n    opty.IS_PIPELINE_ACTIVE,\n    ds.\"ProbabilityToCloseInQtr\"\
  \ as PROBABILITY_TO_CLOSE_IN_QTR,  --SS 1.5/Jay Modi/Updated on: 24-04-2024/Release\
  \ on: 15-05-2024/ Release Type: RTB\n    opty.\"OptySysID\" as OPTY_SYSID,\n   \
  \ so.\"OptyOwnerSysID\" as OPTY_OWNER_SYSID,\n    opty.\"OptyTerritorySysID\" as\
  \ OPTY_TERRITORY_SYSID,\n    so.\"OptyTerritorySysID\" as FIELD_TERRITORY_SYSID,\
  \ --SS 1.5/Jaya Prakash/Updated on: 25-01-2024/Release on: 02-02-2024/ Release Type:\
  \ Regular\n    terr.\"TerrGeoSysID\" as GEO_SYSID,\n    opty.\"OptyAccountSysID\"\
  \ as OPTY_ACCOUNT_SYSID,\n    so.\"OptyPSTerritorySysID\" as PS_TERRITORY_SYSID,\n\
  \    opty.\"OptyParentSysID\" as PARENT_OPTY_SYSID,\n    sop.\"OptyAccountSysID\"\
  \ as PARENT_OPTY_ACCOUNT_SYSID,--SS 1.5/Avantika Keshav/Updated on: 02-02-2024/Release\
  \ on: 02-02-204/ Release Type: Normal\n    sap.\"AcctTerritorySysID\" as PARENT_OPTY_ACCOUNT_TERRITORY_SYSID,\n\
  \    sop.\"OptyTerritorySysID\" AS PARENT_OPTY_TERRITORY_SYSID,--SS 1.5/Avantika\
  \ Keshav/Updated on: 02-02-2024/Release on: 02-02-204/ Release Type: Normal\n  \
  \  so.\"OptyOverlayIsr\" as OPTY_ADR_EMPLOYEE_SYSID,\n    so.\"OptyMSPSalesSysID\"\
  \ AS ACE_SALESREP_SYSID,\n    so.\"OptyMSPTerritorySysID\" AS ACE_TERRITORY_SYSID,\n\
  \    so.\"OptyInsideSalesRepSysID\" AS ESR_OWNER_SYSID,\n    so.\"OptyPSEngagementManagerSysID\"\
  \ as CUSTOMER_OUTCOME_OWNER_SYSID,\n    so.\"OptySolutionConsultant\" as SOLUTION_CONSULTANT_SYSID,\n\
  \    so.\"OptyRenewalRepSysID\" as RENEWAL_ACCOUNT_MANAGER_SYSID,\n    so.\"OptyContractSysID\"\
  \ as CONTRACT_SYSID  --SS 1.5/Jay Modi/Updated on: 04-01-2024/Release on: 02-02-2024/\
  \ Release Type: RTB\n    /*so.\"OptyCOManaged\" AS PARENT_OPTY_MANAGEMENT,\n   \
  \ ppc.\"OptyReasonCode1\" as OPTY_ML_PREDICTION_RISK_REASON1,\n    ppc.\"OptyReasonCode2\"\
  \ as OPTY_ML_PREDICTION_RISK_REASON2,\n    ppc.\"OptyReasonCode3\" as OPTY_ML_PREDICTION_RISK_REASON3,\n\
  \    ppc.\"OptyReasonCode4\" as OPTY_ML_PREDICTION_RISK_REASON4,\n    ppc.\"OptyReasonCode5\"\
  \ as OPTY_ML_PREDICTION_RISK_REASON5,\n    ppc.\"OptyReasonCode6\" as OPTY_ML_PREDICTION_RISK_REASON6,\n\
  \    ppc.\"PredictedToCloseInQuarter\" as IS_OPTY_PREDICTED_TO_CLOSE,\n    ppc.\"\
  ProbabailityToCloseInQuarter\" as OPTY_CLOSE_PROBABILITY,\n    sop.\"OptyRenewalCategoryValue\"\
  \ as PARENT_OPTY_RENEWAL_CATEGORY,\n    ppc.\"JournalCreatedOn\" as JOURNAL_CREATED_DT,\n\
  \    ppc.\"JournalDateFlag\" as JOURNAL_STATUS,\n    SNOS.\"SN_CHALLENGES\" as OPTY_CHALLENGES,\n\
  \    SNOS.\"SN_OBJECTIVES\" as OPTY_OBJECTIVE,\n    SNOS.\"SN_OUTCOMES\" as OPTY_OUTCOMES,\n\
  \    IFF(\n        (opty_dynamics.\"OptyParentTechnicalWinName\") IS NULL,\n   \
  \     'No',\n        opty_dynamics.\"OptyParentTechnicalWinName\"\n    ) as PARENT_OPTY_TECHNICAL_WIN_NAME,\n\
  \    opty_dynamics.\"OptyParentTechnicalWinName_CC\" as PARENT_OPTY_TECHNICAL_WIN_STATUS,\n\
  \    ppc.\"PredictedToCloseInQuarter\" as IS_PARENT_OPTY_PREDICTED_TO_CLOSE,\n \
  \   ppc.\"ProbabailityToCloseInQuarter\" as PARENT_OPTY_CLOSE_PROBABALILITY,\n \
  \   so.\"OptyRenewalStatusValue\" as PARENT_OPTY_RENEWAL_STATUS,(\n        case\n\
  \            when sop.\"OptyDynamicsGUID\" = SNOS.\"SN_OPPORTUNITYID\" then 'Yes'\n\
  \            else 'No'\n        end\n    ) as \"OptySummaryFlag\",\n    opd.\"PartnerAccountSysID\"\
  \ as PARENT_PARTNER_ACCOUNT_SYSID,\n    opd.\"ParentPartnerAccount\" as PARENT_PARTNER_ACCOUNT_NAME,\n\
  \    so.\"OptyPipelineSourced\" as PARENT_OPTY_SOURCE,\n    opd.\"PartnerUltimateParentAccount\"\
  \ as PARTNER_ULTIMATE_PARENT_ACCOUNT,\n    opd.\"PartnerUltimateParentAccount\"\
  \ as PARTNER_ULTIMATE_CHILD_ACCOUNT*/\nFROM OPTY opty\n    LEFT JOIN ODS_LS.SURF.SALES_OPPORTUNITY\
  \ so ON opty.\"OptyNumber\" = so.\"OptyNumber\"\n    LEFT JOIN ODS_LS.\"SURF\".\"\
  EMPLOYEE\" opty_sales_mgr ON so.\"OptyMSPSalesSysID\" = opty_sales_mgr.\"EmpSysID\"\
  \n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_esr_mgr ON so.\"OptyInsideSalesRepSysID\"\
  \ = emp_esr_mgr.\"EmpSysID\"\n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_engm_mgr\
  \ ON so.\"OptyPSEngagementManagerSysID\" = emp_engm_mgr.\"EmpSysID\"\n    LEFT JOIN\
  \ ODS_LS.\"SURF\".\"EMPLOYEE\" overlay_emp ON so.\"OptyDoubleCompensationOverlaySysID\"\
  \ = overlay_emp.\"EmpSysID\"\n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" emp_opty_owner\
  \ ON so.\"OptyOwnerSysID\" = emp_opty_owner.\"EmpSysID\"\n    LEFT JOIN ODS_LS.\"\
  SURF\".\"SALES_TERRITORY_ALL\" terr ON opty.\"OptyTerritorySysID\" = terr.\"TerrSysID\"\
  \n    LEFT JOIN ODS_LS.\"SURF\".\"SALES_TERRITORY_ALL\" msp_terr ON opty.\"OptyMSPTerritorySysID\"\
  \ = msp_terr.\"TerrSysID\"\n    LEFT JOIN ODS_LS.\"SURF\".\"EMPLOYEE\" Overlayadr\
  \ ON so.\"OptyOverlayIsr\" = Overlayadr.\"EmpSysID\"\n    LEFT JOIN OPTY parent_opty\
  \ ON parent_opty.\"OptySysID\" = opty.\"OptyParentSysID\"--SS 1.5/Avantika Keshav/Updated\
  \ on: 02-02-2024/Release on: 02-02-204/ Release Type: Normal\n    LEFT JOIN ODS_LS.\"\
  DYNAMICS365\".\"OPPORTUNITIES\" opty_dynamics ON so.\"OptyNumber\" = opty_dynamics.\"\
  OpportunityNumber\"\n    LEFT JOIN ODS_LS.\"DYNAMICS365\".\"OPPORTUNITIES\" parent_opty_dynamics\
  \ ON parent_opty.\"OptyNumber\" = parent_opty_dynamics.\"OpportunityNumber\"\n \
  \   LEFT JOIN ODS_LS.\"DYNAMICS365\".\"SN_ENGAGEMENTS\" opty_engagement_dynamics\
  \ ON so.\"OptyDynamicsGUID\" = opty_engagement_dynamics.\"OpportunityGUID\"  --SS\
  \ 1.5/Jay Modi/Updated on: 19-06-2024/Release on: 10-07-2024/ Release Type: RTB\n\
  \    LEFT JOIN ODS_LS.SURF.SALES_OPPORTUNITY sop ON sop.\"OptySysID\" = opty.\"\
  OptyParentSysID\"\n    LEFT JOIN ODS_LS.SURF.SALES_CONTRACT con ON con.\"ContractSysID\"\
  \ = so.\"OptyContractSysID\" --SS 1.5/Jay Modi/Updated on: 10-05-2024/Release on:\
  \ 15-05-2024/ Release Type: Normal\n    LEFT JOIN ODS_LS.SURF.SALES_CONTRACT parent_con\
  \ ON parent_con.\"ContractSysID\" = sop.\"OptyContractSysID\" --SS 1.5/Jaya Prakash/Updated\
  \ on: 24-04-2024/Release on: 15-05-2024/ Release Type: Normal\n    LEFT JOIN EDW_LS.\"\
  SALES_EM\".\"EM_OPTY_NOTES_NEXTSTEP\" NXT_STEPS_PAR ON sop.\"OptySysID\" = NXT_STEPS_PAR.\"\
  JournalElementID\"\n    LEFT JOIN ODS_LS.SURF.SALES_ACCOUNT sap ON IFNULL(sop.\"\
  OptyAccountSysID\", 'random') = IFNULL(sap.\"AcctSysID\", 'random')\n    LEFT JOIN(\n\
  \        SELECT\n            emp_opty_sol_mgr.\"EmpManagerName\" as \"OpportunitySolutionConsultantManager\"\
  ,\n            emp_opty_sol_mgr.\"EmpSysID\" as \"EmpSysID\",\n            emp_opty_sol_mgr2.\"\
  EmpManagerName\" as \"OpportunitySolutionConsultantManagerManager\"\n        FROM\n\
  \            (\n                SELECT\n                    \"EmpSysID\" as \"EmpSysID\"\
  ,\n                    \"EmpManagerName\" as \"EmpManagerName\",\n             \
  \       \"EmpManagerSysID\" as \"EmpManagerSysID\"\n                FROM\n     \
  \               ODS_LS.\"SURF\".\"EMPLOYEE\"\n            ) emp_opty_sol_mgr\n \
  \           LEFT JOIN (\n                SELECT\n                    \"EmpSysID\"\
  \ as \"EmpSysID\",\n                    \"EmpManagerName\" as \"EmpManagerName\"\
  \n                FROM\n                    ODS_LS.\"SURF\".\"EMPLOYEE\"\n     \
  \       ) emp_opty_sol_mgr2 ON emp_opty_sol_mgr.\"EmpManagerSysID\" = emp_opty_sol_mgr2.\"\
  EmpSysID\"\n    ) emp_solut_mgr ON so.\"OptySolutionConsultant\" = emp_solut_mgr.\"\
  EmpSysID\"\n    LEFT JOIN (\n        select\n            distinct QUARTER_ID,\n\
  \            QUARTER_DT,\n            QUARTER_YYQQ\n        from\n            EDW.ENTERPRISE.DIM_QUARTER\n\
  \    ) qtr on opty.\"OptySalesQuarter\" = qtr.QUARTER_YYQQ\n    LEFT JOIN EDW_LS.\"\
  SALES_EM\".\"EM_OPTY_NOTES_NEXTSTEP\" NXT_STEPS ON so.\"OptySysID\" = NXT_STEPS.\"\
  JournalElementID\"\n    LEFT JOIN (\n        select\n            distinct \"OpportunityNumber\"\
  ,\n            \"CHQNewLogoFlag\"\n        from\n            EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n\
  \        where\n            \"RecordType\" in ('random')\n            and \"CHQNewLogoFlag\"\
  \ in ('random', 'random')\n            and \"HQBusinessSegment\" in (\n        \
  \        'random',\n                'random',\n                'random',\n     \
  \           'random'\n            )\n    ) GP on OPTY.\"OptyNumber\" = GP.\"OpportunityNumber\"\
  \n    LEFT JOIN (\n        select\n            distinct \"OpportunityNumber\",\n\
  \            \"FSPNewLogoFlag\"\n        from\n            EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n\
  \        where\n            \"RecordType\" = 'random'\n            and \"FSPNewLogoFlag\"\
  \ in ('random', 'random')\n    ) DP on OPTY.\"OptyNumber\" = DP.\"OpportunityNumber\"\
  \n    LEFT JOIN (\n        select\n            distinct \"OpportunityNumber\",\n\
  \            \"AnaplanAccountFlag\"\n        from\n            EDW_LS.MARKETING_EM.EM_MKT_FSPNEWLOGO\n\
  \        where\n            \"RecordType\" in ('random')\n            and \"AnaplanAccountFlag\"\
  \ = 'random'\n    ) VERIFIED_NL on OPTY.\"OptyNumber\" = VERIFIED_NL.\"OpportunityNumber\"\
  \n\tLEFT JOIN (\n        SELECT \"OptyNumber\" as \"OptyNumber\",\n            \"\
  ProbabilityToCloseInQtr\" as \"ProbabilityToCloseInQtr\"\n        FROM EDW_LS.\"\
  DATASCIENCE\".\"V_PIPELINE_PREDICTION_CURRENT\"\n    ) ds ON OPTY.\"OptyNumber\"\
  \ = ds.\"OptyNumber\"\n    LEFT JOIN ODS_LS.SURF.U_OPPORTUNITY_EXTENSION opty_extension\n\
  \    ON so.\"OptySysID\" = opty_extension.\"OptySysID\"   --SS 1.5/Jay Modi/Updated\
  \ on: 19-06-2024/Release on: 10-07-2024/ Release Type: RTB\n    ;"
tags: []
joins:
  startDate: 2026-01-07
  dayCount: 30
  columnJoins: []
  directTableJoins: []
customMetrics: []
domains: []
dataProducts: []
processedLineage: false
entityStatus: Approved
